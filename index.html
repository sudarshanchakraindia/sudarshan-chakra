<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <title>Sudarshan Chakra - Find Service Providers Near You</title>

    <!-- ===== PWA META TAGS ===== -->
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#ea580c">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Sudarshan Chakra">
    <meta name="application-name" content="Sudarshan Chakra">
    <meta name="description" content="Find verified service providers near you ‚Äî plumbers, electricians, beauticians, caterers and more.">

    <!-- PWA Icons ‚Äî Real PNG files required by iOS Safari -->
    <!-- iOS apple-touch-icons (specific sizes for each device) -->
    <link rel="apple-touch-icon" href="icons/icon-180.png">
    <link rel="apple-touch-icon" sizes="57x57"   href="icons/icon-57.png">
    <link rel="apple-touch-icon" sizes="60x60"   href="icons/icon-60.png">
    <link rel="apple-touch-icon" sizes="72x72"   href="icons/icon-72.png">
    <link rel="apple-touch-icon" sizes="76x76"   href="icons/icon-76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="icons/icon-114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="icons/icon-120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="icons/icon-144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="icons/icon-152.png">
    <link rel="apple-touch-icon" sizes="167x167" href="icons/icon-167.png">
    <link rel="apple-touch-icon" sizes="180x180" href="icons/icon-180.png">
    <!-- Standard favicon -->
    <link rel="icon" type="image/png" sizes="192x192" href="icons/icon-192.png">
    <link rel="icon" type="image/png" sizes="512x512" href="icons/icon-512.png">

    <!-- Open Graph (for sharing) -->
    <meta property="og:title" content="Sudarshan Chakra">
    <meta property="og:description" content="Find verified service providers near you">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://sudarshanchakraindia.github.io/sudarshan-chakra/">

    <!-- Service Worker Registration -->
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('sw.js')
                    .then(reg => console.log('‚úÖ Service Worker registered:', reg.scope))
                    .catch(err => console.warn('‚ö†Ô∏è Service Worker failed:', err));
            });
        }
    </script>

    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    
    <!-- Firebase SDK -->
    <script type="module">
        // ==================== FIREBASE SETUP ====================
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
        import { getDatabase, ref, set, push, onValue, update, remove, get } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-database.js";
        import { getAuth, RecaptchaVerifier, signInWithPhoneNumber, signOut, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";

        const firebaseConfig = {
            apiKey: "AIzaSyDr0jgOBiQ59F8CFZK0dnqgkG3ljjJu3P4",
            authDomain: "sudarshan-chakra-b0ac1.firebaseapp.com",
            databaseURL: "https://sudarshan-chakra-b0ac1-default-rtdb.asia-southeast1.firebasedatabase.app",
            projectId: "sudarshan-chakra-b0ac1",
            storageBucket: "sudarshan-chakra-b0ac1.firebasestorage.app",
            messagingSenderId: "357210144411",
            appId: "1:357210144411:web:b440a94cf78b04b58b103e"
        };

        const app = initializeApp(firebaseConfig);
        const db  = getDatabase(app);
        const auth = getAuth(app);

        // Expose to global scope
        window._firebase = { db, ref, set, push, onValue, update, remove, get };
        window._auth = { auth, RecaptchaVerifier, signInWithPhoneNumber, signOut, onAuthStateChanged };
        window._firebaseReady = true;

        // Auth state listener ‚Äî fires whenever user logs in or out
        onAuthStateChanged(auth, (user) => {
            window._firebaseUser = user || null;
            // Small delay to ensure main script variables are ready
            setTimeout(() => {
                window.dispatchEvent(new CustomEvent('authStateChanged', { detail: user }));
            }, 300);
        });

        window.dispatchEvent(new Event('firebaseReady'));
        console.log('‚úÖ Firebase + Auth initialized');
    </script>
    <style>
        .map-container { height: 500px; width: 100%; border-radius: 12px; }
        .reg-map { height: 350px; width: 100%; border-radius: 8px; margin-top: 10px; }
        .lang-option { cursor: pointer; padding: 20px; border-radius: 12px; transition: all 0.3s; }
        .lang-option:hover { transform: scale(1.05); }
        .category-card { cursor: pointer; transition: all 0.3s; }
        .category-card:hover { transform: translateY(-5px); box-shadow: 0 10px 25px rgba(0,0,0,0.15); }
        .category-card.selected { border: 3px solid #ea580c; background: #fff7ed; }
        .star-rating { color: #fbbf24; }
    </style>
</head>
<body class="bg-gray-50">

    <!-- ===== PWA INSTALL BANNER ===== -->
    <div id="pwaInstallBanner" class="hidden fixed bottom-0 left-0 right-0 z-50 p-3 bg-white border-t-2 border-orange-500 shadow-2xl" style="padding-bottom: env(safe-area-inset-bottom, 12px);">
        <div class="max-w-lg mx-auto flex items-center gap-3">
            <div class="w-12 h-12 bg-gradient-to-br from-orange-500 to-orange-600 rounded-xl flex items-center justify-center text-white text-xl font-bold shadow flex-shrink-0">SC</div>
            <div class="flex-1 min-w-0">
                <div class="font-bold text-gray-800 text-sm">Install Sudarshan Chakra</div>
                <div class="text-xs text-gray-500 truncate">Add to home screen for the full app experience</div>
            </div>
            <button id="pwaInstallBtn" class="bg-orange-600 text-white px-4 py-2 rounded-lg text-sm font-semibold hover:bg-orange-700 flex-shrink-0">
                Install
            </button>
            <button id="pwaInstallDismiss" class="text-gray-400 hover:text-gray-600 text-xl flex-shrink-0 px-1" title="Dismiss">‚úï</button>
        </div>
    </div>

    <!-- iOS Install Instructions (shown on Safari/iOS) -->
    <div id="iosInstallBanner" class="hidden fixed bottom-0 left-0 right-0 z-50 bg-white border-t-2 border-orange-500 shadow-2xl" style="padding-bottom: env(safe-area-inset-bottom, 12px);">
        <div class="p-4 max-w-lg mx-auto">
            <div class="flex justify-between items-start mb-3">
                <div class="flex items-center gap-2">
                    <div class="w-10 h-10 bg-gradient-to-br from-orange-500 to-orange-600 rounded-xl flex items-center justify-center text-white font-bold flex-shrink-0">SC</div>
                    <div>
                        <div class="font-bold text-gray-800 text-sm">Install on iPhone / iPad</div>
                        <div class="text-xs text-gray-500">Works like a real app ‚Äî no App Store needed!</div>
                    </div>
                </div>
                <button onclick="document.getElementById('iosInstallBanner').classList.add('hidden'); localStorage.setItem('pwaDismissed','1')" class="text-gray-400 hover:text-gray-600 text-xl">‚úï</button>
            </div>
            <div class="flex items-center gap-4 text-sm text-gray-700 bg-orange-50 rounded-xl p-3">
                <div class="text-center flex-1">
                    <div class="text-2xl mb-1">‚¨ÜÔ∏è</div>
                    <div class="text-xs">Tap <strong>Share</strong></div>
                </div>
                <div class="text-gray-400 text-lg">‚Ä∫</div>
                <div class="text-center flex-1">
                    <div class="text-2xl mb-1">‚ûï</div>
                    <div class="text-xs">Tap <strong>"Add to Home Screen"</strong></div>
                </div>
                <div class="text-gray-400 text-lg">‚Ä∫</div>
                <div class="text-center flex-1">
                    <div class="text-2xl mb-1">üì±</div>
                    <div class="text-xs">Tap <strong>Add</strong></div>
                </div>
            </div>
        </div>
    </div>

    <!-- LANGUAGE SELECTOR MODAL -->
    <div id="languageModal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl p-8 max-w-4xl w-full max-h-[90vh] overflow-y-auto">
            <h2 class="text-3xl font-bold text-center mb-2">üåè Select Your Language</h2>
            <p class="text-center text-gray-600 mb-8">‡§Ö‡§™‡§®‡•Ä ‡§≠‡§æ‡§∑‡§æ ‡§ö‡•Å‡§®‡•á‡§Ç / Choose Your Language</p>
            
            <div class="grid grid-cols-2 md:grid-cols-3 gap-4">
                <div class="lang-option bg-gradient-to-br from-orange-500 to-orange-600 text-white text-center" onclick="selectLanguage('en')">
                    <div class="text-4xl mb-2">üá¨üáß</div>
                    <div class="font-bold text-lg">English</div>
                </div>
                <div class="lang-option bg-gradient-to-br from-green-500 to-green-600 text-white text-center" onclick="selectLanguage('hi')">
                    <div class="text-4xl mb-2">üáÆüá≥</div>
                    <div class="font-bold text-lg">‡§π‡§ø‡§Ç‡§¶‡•Ä</div>
                </div>
                <div class="lang-option bg-gradient-to-br from-blue-500 to-blue-600 text-white text-center" onclick="selectLanguage('bn')">
                    <div class="text-4xl mb-2">üáÆüá≥</div>
                    <div class="font-bold text-lg">‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ</div>
                </div>
                <div class="lang-option bg-gradient-to-br from-yellow-500 to-yellow-600 text-white text-center" onclick="selectLanguage('gu')">
                    <div class="text-4xl mb-2">üáÆüá≥</div>
                    <div class="font-bold text-lg">‡™ó‡´Å‡™ú‡™∞‡™æ‡™§‡´Ä</div>
                </div>
                <div class="lang-option bg-gradient-to-br from-red-500 to-red-600 text-white text-center" onclick="selectLanguage('mr')">
                    <div class="text-4xl mb-2">üáÆüá≥</div>
                    <div class="font-bold text-lg">‡§Æ‡§∞‡§æ‡§†‡•Ä</div>
                </div>
                <div class="lang-option bg-gradient-to-br from-purple-500 to-purple-600 text-white text-center" onclick="selectLanguage('kn')">
                    <div class="text-4xl mb-2">üáÆüá≥</div>
                    <div class="font-bold text-lg">‡≤ï‡≤®‡≥ç‡≤®‡≤°</div>
                </div>
            </div>
        </div>
    </div>

    <!-- NAVIGATION -->
    <nav class="bg-white shadow-md sticky top-0 z-40">
        <div class="max-w-7xl mx-auto px-4 py-3 flex items-center justify-between flex-wrap gap-3">
            <div class="flex items-center gap-3 cursor-pointer" onclick="showPage('home')">
                <div class="w-12 h-12 bg-gradient-to-br from-orange-500 to-orange-600 rounded-full flex items-center justify-center text-white text-xl font-bold shadow-lg">SC</div>
                <span class="text-2xl font-bold text-orange-600">Sudarshan Chakra</span>
            </div>
            <div class="flex gap-2 flex-wrap items-center">
                <button data-i18n="home" onclick="showPage('home')" class="px-3 py-2 text-gray-700 hover:text-orange-600 font-medium text-sm">Home</button>
                <button data-i18n="browse" onclick="showPage('browse')" class="px-3 py-2 text-gray-700 hover:text-orange-600 font-medium text-sm">Browse</button>
                <button data-i18n="map" onclick="showPage('map')" class="px-3 py-2 text-gray-700 hover:text-orange-600 font-medium text-sm">Map</button>
                <button onclick="showPage('myProfile')" class="px-3 py-2 text-gray-700 hover:text-orange-600 font-medium text-sm">My Profile</button>
                <button data-i18n="registerProvider" onclick="showPage('register')" class="px-3 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700 text-sm">Register Provider</button>
                <button data-i18n="registerSeeker" onclick="showPage('seeker')" class="px-3 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 text-sm">Register Seeker</button>
                <button data-i18n="admin" onclick="showPage('admin')" class="px-3 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 text-sm">üîê Admin</button>
                <button onclick="changeLang()" class="px-3 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300 text-sm">üåè <span id="currentLang">EN</span></button>
                <!-- PHASE F: Auth Button -->
                <div id="navAuthBtn">
                    <button onclick="openLoginModal()" class="px-3 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 text-sm font-medium">üîë Login</button>
                </div>
            </div>
        </div>
    </nav>

    <!-- HOME PAGE -->
    <div id="page-home" class="page">
        <div class="max-w-7xl mx-auto px-4 py-12">
            <div class="text-center mb-12">
                <h1 class="text-5xl font-bold text-gray-800 mb-4">Find the Perfect Service Provider Near You</h1>
                <p class="text-xl text-gray-600 mb-8">Rated, verified professionals in your area</p>
                <div class="flex gap-4 justify-center flex-wrap">
                    <button data-i18n="browseServices" onclick="showPage('browse')" class="bg-orange-600 text-white px-8 py-3 rounded-lg font-semibold hover:bg-orange-700 text-lg">Browse Services</button>
                    <button data-i18n="becomeProvider" onclick="showPage('register')" class="bg-white text-orange-600 border-2 border-orange-600 px-8 py-3 rounded-lg font-semibold hover:bg-orange-50 text-lg">Become a Provider</button>
                    
                    <!-- PHASE C: Voice Search Button -->
                    <button data-i18n="voiceSearch" onclick="startVoiceSearch()" class="bg-blue-600 text-white px-8 py-3 rounded-lg font-semibold hover:bg-blue-700 text-lg">
                        üé§ Voice Search
                    </button>
                </div>
                
                <!-- Voice Search Status -->
                <div id="voiceStatus" class="hidden mt-4 text-center">
                    <div class="inline-block bg-red-100 border border-red-300 rounded-lg px-6 py-3">
                        <div class="flex items-center gap-3">
                            <div class="animate-pulse">üî¥</div>
                            <span id="voiceStatusText" class="font-medium text-red-800">Listening...</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <h2 data-i18n="serviceCategories" class="text-2xl font-bold text-gray-800 mb-6 text-center">Service Categories</h2>
            <div id="categoriesGridHome" class="grid grid-cols-2 md:grid-cols-4 gap-4"></div>
        </div>
    </div>

    <!-- NEW BROWSE PAGE WITH GRID VIEW -->
    <div id="page-browse" class="page hidden">
        <div class="max-w-7xl mx-auto px-4 py-8">
            <h1 class="text-3xl font-bold text-gray-800 mb-6">Find Service Providers Near You</h1>
            
            <!-- Step 1: Category Selection Grid -->
            <div class="mb-8">
                <h2 class="text-xl font-bold text-gray-700 mb-4">1Ô∏è‚É£ Select Category</h2>
                <div id="browseCategoriesGrid" class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-5 gap-4"></div>
            </div>
            
            <!-- Step 2: Subcategory Selection Grid -->
            <div id="subcategorySection" class="mb-8 hidden">
                <h2 class="text-xl font-bold text-gray-700 mb-4">2Ô∏è‚É£ Select Subcategory</h2>
                <div id="browseSubcategoriesGrid" class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-5 gap-4"></div>
            </div>
            
            <!-- Step 3: Service Type Selection Grid -->
            <div id="serviceSection" class="mb-8 hidden">
                <h2 class="text-xl font-bold text-gray-700 mb-4">3Ô∏è‚É£ Select Service Type</h2>
                <div id="browseServicesGrid" class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4"></div>
            </div>
            
            <!-- Providers List (Sorted intelligently) -->
            <div id="providersSection" class="hidden">
                <!-- PHASE B: Sort & Filter Controls -->
                <div class="bg-white rounded-lg shadow-md p-4 mb-6">
                    <div class="flex flex-wrap gap-4 items-center">
                        <!-- Sort Dropdown -->
                        <div class="flex items-center gap-2">
                            <label data-i18n="sortBy" class="font-medium text-gray-700">Sort By</label>
                            <select id="sortSelect" onchange="applySortAndFilter()" class="px-4 py-2 border rounded-lg focus:ring-2 focus:ring-orange-500">
                                <option value="rating" data-i18n="rating">Rating (High to Low)</option>
                                <option value="price" data-i18n="priceLowToHigh">Price (Low to High)</option>
                                <option value="distance" data-i18n="distanceNearToFar">Distance (Near to Far)</option>
                                <option value="experience" data-i18n="experienceHighToLow">Experience (High to Low)</option>
                            </select>
                        </div>
                        
                        <!-- Filter Button -->
                        <button data-i18n="filters" onclick="toggleFilters()" class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-medium">
                            üîç Filters
                        </button>
                        
                        <!-- Results Count -->
                        <div id="resultsCount" class="ml-auto text-sm text-gray-600 font-medium"></div>
                    </div>
                    
                    <!-- Filter Panel (Hidden by default) -->
                    <div id="filterPanel" class="hidden mt-4 pt-4 border-t">
                        <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-4">
                            <!-- Language Filter -->
                            <div>
                                <label data-i18n="languageFilter" class="block text-sm font-medium text-gray-700 mb-2">Language</label>
                                <select id="filterLanguage" class="w-full px-3 py-2 border rounded-lg">
                                    <option value="" data-i18n="anyLanguage">Any Language</option>
                                    <option value="English">English</option>
                                    <option value="Hindi">‡§π‡§ø‡§Ç‡§¶‡•Ä (Hindi)</option>
                                    <option value="Bengali">‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ (Bengali)</option>
                                    <option value="Gujarati">‡™ó‡´Å‡™ú‡™∞‡™æ‡™§‡´Ä (Gujarati)</option>
                                    <option value="Marathi">‡§Æ‡§∞‡§æ‡§†‡•Ä (Marathi)</option>
                                    <option value="Kannada">‡≤ï‡≤®‡≥ç‡≤®‡≤° (Kannada)</option>
                                </select>
                            </div>
                            
                            <!-- Religion Filter -->
                            <div>
                                <label data-i18n="religionFilter" class="block text-sm font-medium text-gray-700 mb-2">Religion</label>
                                <select id="filterReligion" class="w-full px-3 py-2 border rounded-lg">
                                    <option value="" data-i18n="anyReligion">Any Religion</option>
                                    <option value="Hindu">Hindu üïâÔ∏è</option>
                                    <option value="Muslim">Muslim ‚ò™Ô∏è</option>
                                    <option value="Christian">Christian ‚úùÔ∏è</option>
                                    <option value="Sikh">Sikh ‚ò¨</option>
                                    <option value="Buddhist">Buddhist ‚ò∏Ô∏è</option>
                                    <option value="Jain">Jain ‚ò∏Ô∏è</option>
                                </select>
                            </div>
                            
                            <!-- Price Range Filter -->
                            <div>
                                <label data-i18n="priceRange" class="block text-sm font-medium text-gray-700 mb-2">Price Range (‚Çπ/hr)</label>
                                <div class="flex items-center gap-2">
                                    <input type="number" id="filterPriceMin" placeholder="Min" class="w-full px-3 py-2 border rounded-lg" min="0" value="0">
                                    <span>-</span>
                                    <input type="number" id="filterPriceMax" placeholder="Max" class="w-full px-3 py-2 border rounded-lg" min="0" value="2000">
                                </div>
                            </div>
                            
                            <!-- Distance Filter -->
                            <div>
                                <label data-i18n="maxDistanceFilter" class="block text-sm font-medium text-gray-700 mb-2">Maximum Distance</label>
                                <select id="filterDistance" class="w-full px-3 py-2 border rounded-lg">
                                    <option value="999">Any Distance</option>
                                    <option value="5">Within 5 km</option>
                                    <option value="10">Within 10 km</option>
                                    <option value="20">Within 20 km</option>
                                    <option value="50">Within 50 km</option>
                                </select>
                            </div>
                        </div>
                        
                        <!-- Filter Action Buttons -->
                        <div class="flex gap-3 mt-4">
                            <button data-i18n="applyFilters" onclick="applySortAndFilter()" class="px-6 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700 font-medium">
                                Apply Filters
                            </button>
                            <button data-i18n="clearFilters" onclick="clearFilters()" class="px-6 py-2 bg-gray-400 text-white rounded-lg hover:bg-gray-500 font-medium">
                                Clear All
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- Provider Results -->
                <div id="providersGridNew" class="space-y-4"></div>
            </div>
        </div>
    </div>

    <!-- Other pages remain similar, will add them below -->
    <!-- MAP PAGE (unchanged) -->
    <div id="page-map" class="page hidden">
        <div class="max-w-7xl mx-auto px-4 py-8">
            <div class="flex justify-between items-center mb-6">
                <h1 class="text-3xl font-bold text-gray-800">Service Providers & Seekers Map</h1>
                <button onclick="showPage('home')" class="bg-orange-600 text-white px-6 py-3 rounded-lg hover:bg-orange-700 font-semibold">
                    ‚Üê Back to Home
                </button>
            </div>
            <div id="mainMap" class="map-container bg-white rounded-xl shadow-md"></div>
        </div>
    </div>

    <!-- PROFILE, REGISTRATION PAGES - Simplified versions below -->
    <div id="page-myProfile" class="page hidden">
        <div class="max-w-4xl mx-auto px-4 py-8">
            <!-- Not logged in state -->
            <div id="profileNotLoggedIn" class="text-center py-16">
                <div class="text-7xl mb-4">üî±</div>
                <h2 class="text-2xl font-bold text-gray-800 mb-2">Your Sudarshan Chakra Account</h2>
                <p class="text-gray-500 mb-6">Login to manage your profile, save favourites and write reviews</p>
                <button onclick="openLoginModal()" class="bg-orange-600 text-white px-8 py-3 rounded-xl font-semibold hover:bg-orange-700 text-lg transition">
                    üîë Login with Mobile OTP
                </button>
            </div>

            <!-- Logged in state -->
            <div id="profileLoggedIn" class="hidden">
                <!-- Profile Header -->
                <div class="bg-gradient-to-br from-orange-500 to-orange-600 rounded-2xl p-6 text-white mb-6 shadow-lg">
                    <div class="flex items-center gap-4">
                        <div id="myProfileAvatar" class="w-20 h-20 rounded-full bg-white bg-opacity-20 flex items-center justify-center text-3xl font-bold border-3 border-white overflow-hidden flex-shrink-0"></div>
                        <div class="flex-1">
                            <h1 id="myProfileName" class="text-2xl font-bold"></h1>
                            <p id="myProfilePhone" class="text-orange-100 mt-1"></p>
                            <p id="myProfileRole" class="text-orange-200 text-sm mt-1"></p>
                        </div>
                        <button onclick="logoutUser()" class="bg-white bg-opacity-20 hover:bg-opacity-30 text-white px-4 py-2 rounded-xl text-sm font-medium transition">Logout</button>
                    </div>
                </div>

                <!-- Tabs -->
                <div class="bg-white rounded-2xl shadow-md mb-6 overflow-hidden">
                    <div class="flex border-b">
                        <button onclick="showProfileTab('myDetails')" id="ptab-myDetails" class="flex-1 px-4 py-3 font-semibold text-sm text-orange-600 border-b-2 border-orange-600">üë§ My Details</button>
                        <button onclick="showProfileTab('favourites')" id="ptab-favourites" class="flex-1 px-4 py-3 font-semibold text-sm text-gray-500 hover:text-orange-600 border-b-2 border-transparent">‚ù§Ô∏è Favourites</button>
                        <button onclick="showProfileTab('myReviews')" id="ptab-myReviews" class="flex-1 px-4 py-3 font-semibold text-sm text-gray-500 hover:text-orange-600 border-b-2 border-transparent">‚≠ê My Reviews</button>
                        <button onclick="showProfileTab('myReports')" id="ptab-myReports" class="flex-1 px-4 py-3 font-semibold text-sm text-gray-500 hover:text-orange-600 border-b-2 border-transparent">üö® Reports</button>
                    </div>
                </div>

                <!-- Tab: My Details -->
                <div id="profileTab-myDetails" class="space-y-4">
                    <!-- Provider profile edit card -->
                    <div id="myProviderCard" class="hidden bg-white rounded-2xl shadow-md p-6">
                        <div class="flex justify-between items-center mb-4">
                            <h3 class="text-lg font-bold text-gray-800">üõ†Ô∏è My Provider Profile</h3>
                            <div class="flex items-center gap-3">
                                <span class="text-sm text-gray-500">Available</span>
                                <div id="availabilityToggle" onclick="toggleAvailability()" class="w-12 h-6 bg-gray-300 rounded-full cursor-pointer transition-all relative">
                                    <div class="w-5 h-5 bg-white rounded-full shadow absolute top-0.5 left-0.5 transition-all"></div>
                                </div>
                            </div>
                        </div>
                        <div id="myProviderInfo" class="space-y-3 text-sm text-gray-600"></div>
                        <button onclick="openEditProviderModal()" class="mt-4 w-full bg-orange-100 text-orange-700 py-2.5 rounded-xl font-medium hover:bg-orange-200 transition">
                            ‚úèÔ∏è Edit My Profile
                        </button>
                    </div>

                    <!-- Seeker profile card -->
                    <div id="mySeekerCard" class="hidden bg-white rounded-2xl shadow-md p-6">
                        <h3 class="text-lg font-bold text-gray-800 mb-3">üîç My Seeker Profile</h3>
                        <div id="mySeekerInfo" class="space-y-2 text-sm text-gray-600"></div>
                    </div>

                    <!-- Recommendations -->
                    <div id="myRecommendations" class="bg-white rounded-2xl shadow-md p-6">
                        <h3 class="text-lg font-bold text-gray-800 mb-4">üí° Recommended For You</h3>
                        <div id="recommendationsList" class="space-y-3"></div>
                    </div>
                </div>

                <!-- Tab: Favourites -->
                <div id="profileTab-favourites" class="hidden">
                    <div class="bg-white rounded-2xl shadow-md p-6">
                        <h3 class="text-lg font-bold text-gray-800 mb-4">‚ù§Ô∏è Saved Providers</h3>
                        <div id="favouritesList" class="space-y-3"></div>
                    </div>
                </div>

                <!-- Tab: My Reviews -->
                <div id="profileTab-myReviews" class="hidden">
                    <div class="bg-white rounded-2xl shadow-md p-6">
                        <h3 class="text-lg font-bold text-gray-800 mb-4">‚≠ê Reviews I've Written</h3>
                        <div id="myReviewsList" class="space-y-3"></div>
                    </div>
                </div>

                <!-- Tab: My Reports -->
                <div id="profileTab-myReports" class="hidden">
                    <div class="bg-white rounded-2xl shadow-md p-6">
                        <h3 class="text-lg font-bold text-gray-800 mb-4">üö® My Complaints / Reports</h3>
                        <div id="myReportsList" class="space-y-3"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- PHASE F: Edit Provider Profile Modal -->
    <div id="editProviderModal" class="hidden fixed inset-0 bg-black bg-opacity-60 z-50 flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl max-w-lg w-full shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="bg-orange-600 p-5 rounded-t-2xl text-white flex justify-between items-center">
                <h3 class="text-lg font-bold">‚úèÔ∏è Edit My Profile</h3>
                <button onclick="document.getElementById('editProviderModal').classList.add('hidden')" class="text-2xl opacity-75 hover:opacity-100">‚úï</button>
            </div>
            <div class="p-5 space-y-4">
                <!-- Photo -->
                <div class="flex flex-col items-center">
                    <div class="relative">
                        <div class="w-24 h-24 rounded-full overflow-hidden border-4 border-orange-300 flex items-center justify-center bg-orange-50">
                            <img id="editPhotoPreview" class="w-full h-full object-cover" alt="Photo">
                        </div>
                        <label for="editProviderPhoto" class="absolute bottom-0 right-0 bg-orange-600 text-white rounded-full w-8 h-8 flex items-center justify-center cursor-pointer text-sm hover:bg-orange-700">üì∑</label>
                        <input type="file" id="editProviderPhoto" accept="image/*" class="hidden" onchange="previewEditPhoto(this)">
                    </div>
                </div>
                <div>
                    <label class="block text-gray-700 text-sm font-medium mb-1">About / Bio</label>
                    <textarea id="editBio" rows="3" maxlength="250" class="w-full border rounded-xl px-4 py-2 resize-none outline-none focus:ring-2 focus:ring-orange-400" placeholder="Tell customers about yourself..."></textarea>
                </div>
                <div>
                    <label class="block text-gray-700 text-sm font-medium mb-1">Rate (‚Çπ/hour)</label>
                    <input type="number" id="editRate" min="50" class="w-full border rounded-xl px-4 py-2 outline-none focus:ring-2 focus:ring-orange-400">
                </div>
                <div>
                    <label class="block text-gray-700 text-sm font-medium mb-1">WhatsApp Number</label>
                    <input type="tel" id="editWhatsapp" maxlength="10" class="w-full border rounded-xl px-4 py-2 outline-none focus:ring-2 focus:ring-orange-400" placeholder="10-digit number">
                </div>
                <div>
                    <label class="block text-gray-700 text-sm font-medium mb-1">Working Hours</label>
                    <select id="editWorkingHours" class="w-full border rounded-xl px-4 py-2 outline-none focus:ring-2 focus:ring-orange-400">
                        <option value="mon-fri">Mon-Fri (9 AM - 6 PM)</option>
                        <option value="weekends">Weekends Only</option>
                        <option value="all-days">All Days</option>
                        <option value="24x7">24√ó7 Available</option>
                    </select>
                </div>
                <button onclick="saveProviderEdits()" class="w-full bg-orange-600 text-white py-3 rounded-xl font-semibold hover:bg-orange-700 transition">
                    üíæ Save Changes
                </button>
            </div>
        </div>
    </div>

    <!-- REGISTER PROVIDER (with rating field) -->
    <div id="page-register" class="page hidden">
        <div class="max-w-4xl mx-auto px-4 py-8">
            <h1 class="text-3xl font-bold text-gray-800 mb-6">Register as Service Provider</h1>
            
            <form id="providerForm" class="bg-white rounded-xl shadow-md p-6">

                <!-- PHASE E: Profile Photo Upload -->
                <div class="flex flex-col items-center mb-6">
                    <div class="relative">
                        <div id="photoPreviewContainer" class="w-28 h-28 rounded-full bg-gradient-to-br from-orange-100 to-orange-200 border-4 border-orange-400 flex items-center justify-center overflow-hidden shadow-lg">
                            <span id="photoPlaceholder" class="text-5xl">üë§</span>
                            <img id="photoPreview" class="hidden w-full h-full object-cover" alt="Profile Photo">
                        </div>
                        <label for="providerPhoto" class="absolute bottom-0 right-0 bg-orange-600 text-white rounded-full w-9 h-9 flex items-center justify-center cursor-pointer shadow-md hover:bg-orange-700 transition">
                            üì∑
                        </label>
                        <input type="file" id="providerPhoto" accept="image/*" capture="user" class="hidden" onchange="previewProviderPhoto(this)">
                    </div>
                    <p class="text-sm text-gray-500 mt-2">Upload your profile photo (optional)</p>
                </div>

                <div class="grid md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-gray-700 font-medium mb-2">Full Name *</label>
                        <input type="text" id="providerName" required class="w-full px-4 py-2 border rounded-lg">
                    </div>
                    <div>
                        <label class="block text-gray-700 font-medium mb-2">Mobile Number *</label>
                        <input type="tel" id="providerMobile" required pattern="[0-9]{10}" class="w-full px-4 py-2 border rounded-lg">
                    </div>
                    <!-- PHASE E: WhatsApp Number -->
                    <div>
                        <label class="block text-gray-700 font-medium mb-2">WhatsApp Number <span class="text-gray-400 font-normal">(if different from mobile)</span></label>
                        <div class="flex items-center border rounded-lg overflow-hidden">
                            <span class="bg-green-500 text-white px-3 py-2 text-lg">üí¨</span>
                            <input type="tel" id="providerWhatsapp" pattern="[0-9]{10}" placeholder="10-digit number" class="flex-1 px-3 py-2 outline-none">
                        </div>
                        <p class="text-xs text-gray-400 mt-1">Leave blank to use mobile number for WhatsApp</p>
                    </div>
                    <div>
                        <label class="block text-gray-700 font-medium mb-2">Category (Optional)</label>
                        <select id="providerCategory" class="w-full px-4 py-2 border rounded-lg" onchange="updateProviderSubcategories()"></select>
                    </div>
                    <div>
                        <label class="block text-gray-700 font-medium mb-2">Subcategory (Optional)</label>
                        <select id="providerSubcategory" class="w-full px-4 py-2 border rounded-lg" onchange="updateProviderSubSubcategories()"></select>
                    </div>
                    <div>
                        <label class="block text-gray-700 font-medium mb-2">Service Type (Optional)</label>
                        <select id="providerSubSubcategory" class="w-full px-4 py-2 border rounded-lg"></select>
                    </div>
                    <div>
                        <label class="block text-gray-700 font-medium mb-2">Religion *</label>
                        <select id="providerReligion" required class="w-full px-4 py-2 border rounded-lg">
                            <option value="">Select Religion</option>
                            <option value="Hindu">Hindu üïâÔ∏è</option>
                            <option value="Muslim">Muslim ‚ò™Ô∏è</option>
                            <option value="Christian">Christian ‚úùÔ∏è</option>
                            <option value="Sikh">Sikh ‚ò¨</option>
                            <option value="Buddhist">Buddhist ‚ò∏Ô∏è</option>
                            <option value="Jain">Jain ‚ò∏Ô∏è</option>
                        </select>
                    </div>
                    
                    <!-- PHASE B: Language Field -->
                    <div>
                        <label data-i18n="providerLanguage" class="block text-gray-700 font-medium mb-2">Provider Language *</label>
                        <select id="providerLanguage" required class="w-full px-4 py-2 border rounded-lg">
                            <option value="">Select Language</option>
                            <option value="English">English</option>
                            <option value="Hindi">‡§π‡§ø‡§Ç‡§¶‡•Ä (Hindi)</option>
                            <option value="Bengali">‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ (Bengali)</option>
                            <option value="Gujarati">‡™ó‡´Å‡™ú‡™∞‡™æ‡™§‡´Ä (Gujarati)</option>
                            <option value="Marathi">‡§Æ‡§∞‡§æ‡§†‡•Ä (Marathi)</option>
                            <option value="Kannada">‡≤ï‡≤®‡≥ç‡≤®‡≤° (Kannada)</option>
                        </select>
                    </div>
                    
                    <div>
                        <label class="block text-gray-700 font-medium mb-2">Experience (years) *</label>
                        <input type="number" id="providerExperience" required min="0" max="50" class="w-full px-4 py-2 border rounded-lg">
                    </div>
                    <div>
                        <label class="block text-gray-700 font-medium mb-2">Rate (‚Çπ/hour) *</label>
                        <input type="number" id="providerRate" required min="50" class="w-full px-4 py-2 border rounded-lg">
                    </div>
                </div>
                
                <!-- PHASE B: Working Hours -->
                <div class="mt-6">
                    <label data-i18n="workingHours" class="block text-gray-700 font-medium mb-3">Working Hours *</label>
                    <div class="grid grid-cols-2 md:grid-cols-4 gap-3">
                        <label class="border rounded-lg p-3 cursor-pointer hover:bg-orange-50 transition">
                            <input type="radio" name="workingHours" value="mon-fri" required class="mr-2">
                            <span data-i18n="monFri" class="font-medium">Mon-Fri (9 AM - 6 PM)</span>
                        </label>
                        <label class="border rounded-lg p-3 cursor-pointer hover:bg-orange-50 transition">
                            <input type="radio" name="workingHours" value="weekends" class="mr-2">
                            <span data-i18n="weekends" class="font-medium">Weekends Only</span>
                        </label>
                        <label class="border rounded-lg p-3 cursor-pointer hover:bg-orange-50 transition">
                            <input type="radio" name="workingHours" value="all-days" class="mr-2">
                            <span data-i18n="allDays" class="font-medium">All Days (7 days/week)</span>
                        </label>
                        <label class="border rounded-lg p-3 cursor-pointer hover:bg-orange-50 transition">
                            <input type="radio" name="workingHours" value="24x7" class="mr-2">
                            <span data-i18n="available24x7" class="font-medium">24√ó7 Available</span>
                        </label>
                    </div>
                </div>
                
                <!-- PHASE B: Service Area -->
                <div class="mt-6">
                    <label data-i18n="serviceArea" class="block text-gray-700 font-medium mb-3">Service Area *</label>
                    <div class="grid grid-cols-2 gap-3">
                        <label class="border rounded-lg p-3 cursor-pointer hover:bg-orange-50 transition">
                            <input type="radio" name="serviceArea" value="10km" required class="mr-2">
                            <span data-i18n="within10km" class="font-medium">Within 10 km</span>
                        </label>
                        <label class="border rounded-lg p-3 cursor-pointer hover:bg-orange-50 transition">
                            <input type="radio" name="serviceArea" value="city" class="mr-2">
                            <span data-i18n="withinCity" class="font-medium">Within City</span>
                        </label>
                    </div>
                </div>
                
                <!-- PHASE E: Short Bio -->
                <div class="mt-4">
                    <label class="block text-gray-700 font-medium mb-2">About You / Bio <span class="text-gray-400 font-normal">(optional)</span></label>
                    <textarea id="providerBio" rows="3" maxlength="250" placeholder="Tell customers about your skills, experience and what makes you special... (max 250 characters)" class="w-full px-4 py-2 border rounded-lg resize-none" oninput="document.getElementById('bioCount').textContent=this.value.length"></textarea>
                    <p class="text-xs text-gray-400 text-right"><span id="bioCount">0</span>/250</p>
                </div>

                <div class="mt-4">
                    <label class="block text-gray-700 font-medium mb-2">Location/Address *</label>
                    <input type="text" id="providerLocation" required class="w-full px-4 py-2 border rounded-lg">
                </div>
                
                <div class="mt-4">
                    <div class="flex justify-between items-center mb-2">
                        <label class="block text-gray-700 font-medium">Set Your Location on Map</label>
                        <button type="button" onclick="useMyLocation('provider')" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 font-medium">
                            üìç Use My Location
                        </button>
                    </div>
                    <div id="registerMap" class="reg-map bg-gray-100"></div>
                    <p class="text-sm text-gray-600 mt-2">Click "Use My Location" to auto-detect, or click/drag marker on map</p>
                    <input type="hidden" id="providerLat">
                    <input type="hidden" id="providerLng">
                </div>
                
                <div class="mt-6">
                    <button type="submit" class="w-full bg-orange-600 text-white py-3 rounded-lg font-semibold hover:bg-orange-700 text-lg">Register Now</button>
                </div>
            </form>
            
            <div id="providerSuccess" class="hidden mt-6 bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded-lg">
                ‚úì Registration successful!
            </div>
        </div>
    </div>

    <!-- REGISTER SEEKER (with location) -->
    <div id="page-seeker" class="page hidden">
        <div class="max-w-4xl mx-auto px-4 py-8">
            <h1 class="text-3xl font-bold text-gray-800 mb-6">Register as Service Seeker</h1>
            
            <form id="seekerForm" class="bg-white rounded-xl shadow-md p-6">
                <div class="grid md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-gray-700 font-medium mb-2">Full Name *</label>
                        <input type="text" id="seekerName" required class="w-full px-4 py-2 border rounded-lg">
                    </div>
                    <div>
                        <label class="block text-gray-700 font-medium mb-2">Mobile Number *</label>
                        <input type="tel" id="seekerMobile" required pattern="[0-9]{10}" class="w-full px-4 py-2 border rounded-lg">
                    </div>
                    <div>
                        <label class="block text-gray-700 font-medium mb-2">Religion *</label>
                        <select id="seekerReligion" required class="w-full px-4 py-2 border rounded-lg">
                            <option value="">Select Religion</option>
                            <option value="Hindu">Hindu üïâÔ∏è</option>
                            <option value="Muslim">Muslim ‚ò™Ô∏è</option>
                            <option value="Christian">Christian ‚úùÔ∏è</option>
                            <option value="Sikh">Sikh ‚ò¨</option>
                            <option value="Buddhist">Buddhist ‚ò∏Ô∏è</option>
                            <option value="Jain">Jain ‚ò∏Ô∏è</option>
                        </select>
                    </div>
                </div>
                
                <div class="mt-4">
                    <label class="block text-gray-700 font-medium mb-2">Location/Address *</label>
                    <input type="text" id="seekerLocation" required class="w-full px-4 py-2 border rounded-lg">
                </div>
                
                <div class="mt-4">
                    <div class="flex justify-between items-center mb-2">
                        <label class="block text-gray-700 font-medium">Set Your Location on Map</label>
                        <button type="button" onclick="useMyLocation('seeker')" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 font-medium">
                            üìç Use My Location
                        </button>
                    </div>
                    <div id="seekerMap" class="reg-map bg-gray-100"></div>
                    <p class="text-sm text-gray-600 mt-2">Click "Use My Location" to auto-detect, or click/drag marker on map</p>
                    <input type="hidden" id="seekerLat">
                    <input type="hidden" id="seekerLng">
                </div>
                
                <div class="mt-6">
                    <button type="submit" class="w-full bg-blue-600 text-white py-3 rounded-lg font-semibold hover:bg-blue-700 text-lg">Register Now</button>
                </div>
            </form>
            
            <div id="seekerSuccess" class="hidden mt-6 bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded-lg">
                ‚úì Registration successful!
            </div>
        </div>
    </div>

    <!-- ADMIN PAGE -->
    <div id="page-admin" class="page hidden">
        <div class="max-w-7xl mx-auto px-4 py-8">
            <div id="adminLogin" class="max-w-md mx-auto">
                <h1 class="text-3xl font-bold text-gray-800 mb-6 text-center">üîê Admin Login</h1>
                <div class="bg-white rounded-xl shadow-md p-6">
                    <input type="password" id="adminPassword" placeholder="Password: admin123" class="w-full px-4 py-2 border rounded-lg mb-4">
                    <button onclick="adminLogin()" class="w-full bg-purple-600 text-white py-3 rounded-lg font-semibold hover:bg-purple-700">Login</button>
                </div>
            </div>
            
            <div id="adminDashboard" class="hidden">
                <div class="flex justify-between items-center mb-6">
                    <h1 class="text-3xl font-bold text-gray-800">Admin Dashboard</h1>
                    <button onclick="adminLogout()" class="bg-red-600 text-white px-6 py-2 rounded-lg hover:bg-red-700">Logout</button>
                </div>
                
                <!-- Stats Cards -->
                <div class="grid md:grid-cols-4 gap-6 mb-8">
                    <div class="bg-gradient-to-br from-orange-500 to-orange-600 text-white p-6 rounded-xl shadow-lg">
                        <div class="text-4xl font-bold" id="totalProviders">0</div>
                        <div class="mt-2 opacity-90">Total Providers</div>
                    </div>
                    <div class="bg-gradient-to-br from-blue-500 to-blue-600 text-white p-6 rounded-xl shadow-lg">
                        <div class="text-4xl font-bold" id="totalSeekers">0</div>
                        <div class="mt-2 opacity-90">Total Seekers</div>
                    </div>
                    <div class="bg-gradient-to-br from-green-500 to-green-600 text-white p-6 rounded-xl shadow-lg">
                        <div class="text-4xl font-bold" id="totalCategories">0</div>
                        <div class="mt-2 opacity-90">Total Categories</div>
                    </div>
                    <div class="bg-gradient-to-br from-purple-500 to-purple-600 text-white p-6 rounded-xl shadow-lg">
                        <div class="text-4xl font-bold" id="totalRestricted">0</div>
                        <div class="mt-2 opacity-90">Restricted Users</div>
                    </div>
                    <div class="bg-gradient-to-br from-yellow-500 to-yellow-600 text-white p-6 rounded-xl shadow-lg">
                        <div class="text-4xl font-bold" id="totalReviews">0</div>
                        <div class="mt-2 opacity-90">‚≠ê Total Reviews</div>
                    </div>
                </div>
                
                <!-- Tabs for different sections -->
                <div class="bg-white rounded-xl shadow-lg mb-6">
                    <div class="flex border-b">
                        <button onclick="showAdminTab('users')" id="tab-users" class="flex-1 px-6 py-4 font-semibold text-gray-600 hover:text-orange-600 border-b-2 border-transparent">
                            üë• Users
                        </button>
                        <button onclick="showAdminTab('reports')" id="tab-reports" class="flex-1 px-6 py-4 font-semibold text-gray-600 hover:text-orange-600 border-b-2 border-transparent">
                            üö® Reports
                        </button>
                        <button onclick="showAdminTab('categories')" id="tab-categories" class="flex-1 px-6 py-4 font-semibold text-gray-600 hover:text-orange-600 border-b-2 border-orange-600">
                            üìã Categories
                        </button>
                    </div>
                </div>
                
                <!-- USER MANAGEMENT TAB -->
                <div id="adminTab-users" class="hidden">
                    <div class="bg-white rounded-xl shadow-lg p-6 mb-6">
                        <div class="flex justify-between items-center mb-4">
                            <h2 class="text-2xl font-bold text-gray-800">üë• Providers Management</h2>
                            <input type="text" id="searchProviders" placeholder="Search providers..." class="px-4 py-2 border rounded-lg" onkeyup="filterProvidersList()">
                        </div>
                        <div id="providersListAdmin" class="space-y-3"></div>
                    </div>
                    
                    <div class="bg-white rounded-xl shadow-lg p-6">
                        <div class="flex justify-between items-center mb-4">
                            <h2 class="text-2xl font-bold text-gray-800">üë§ Seekers Management</h2>
                            <input type="text" id="searchSeekers" placeholder="Search seekers..." class="px-4 py-2 border rounded-lg" onkeyup="filterSeekersList()">
                        </div>
                        <div id="seekersListAdmin" class="space-y-3"></div>
                    </div>
                </div>
                
                <!-- REPORTS TAB -->
                <div id="adminTab-reports" class="hidden">
                    <div class="bg-white rounded-xl shadow-lg p-6">
                        <div class="flex justify-between items-center mb-4">
                            <h2 class="text-2xl font-bold text-gray-800">üö® Complaints & Reports</h2>
                            <button onclick="loadAdminReports()" class="bg-orange-600 text-white px-4 py-2 rounded-lg text-sm hover:bg-orange-700">üîÑ Refresh</button>
                        </div>
                        <div id="adminReportsList" class="space-y-4">
                            <p class="text-gray-400 text-center py-8">Click Refresh to load reports</p>
                        </div>
                    </div>
                </div>

                <!-- CATEGORY MANAGEMENT TAB -->
                <div id="adminTab-categories" class="">
                    <div class="bg-white rounded-xl shadow-lg p-6">
                        <div class="flex justify-between items-center mb-6">
                            <h2 class="text-2xl font-bold text-gray-800">üìã Category Management</h2>
                            <div class="flex gap-2">
                                <button onclick="resetToDefaults()" class="bg-yellow-600 text-white px-4 py-2 rounded-lg hover:bg-yellow-700 font-medium">
                                    üîÑ Reset to Defaults
                                </button>
                                <button onclick="showAddCategoryModal()" class="bg-green-600 text-white px-6 py-3 rounded-lg hover:bg-green-700 font-semibold shadow">
                                    ‚ûï Add New Category
                                </button>
                            </div>
                        </div>
                        
                        <div id="categoriesListAdmin" class="space-y-4"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- MODALS FOR ADMIN -->
    
    <!-- Add/Edit Category Modal -->
    <div id="categoryModal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl p-8 max-w-md w-full">
            <h3 class="text-2xl font-bold mb-4" id="categoryModalTitle">Add Category</h3>
            <div class="space-y-4">
                <div>
                    <label class="block text-gray-700 font-medium mb-2">Category Name (English)</label>
                    <input type="text" id="modalCategoryName" class="w-full px-4 py-2 border rounded-lg" placeholder="e.g., Home Services">
                </div>
                <div>
                    <label class="block text-gray-700 font-medium mb-2">Emoji Icon</label>
                    <input type="text" id="modalCategoryIcon" class="w-full px-4 py-2 border rounded-lg text-center text-3xl" placeholder="üè†" maxlength="2">
                </div>
                <div class="flex gap-3">
                    <button onclick="saveCategoryModal()" class="flex-1 bg-green-600 text-white py-3 rounded-lg hover:bg-green-700 font-semibold">Save</button>
                    <button onclick="closeCategoryModal()" class="flex-1 bg-gray-400 text-white py-3 rounded-lg hover:bg-gray-500 font-semibold">Cancel</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Add/Edit Subcategory Modal -->
    <div id="subcategoryModal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl p-8 max-w-md w-full">
            <h3 class="text-2xl font-bold mb-4" id="subcategoryModalTitle">Add Subcategory</h3>
            <div class="space-y-4">
                <div>
                    <label class="block text-gray-700 font-medium mb-2">Subcategory Name (English)</label>
                    <input type="text" id="modalSubcategoryName" class="w-full px-4 py-2 border rounded-lg" placeholder="e.g., Plumbing">
                </div>
                <div>
                    <label class="block text-gray-700 font-medium mb-2">Emoji Icon</label>
                    <input type="text" id="modalSubcategoryIcon" class="w-full px-4 py-2 border rounded-lg text-center text-3xl" placeholder="üîß" maxlength="2">
                </div>
                <div class="flex gap-3">
                    <button onclick="saveSubcategoryModal()" class="flex-1 bg-blue-600 text-white py-3 rounded-lg hover:bg-blue-700 font-semibold">Save</button>
                    <button onclick="closeSubcategoryModal()" class="flex-1 bg-gray-400 text-white py-3 rounded-lg hover:bg-gray-500 font-semibold">Cancel</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- ===== PHASE F: PHONE OTP LOGIN MODAL ===== -->
    <div id="loginModal" class="hidden fixed inset-0 bg-black bg-opacity-70 z-50 flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl max-w-sm w-full shadow-2xl overflow-hidden">
            <!-- Header -->
            <div class="bg-gradient-to-br from-orange-500 to-orange-600 p-6 text-white text-center">
                <div class="text-4xl mb-2">üî±</div>
                <h2 class="text-xl font-bold">Sudarshan Chakra</h2>
                <p class="text-orange-100 text-sm mt-1">Login with your mobile number</p>
            </div>

            <!-- Step 1: Enter Phone -->
            <div id="loginStep1" class="p-6">
                <label class="block text-gray-700 font-medium mb-3">üì± Mobile Number</label>
                <div class="flex gap-2 mb-4">
                    <div class="bg-gray-100 border rounded-xl px-3 py-3 text-gray-600 font-medium flex-shrink-0">üáÆüá≥ +91</div>
                    <input type="tel" id="loginPhone" maxlength="10" pattern="[0-9]{10}" placeholder="10-digit number"
                        class="flex-1 border rounded-xl px-4 py-3 text-lg focus:ring-2 focus:ring-orange-400 outline-none"
                        oninput="this.value=this.value.replace(/\D/g,'').substring(0,10)">
                </div>
                <!-- Invisible reCAPTCHA container -->
                <div id="recaptcha-container"></div>
                <button onclick="sendOTP()" id="sendOtpBtn" class="w-full bg-orange-600 text-white py-3 rounded-xl font-semibold hover:bg-orange-700 transition text-lg">
                    Send OTP
                </button>
                <p class="text-xs text-gray-400 text-center mt-3">OTP will be sent via SMS. Standard rates apply.</p>
                <button onclick="closeLoginModal()" class="w-full mt-2 text-gray-500 py-2 text-sm hover:text-gray-700">Cancel</button>
            </div>

            <!-- Step 2: Enter OTP -->
            <div id="loginStep2" class="p-6 hidden">
                <div class="text-center mb-4">
                    <div class="text-3xl mb-2">üì≤</div>
                    <p class="text-gray-700 font-medium">OTP sent to <span id="loginPhoneDisplay" class="text-orange-600 font-bold"></span></p>
                    <p class="text-sm text-gray-500 mt-1">Enter the 6-digit code</p>
                </div>
                <div class="flex gap-2 justify-center mb-5">
                    <input type="tel" id="otpInput" maxlength="6" placeholder="‚Äî ‚Äî ‚Äî ‚Äî ‚Äî ‚Äî"
                        class="w-full text-center border-2 rounded-xl px-4 py-4 text-2xl font-bold tracking-widest focus:ring-2 focus:ring-orange-400 outline-none"
                        oninput="this.value=this.value.replace(/\D/g,'').substring(0,6)">
                </div>
                <button onclick="verifyOTP()" id="verifyOtpBtn" class="w-full bg-orange-600 text-white py-3 rounded-xl font-semibold hover:bg-orange-700 transition text-lg">
                    Verify & Login
                </button>
                <button onclick="document.getElementById('loginStep1').classList.remove('hidden'); document.getElementById('loginStep2').classList.add('hidden')" class="w-full mt-2 text-gray-500 py-2 text-sm hover:text-gray-700">
                    ‚Üê Change Number
                </button>
            </div>

            <!-- Step 3: New User Setup -->
            <div id="loginStep3" class="p-6 hidden">
                <div class="text-center mb-4">
                    <div class="text-3xl mb-2">üëã</div>
                    <p class="font-bold text-gray-800 text-lg">Welcome! Tell us about yourself</p>
                    <p class="text-sm text-gray-500">First time login ‚Äî quick setup</p>
                </div>
                <div class="space-y-3">
                    <div>
                        <label class="block text-gray-700 text-sm font-medium mb-1">Your Name *</label>
                        <input type="text" id="newUserName" placeholder="Full name" class="w-full border rounded-xl px-4 py-3 focus:ring-2 focus:ring-orange-400 outline-none">
                    </div>
                    <div>
                        <label class="block text-gray-700 text-sm font-medium mb-1">I am a...</label>
                        <div class="grid grid-cols-2 gap-3">
                            <label class="border-2 rounded-xl p-3 cursor-pointer hover:border-orange-400 transition text-center has-[:checked]:border-orange-500 has-[:checked]:bg-orange-50">
                                <input type="radio" name="userRole" value="seeker" class="hidden"> 
                                <div class="text-2xl mb-1">üîç</div>
                                <div class="font-medium text-sm">Service Seeker</div>
                                <div class="text-xs text-gray-500">Looking for services</div>
                            </label>
                            <label class="border-2 rounded-xl p-3 cursor-pointer hover:border-orange-400 transition text-center has-[:checked]:border-orange-500 has-[:checked]:bg-orange-50">
                                <input type="radio" name="userRole" value="provider" class="hidden">
                                <div class="text-2xl mb-1">üõ†Ô∏è</div>
                                <div class="font-medium text-sm">Service Provider</div>
                                <div class="text-xs text-gray-500">Offering services</div>
                            </label>
                        </div>
                    </div>
                </div>
                <button onclick="completeNewUserSetup()" class="w-full mt-4 bg-orange-600 text-white py-3 rounded-xl font-semibold hover:bg-orange-700 transition">
                    Get Started üöÄ
                </button>
            </div>
        </div>
    </div>

    <!-- ===== PHASE F: REPORT / COMPLAINT MODAL ===== -->
    <div id="reportModal" class="hidden fixed inset-0 bg-black bg-opacity-70 z-50 flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl max-w-md w-full shadow-2xl">
            <div class="bg-red-600 p-5 rounded-t-2xl text-white">
                <div class="flex justify-between items-center">
                    <h3 class="text-lg font-bold">üö® Report / Complaint</h3>
                    <button onclick="closeReportModal()" class="text-white text-2xl opacity-75 hover:opacity-100">‚úï</button>
                </div>
                <p id="reportTargetName" class="text-red-100 text-sm mt-1"></p>
            </div>
            <div class="p-5 space-y-4">
                <div>
                    <label class="block text-gray-700 font-medium mb-2">Type of Issue *</label>
                    <select id="reportType" class="w-full border rounded-xl px-4 py-3 focus:ring-2 focus:ring-red-400 outline-none">
                        <option value="">Select issue type</option>
                        <option value="misconduct">üò§ Misconduct / Rude Behaviour</option>
                        <option value="improper_service">‚ö†Ô∏è Improper / Poor Service Quality</option>
                        <option value="payment_issue">üí∏ Payment Dispute / Overcharging</option>
                        <option value="no_show">üö´ No Show / Did Not Arrive</option>
                        <option value="fraud">üî¥ Fraud / Scam</option>
                        <option value="harassment">üõë Harassment / Threats</option>
                        <option value="fake_profile">üë§ Fake Profile / Wrong Information</option>
                        <option value="other">üìù Other Issue</option>
                    </select>
                </div>
                <div>
                    <label class="block text-gray-700 font-medium mb-2">Describe the Issue *</label>
                    <textarea id="reportDescription" rows="4" maxlength="500" placeholder="Please describe what happened in detail. Date, time, what was promised and what happened..." class="w-full border rounded-xl px-4 py-3 resize-none focus:ring-2 focus:ring-red-400 outline-none"></textarea>
                    <p class="text-xs text-gray-400 text-right mt-1"><span id="reportCharCount">0</span>/500</p>
                </div>
                <div>
                    <label class="block text-gray-700 font-medium mb-2">Your Name (for admin contact)</label>
                    <input type="text" id="reporterNameInput" placeholder="Your name" class="w-full border rounded-xl px-4 py-3 focus:ring-2 focus:ring-red-400 outline-none">
                </div>
                <div class="bg-yellow-50 border border-yellow-200 rounded-xl p-3 text-sm text-yellow-800">
                    ‚ö†Ô∏è Your report will be reviewed by admin within 24 hours. The reported person will NOT see your identity.
                </div>
                <div class="flex gap-3">
                    <button onclick="submitReport()" class="flex-1 bg-red-600 text-white py-3 rounded-xl font-semibold hover:bg-red-700 transition">Submit Report</button>
                    <button onclick="closeReportModal()" class="flex-1 bg-gray-200 text-gray-700 py-3 rounded-xl font-semibold hover:bg-gray-300 transition">Cancel</button>
                </div>
            </div>
        </div>
    </div>

    <!-- ===== PHASE E: REVIEW MODAL ===== -->
    <div id="reviewModal" class="hidden fixed inset-0 bg-black bg-opacity-60 z-50 flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl p-6 max-w-md w-full shadow-2xl">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-xl font-bold text-gray-800">‚≠ê Write a Review</h3>
                <button onclick="closeReviewModal()" class="text-gray-400 hover:text-gray-600 text-2xl">‚úï</button>
            </div>
            <div id="reviewProviderName" class="text-orange-600 font-semibold mb-4 text-center text-lg"></div>

            <!-- Star Rating Selector -->
            <div class="text-center mb-5">
                <p class="text-gray-600 mb-3 font-medium">Your Rating *</p>
                <div id="starSelector" class="flex justify-center gap-2 text-4xl cursor-pointer">
                    <span class="star-btn text-gray-300 hover:text-yellow-400 transition" data-val="1">‚òÖ</span>
                    <span class="star-btn text-gray-300 hover:text-yellow-400 transition" data-val="2">‚òÖ</span>
                    <span class="star-btn text-gray-300 hover:text-yellow-400 transition" data-val="3">‚òÖ</span>
                    <span class="star-btn text-gray-300 hover:text-yellow-400 transition" data-val="4">‚òÖ</span>
                    <span class="star-btn text-gray-300 hover:text-yellow-400 transition" data-val="5">‚òÖ</span>
                </div>
                <p id="ratingLabel" class="text-sm text-gray-400 mt-2">Tap to rate</p>
            </div>

            <div class="mb-4">
                <label class="block text-gray-700 font-medium mb-2">Your Name *</label>
                <input type="text" id="reviewerName" placeholder="Your name" class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-orange-400 outline-none">
            </div>
            <div class="mb-5">
                <label class="block text-gray-700 font-medium mb-2">Your Review *</label>
                <textarea id="reviewText" rows="3" maxlength="300" placeholder="Share your experience with this provider..." class="w-full px-4 py-2 border rounded-lg resize-none focus:ring-2 focus:ring-orange-400 outline-none"></textarea>
            </div>
            <div class="flex gap-3">
                <button onclick="submitReview()" class="flex-1 bg-orange-600 text-white py-3 rounded-lg hover:bg-orange-700 font-semibold">Submit Review</button>
                <button onclick="closeReviewModal()" class="flex-1 bg-gray-200 text-gray-700 py-3 rounded-lg hover:bg-gray-300 font-semibold">Cancel</button>
            </div>
        </div>
    </div>

    <!-- ===== PHASE E: PROVIDER PROFILE MODAL ===== -->
    <div id="profileModal" class="hidden fixed inset-0 bg-black bg-opacity-60 z-50 flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl max-w-lg w-full shadow-2xl max-h-[90vh] overflow-y-auto">
            <div id="profileModalContent"></div>
        </div>
    </div>

    <!-- Add/Edit Service Modal -->
    <div id="serviceModal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl p-8 max-w-md w-full">
            <h3 class="text-2xl font-bold mb-4" id="serviceModalTitle">Add Service Type</h3>
            <div class="space-y-4">
                <div>
                    <label class="block text-gray-700 font-medium mb-2">Service Name (English)</label>
                    <input type="text" id="modalServiceName" class="w-full px-4 py-2 border rounded-lg" placeholder="e.g., Pipe Repair">
                </div>
                <div>
                    <label class="block text-gray-700 font-medium mb-2">Emoji Icon</label>
                    <input type="text" id="modalServiceIcon" class="w-full px-4 py-2 border rounded-lg text-center text-3xl" placeholder="üîß" maxlength="2">
                </div>
                <div class="flex gap-3">
                    <button onclick="saveServiceModal()" class="flex-1 bg-purple-600 text-white py-3 rounded-lg hover:bg-purple-700 font-semibold">Save</button>
                    <button onclick="closeServiceModal()" class="flex-1 bg-gray-400 text-white py-3 rounded-lg hover:bg-gray-500 font-semibold">Cancel</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ==================== DATA & INITIALIZATION ====================
        let currentLanguage = localStorage.getItem('language') || 'en';
        let providers = []; // Populated from Firebase Realtime Database
        let seekers = [];   // Populated from Firebase Realtime Database
        let currentUser = JSON.parse(localStorage.getItem('currentUser')) || null;
        let maps = {};
        
        // Firebase references (set when Firebase is ready)
        let _db = null, _ref = null, _set = null, _push = null, _onValue = null, _update = null, _remove = null, _get = null;
        let firebaseListenersAttached = false;
        
        // ==================== FIREBASE HELPERS ====================
        function fbRef(path) { return _ref(_db, path); }
        
        function showFirebaseStatus(msg, type = 'info') {
            // Show a small non-blocking toast
            const existing = document.getElementById('fb-toast');
            if (existing) existing.remove();
            const toast = document.createElement('div');
            toast.id = 'fb-toast';
            const colors = { info: '#2563eb', success: '#16a34a', error: '#dc2626' };
            toast.style.cssText = `position:fixed;bottom:20px;right:20px;z-index:9999;background:${colors[type]||colors.info};color:#fff;padding:10px 18px;border-radius:8px;font-size:14px;font-weight:500;box-shadow:0 4px 12px rgba(0,0,0,0.2);transition:opacity 0.3s`;
            toast.textContent = msg;
            document.body.appendChild(toast);
            setTimeout(() => { toast.style.opacity = '0'; setTimeout(() => toast.remove(), 300); }, 3000);
        }
        
        // Save a provider to Firebase
        async function saveProviderToFirebase(provider) {
            try {
                if (!_db) throw new Error('Firebase not ready');
                await _set(fbRef('providers/' + provider.id), provider);
                return true;
            } catch (err) {
                console.error('Firebase save provider error:', err);
                showFirebaseStatus('‚ùå Error saving provider. Check connection.', 'error');
                return false;
            }
        }
        
        // Save a seeker to Firebase
        async function saveSeekerToFirebase(seeker) {
            try {
                if (!_db) throw new Error('Firebase not ready');
                await _set(fbRef('seekers/' + seeker.id), seeker);
                return true;
            } catch (err) {
                console.error('Firebase save seeker error:', err);
                showFirebaseStatus('‚ùå Error saving seeker. Check connection.', 'error');
                return false;
            }
        }
        
        // Update a provider field in Firebase
        async function updateProviderInFirebase(providerId, updates) {
            try {
                if (!_db) throw new Error('Firebase not ready');
                await _update(fbRef('providers/' + providerId), updates);
                return true;
            } catch (err) {
                console.error('Firebase update provider error:', err);
                showFirebaseStatus('‚ùå Error updating provider. Check connection.', 'error');
                return false;
            }
        }
        
        // Update a seeker field in Firebase
        async function updateSeekerInFirebase(seekerId, updates) {
            try {
                if (!_db) throw new Error('Firebase not ready');
                await _update(fbRef('seekers/' + seekerId), updates);
                return true;
            } catch (err) {
                console.error('Firebase update seeker error:', err);
                showFirebaseStatus('‚ùå Error updating seeker. Check connection.', 'error');
                return false;
            }
        }
        
        // Delete a provider from Firebase
        async function deleteProviderFromFirebase(providerId) {
            try {
                if (!_db) throw new Error('Firebase not ready');
                await _remove(fbRef('providers/' + providerId));
                return true;
            } catch (err) {
                console.error('Firebase delete provider error:', err);
                showFirebaseStatus('‚ùå Error deleting provider. Check connection.', 'error');
                return false;
            }
        }
        
        // Delete a seeker from Firebase
        async function deleteSeekerFromFirebase(seekerId) {
            try {
                if (!_db) throw new Error('Firebase not ready');
                await _remove(fbRef('seekers/' + seekerId));
                return true;
            } catch (err) {
                console.error('Firebase delete seeker error:', err);
                showFirebaseStatus('‚ùå Error deleting seeker. Check connection.', 'error');
                return false;
            }
        }
        
        // Attach real-time listeners for providers and seekers
        function attachFirebaseListeners() {
            if (firebaseListenersAttached || !_db) return;
            firebaseListenersAttached = true;
            
            // Listen for providers changes (real-time)
            _onValue(fbRef('providers'), (snapshot) => {
                const data = snapshot.val();
                providers = data ? Object.values(data) : [];
                console.log('üîÑ Providers updated from Firebase:', providers.length);
                // Refresh UI if browse page is visible
                if (!document.getElementById('page-browse').classList.contains('hidden')) {
                    if (selectedServiceIdx !== null) applySortAndFilter();
                }
                // Refresh admin if open
                if (!document.getElementById('page-admin').classList.contains('hidden')) {
                    updateAdminStats();
                    if (!document.getElementById('adminTab-users').classList.contains('hidden')) {
                        loadProvidersList();
                    }
                }
                // Refresh map if open
                if (!document.getElementById('page-map').classList.contains('hidden')) {
                    initMainMap();
                }
            }, (err) => {
                console.error('Firebase providers listener error:', err);
                showFirebaseStatus('‚ö†Ô∏è Firebase connection issue. Data may be outdated.', 'error');
            });
            
            // Listen for seekers changes (real-time)
            _onValue(fbRef('seekers'), (snapshot) => {
                const data = snapshot.val();
                seekers = data ? Object.values(data) : [];
                console.log('üîÑ Seekers updated from Firebase:', seekers.length);
                if (!document.getElementById('page-admin').classList.contains('hidden')) {
                    updateAdminStats();
                    if (!document.getElementById('adminTab-users').classList.contains('hidden')) {
                        loadSeekersList();
                    }
                }
            }, (err) => {
                console.error('Firebase seekers listener error:', err);
            });
            
            showFirebaseStatus('üî• Connected to Firebase ‚Äî real-time sync active!', 'success');
        }
        
        // Initialize Firebase when ready
        function onFirebaseReady() {
            const fb = window._firebase;
            _db = fb.db;
            _ref = fb.ref;
            _set = fb.set;
            _push = fb.push;
            _onValue = fb.onValue;
            _update = fb.update;
            _remove = fb.remove;
            _get = fb.get;
            
            attachFirebaseListeners();
        }
        
        // Check if Firebase is already ready (race condition safety)
        if (window._firebaseReady) {
            onFirebaseReady();
        } else {
            window.addEventListener('firebaseReady', onFirebaseReady);
        }
        
        // Selected browsing state
        let selectedCategoryId = null;
        let selectedSubcategoryIdx = null;
        let selectedServiceIdx = null;
        
        const ADMIN_PASSWORD = 'admin123';
        
        // Religion icons
        const religionIcons = {
            'Hindu': 'üïâÔ∏è',
            'Muslim': '‚ò™Ô∏è',
            'Christian': '‚úùÔ∏è',
            'Sikh': '‚ò¨',
            'Buddhist': '‚ò∏Ô∏è',
            'Jain': '‚ò∏Ô∏è'
        };
        
        // ==================== TRANSLATIONS ====================
        const translations = {
            // Navigation
            'home': { en: 'Home', hi: '‡§π‡•ã‡§Æ', bn: '‡¶π‡ßã‡¶Æ', gu: '‡™π‡´ã‡™Æ', mr: '‡§π‡•ã‡§Æ', kn: '‡≤Æ‡≤®‡≥Ü' },
            'browse': { en: 'Browse', hi: '‡§¨‡•ç‡§∞‡§æ‡§â‡§ú‡§º', bn: '‡¶¨‡ßç‡¶∞‡¶æ‡¶â‡¶ú', gu: '‡™¨‡´ç‡™∞‡™æ‡™â‡™ù', mr: '‡§¨‡•ç‡§∞‡§æ‡§â‡§ù', kn: '‡≤¨‡≥ç‡≤∞‡≥å‡≤∏‡≥ç' },
            'map': { en: 'Map', hi: '‡§Æ‡•à‡§™', bn: '‡¶Æ‡¶æ‡¶®‡¶ö‡¶ø‡¶§‡ßç‡¶∞', gu: '‡™®‡™ï‡™∂‡´ã', mr: '‡§®‡§ï‡§æ‡§∂‡§æ', kn: '‡≤®‡≤ï‡≥ç‡≤∑‡≥Ü' },
            'registerProvider': { en: 'Register Provider', hi: '‡§™‡•ç‡§∞‡§¶‡§æ‡§§‡§æ ‡§™‡§Ç‡§ú‡•Ä‡§ï‡§∞‡§£', bn: '‡¶™‡ßç‡¶∞‡¶¶‡¶æ‡¶®‡¶ï‡¶æ‡¶∞‡ßÄ ‡¶®‡¶ø‡¶¨‡¶®‡ßç‡¶ß‡¶®', gu: '‡™™‡´ç‡™∞‡™¶‡™æ‡™§‡™æ ‡™®‡´ã‡™Ç‡™ß‡™£‡´Ä', mr: '‡§™‡•ç‡§∞‡§¶‡§æ‡§§‡§æ ‡§®‡•ã‡§Ç‡§¶‡§£‡•Ä', kn: '‡≤™‡≥Ç‡≤∞‡≥à‡≤ï‡≥Ü‡≤¶‡≤æ‡≤∞ ‡≤®‡≥ã‡≤Ç‡≤¶‡≤£‡≤ø' },
            'registerSeeker': { en: 'Register Seeker', hi: '‡§∏‡§æ‡§ß‡§ï ‡§™‡§Ç‡§ú‡•Ä‡§ï‡§∞‡§£', bn: '‡¶Ö‡¶®‡ßÅ‡¶∏‡¶®‡ßç‡¶ß‡¶æ‡¶®‡¶ï‡¶æ‡¶∞‡ßÄ ‡¶®‡¶ø‡¶¨‡¶®‡ßç‡¶ß‡¶®', gu: '‡™∂‡´ã‡™ß‡™®‡™æ‡™∞ ‡™®‡´ã‡™Ç‡™ß‡™£‡´Ä', mr: '‡§∂‡•ã‡§ß‡§ï ‡§®‡•ã‡§Ç‡§¶‡§£‡•Ä', kn: '‡≤π‡≥Å‡≤°‡≥Å‡≤ï‡≥Å‡≤µ‡≤µ‡≤∞ ‡≤®‡≥ã‡≤Ç‡≤¶‡≤£‡≤ø' },
            'admin': { en: 'Admin', hi: '‡§µ‡•ç‡§Ø‡§µ‡§∏‡•ç‡§•‡§æ‡§™‡§ï', bn: '‡¶™‡ßç‡¶∞‡¶∂‡¶æ‡¶∏‡¶ï', gu: '‡™µ‡´ç‡™Ø‡™µ‡™∏‡´ç‡™•‡™æ‡™™‡™ï', mr: '‡§™‡•ç‡§∞‡§∂‡§æ‡§∏‡§ï', kn: '‡≤®‡≤ø‡≤∞‡≥ç‡≤µ‡≤æ‡≤π‡≤ï' },
            
            // Form fields
            'fullName': { en: 'Full Name *', hi: '‡§™‡•Ç‡§∞‡§æ ‡§®‡§æ‡§Æ *', bn: '‡¶∏‡¶Æ‡ßç‡¶™‡ßÇ‡¶∞‡ßç‡¶£ ‡¶®‡¶æ‡¶Æ *', gu: '‡™™‡´Ç‡™∞‡´Å‡™Ç ‡™®‡™æ‡™Æ *', mr: '‡§∏‡§Ç‡§™‡•Ç‡§∞‡•ç‡§£ ‡§®‡§æ‡§µ *', kn: '‡≤™‡≥Ç‡≤∞‡≥ç‡≤£ ‡≤π‡≥Ü‡≤∏‡≤∞‡≥Å *' },
            'mobile': { en: 'Mobile Number *', hi: '‡§Æ‡•ã‡§¨‡§æ‡§á‡§≤ ‡§®‡§Ç‡§¨‡§∞ *', bn: '‡¶Æ‡ßã‡¶¨‡¶æ‡¶á‡¶≤ ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞ *', gu: '‡™Æ‡´ã‡™¨‡™æ‡™á‡™≤ ‡™®‡™Ç‡™¨‡™∞ *', mr: '‡§Æ‡•ã‡§¨‡§æ‡§à‡§≤ ‡§®‡§Ç‡§¨‡§∞ *', kn: '‡≤Æ‡≥ä‡≤¨‡≥à‡≤≤‡≥ç ‡≤∏‡≤Ç‡≤ñ‡≥ç‡≤Ø‡≥Ü *' },
            'category': { en: 'Category (Optional)', hi: '‡§∂‡•ç‡§∞‡•á‡§£‡•Ä (‡§µ‡•à‡§ï‡§≤‡•ç‡§™‡§ø‡§ï)', bn: '‡¶¨‡¶ø‡¶≠‡¶æ‡¶ó (‡¶ê‡¶ö‡ßç‡¶õ‡¶ø‡¶ï)', gu: '‡™ï‡´á‡™ü‡´á‡™ó‡™∞‡´Ä (‡™µ‡´à‡™ï‡™≤‡´ç‡™™‡™ø‡™ï)', mr: '‡§∂‡•ç‡§∞‡•á‡§£‡•Ä (‡§™‡§∞‡•ç‡§Ø‡§æ‡§Ø‡•Ä)', kn: '‡≤µ‡≤∞‡≥ç‡≤ó (‡≤ê‡≤ö‡≥ç‡≤õ‡≤ø‡≤ï)' },
            'subcategory': { en: 'Subcategory (Optional)', hi: '‡§â‡§™‡§∂‡•ç‡§∞‡•á‡§£‡•Ä (‡§µ‡•à‡§ï‡§≤‡•ç‡§™‡§ø‡§ï)', bn: '‡¶â‡¶™‡¶¨‡¶ø‡¶≠‡¶æ‡¶ó (‡¶ê‡¶ö‡ßç‡¶õ‡¶ø‡¶ï)', gu: '‡™â‡™™‡™ï‡´á‡™ü‡´á‡™ó‡™∞‡´Ä (‡™µ‡´à‡™ï‡™≤‡´ç‡™™‡™ø‡™ï)', mr: '‡§â‡§™‡§∂‡•ç‡§∞‡•á‡§£‡•Ä (‡§™‡§∞‡•ç‡§Ø‡§æ‡§Ø‡•Ä)', kn: '‡≤â‡≤™‡≤µ‡≤∞‡≥ç‡≤ó (‡≤ê‡≤ö‡≥ç‡≤õ‡≤ø‡≤ï)' },
            'serviceType': { en: 'Service Type (Optional)', hi: '‡§∏‡•á‡§µ‡§æ ‡§™‡•ç‡§∞‡§ï‡§æ‡§∞ (‡§µ‡•à‡§ï‡§≤‡•ç‡§™‡§ø‡§ï)', bn: '‡¶∏‡ßá‡¶¨‡¶æ ‡¶™‡ßç‡¶∞‡¶ï‡¶æ‡¶∞ (‡¶ê‡¶ö‡ßç‡¶õ‡¶ø‡¶ï)', gu: '‡™∏‡´á‡™µ‡™æ ‡™™‡´ç‡™∞‡™ï‡™æ‡™∞ (‡™µ‡´à‡™ï‡™≤‡´ç‡™™‡™ø‡™ï)', mr: '‡§∏‡•á‡§µ‡§æ ‡§™‡•ç‡§∞‡§ï‡§æ‡§∞ (‡§™‡§∞‡•ç‡§Ø‡§æ‡§Ø‡•Ä)', kn: '‡≤∏‡≥á‡≤µ‡≥Ü ‡≤™‡≥ç‡≤∞‡≤ï‡≤æ‡≤∞ (‡≤ê‡≤ö‡≥ç‡≤õ‡≤ø‡≤ï)' },
            'religion': { en: 'Religion *', hi: '‡§ß‡§∞‡•ç‡§Æ *', bn: '‡¶ß‡¶∞‡ßç‡¶Æ *', gu: '‡™ß‡™∞‡´ç‡™Æ *', mr: '‡§ß‡§∞‡•ç‡§Æ *', kn: '‡≤ß‡≤∞‡≥ç‡≤Æ *' },
            'selectReligion': { en: 'Select Religion', hi: '‡§ß‡§∞‡•ç‡§Æ ‡§ö‡•Å‡§®‡•á‡§Ç', bn: '‡¶ß‡¶∞‡ßç‡¶Æ ‡¶®‡¶ø‡¶∞‡ßç‡¶¨‡¶æ‡¶ö‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®', gu: '‡™ß‡™∞‡´ç‡™Æ ‡™™‡™∏‡™Ç‡™¶ ‡™ï‡™∞‡´ã', mr: '‡§ß‡§∞‡•ç‡§Æ ‡§®‡§ø‡§µ‡§°‡§æ', kn: '‡≤ß‡≤∞‡≥ç‡≤Æ ‡≤Ü‡≤Ø‡≥ç‡≤ï‡≥Ü‡≤Æ‡≤æ‡≤°‡≤ø' },
            'experience': { en: 'Experience (years) *', hi: '‡§Ö‡§®‡•Å‡§≠‡§µ (‡§µ‡§∞‡•ç‡§∑) *', bn: '‡¶Ö‡¶≠‡¶ø‡¶ú‡ßç‡¶û‡¶§‡¶æ (‡¶¨‡¶õ‡¶∞) *', gu: '‡™Ö‡™®‡´Å‡™≠‡™µ (‡™µ‡™∞‡´ç‡™∑) *', mr: '‡§Ö‡§®‡•Å‡§≠‡§µ (‡§µ‡§∞‡•ç‡§∑‡•á) *', kn: '‡≤Ö‡≤®‡≥Å‡≤≠‡≤µ (‡≤µ‡≤∞‡≥ç‡≤∑‡≤ó‡≤≥‡≥Å) *' },
            'rate': { en: 'Rate (‚Çπ/hour) *', hi: '‡§¶‡§∞ (‚Çπ/‡§ò‡§Ç‡§ü‡§æ) *', bn: '‡¶π‡¶æ‡¶∞ (‚Çπ/‡¶ò‡¶®‡ßç‡¶ü‡¶æ) *', gu: '‡™¶‡™∞ (‚Çπ/‡™ï‡™≤‡™æ‡™ï) *', mr: '‡§¶‡§∞ (‚Çπ/‡§§‡§æ‡§∏) *', kn: '‡≤¶‡≤∞ (‚Çπ/‡≤ó‡≤Ç‡≤ü‡≥Ü) *' },
            'location': { en: 'Location/Address *', hi: '‡§∏‡•ç‡§•‡§æ‡§®/‡§™‡§§‡§æ *', bn: '‡¶Ö‡¶¨‡¶∏‡ßç‡¶•‡¶æ‡¶®/‡¶†‡¶ø‡¶ï‡¶æ‡¶®‡¶æ *', gu: '‡™∏‡´ç‡™•‡™æ‡™®/‡™∏‡™∞‡™®‡™æ‡™Æ‡´Å‡™Ç *', mr: '‡§∏‡•ç‡§•‡§æ‡§®/‡§™‡§§‡•ç‡§§‡§æ *', kn: '‡≤∏‡≥ç‡≤•‡≤≥/‡≤µ‡≤ø‡≤≥‡≤æ‡≤∏ *' },
            'setLocation': { en: 'Set Your Location on Map', hi: '‡§Æ‡§æ‡§®‡§ö‡§ø‡§§‡•ç‡§∞ ‡§™‡§∞ ‡§Ö‡§™‡§®‡§æ ‡§∏‡•ç‡§•‡§æ‡§® ‡§∏‡•á‡§ü ‡§ï‡§∞‡•á‡§Ç', bn: '‡¶Æ‡¶æ‡¶®‡¶ö‡¶ø‡¶§‡ßç‡¶∞‡ßá ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶Ö‡¶¨‡¶∏‡ßç‡¶•‡¶æ‡¶® ‡¶∏‡ßá‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®', gu: '‡™®‡™ï‡™∂‡™æ ‡™™‡™∞ ‡™§‡™Æ‡™æ‡™∞‡´Å‡™Ç ‡™∏‡´ç‡™•‡™æ‡™® ‡™∏‡´á‡™ü ‡™ï‡™∞‡´ã', mr: '‡§®‡§ï‡§æ‡§∂‡§æ‡§µ‡§∞ ‡§§‡•Å‡§Æ‡§ö‡•á ‡§∏‡•ç‡§•‡§æ‡§® ‡§∏‡•á‡§ü ‡§ï‡§∞‡§æ', kn: '‡≤®‡≤ï‡≥ç‡≤∑‡≥Ü‡≤Ø‡≤≤‡≥ç‡≤≤‡≤ø ‡≤®‡≤ø‡≤Æ‡≥ç‡≤Æ ‡≤∏‡≥ç‡≤•‡≤≥‡≤µ‡≤®‡≥ç‡≤®‡≥Å ‡≤π‡≥ä‡≤Ç‡≤¶‡≤ø‡≤∏‡≤ø' },
            'useMyLocation': { en: 'Use My Location', hi: '‡§Æ‡•á‡§∞‡§æ ‡§∏‡•ç‡§•‡§æ‡§® ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡•á‡§Ç', bn: '‡¶Ü‡¶Æ‡¶æ‡¶∞ ‡¶Ö‡¶¨‡¶∏‡ßç‡¶•‡¶æ‡¶® ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡ßÅ‡¶®', gu: '‡™Æ‡™æ‡™∞‡´Å‡™Ç ‡™∏‡´ç‡™•‡™æ‡™® ‡™µ‡™æ‡™™‡™∞‡´ã', mr: '‡§Æ‡§æ‡§ù‡•á ‡§∏‡•ç‡§•‡§æ‡§® ‡§µ‡§æ‡§™‡§∞‡§æ', kn: '‡≤®‡≤®‡≥ç‡≤® ‡≤∏‡≥ç‡≤•‡≤≥ ‡≤¨‡≤≥‡≤∏‡≤ø' },
            'registerNow': { en: 'Register Now', hi: '‡§Ö‡§≠‡•Ä ‡§™‡§Ç‡§ú‡•Ä‡§ï‡§∞‡§£ ‡§ï‡§∞‡•á‡§Ç', bn: '‡¶è‡¶ñ‡¶®‡¶á ‡¶®‡¶ø‡¶¨‡¶®‡ßç‡¶ß‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®', gu: '‡™π‡™Æ‡™£‡™æ‡™Ç ‡™®‡´ã‡™Ç‡™ß‡™£‡´Ä ‡™ï‡™∞‡´ã', mr: '‡§Ü‡§§‡§æ ‡§®‡•ã‡§Ç‡§¶‡§£‡•Ä ‡§ï‡§∞‡§æ', kn: '‡≤à‡≤ó ‡≤®‡≥ã‡≤Ç‡≤¶‡≤£‡≤ø ‡≤Æ‡≤æ‡≤°‡≤ø' },
            
            // Headings
            'findProviders': { en: 'Find Verified Service Providers Near You', hi: '‡§Ö‡§™‡§®‡•á ‡§™‡§æ‡§∏ ‡§∏‡§§‡•ç‡§Ø‡§æ‡§™‡§ø‡§§ ‡§∏‡•á‡§µ‡§æ ‡§™‡•ç‡§∞‡§¶‡§æ‡§§‡§æ ‡§ñ‡•ã‡§ú‡•á‡§Ç', bn: '‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶ï‡¶æ‡¶õ‡ßá ‡¶Ø‡¶æ‡¶ö‡¶æ‡¶á‡¶ï‡ßÉ‡¶§ ‡¶∏‡ßá‡¶¨‡¶æ ‡¶™‡ßç‡¶∞‡¶¶‡¶æ‡¶®‡¶ï‡¶æ‡¶∞‡ßÄ ‡¶ñ‡ßÅ‡¶Å‡¶ú‡ßÅ‡¶®', gu: '‡™§‡™Æ‡™æ‡™∞‡´Ä ‡™®‡™ú‡´Ä‡™ï ‡™ö‡™ï‡™æ‡™∏‡™æ‡™Ø‡´á‡™≤ ‡™∏‡´á‡™µ‡™æ ‡™™‡´ç‡™∞‡™¶‡™æ‡™§‡™æ‡™ì ‡™∂‡´ã‡™ß‡´ã', mr: '‡§§‡•Å‡§Æ‡§ö‡•ç‡§Ø‡§æ ‡§ú‡§µ‡§≥ ‡§∏‡§§‡•ç‡§Ø‡§æ‡§™‡§ø‡§§ ‡§∏‡•á‡§µ‡§æ ‡§™‡•ç‡§∞‡§¶‡§æ‡§§‡•á ‡§∂‡•ã‡§ß‡§æ', kn: '‡≤®‡≤ø‡≤Æ‡≥ç‡≤Æ ‡≤∏‡≤Æ‡≥Ä‡≤™‡≤¶‡≤≤‡≥ç‡≤≤‡≤ø ‡≤™‡≤∞‡≤ø‡≤∂‡≥Ä‡≤≤‡≤ø‡≤§ ‡≤∏‡≥á‡≤µ‡≤æ ‡≤™‡≥Ç‡≤∞‡≥à‡≤ï‡≥Ü‡≤¶‡≤æ‡≤∞‡≤∞‡≤®‡≥ç‡≤®‡≥Å ‡≤π‡≥Å‡≤°‡≥Å‡≤ï‡≤ø' },
            'serviceCategories': { en: 'Service Categories', hi: '‡§∏‡•á‡§µ‡§æ ‡§∂‡•ç‡§∞‡•á‡§£‡§ø‡§Ø‡§æ‡§Å', bn: '‡¶∏‡ßá‡¶¨‡¶æ ‡¶¨‡¶ø‡¶≠‡¶æ‡¶ó', gu: '‡™∏‡´á‡™µ‡™æ ‡™∂‡´ç‡™∞‡´á‡™£‡´Ä‡™ì', mr: '‡§∏‡•á‡§µ‡§æ ‡§∂‡•ç‡§∞‡•á‡§£‡•ç‡§Ø‡§æ', kn: '‡≤∏‡≥á‡≤µ‡≤æ ‡≤µ‡≤∞‡≥ç‡≤ó‡≤ó‡≤≥‡≥Å' },
            'browseServices': { en: 'Browse Services', hi: '‡§∏‡•á‡§µ‡§æ‡§è‡§Ç ‡§¨‡•ç‡§∞‡§æ‡§â‡§ú‡§º ‡§ï‡§∞‡•á‡§Ç', bn: '‡¶∏‡ßá‡¶¨‡¶æ ‡¶¨‡ßç‡¶∞‡¶æ‡¶â‡¶ú ‡¶ï‡¶∞‡ßÅ‡¶®', gu: '‡™∏‡´á‡™µ‡™æ‡™ì ‡™¨‡´ç‡™∞‡™æ‡™â‡™ù ‡™ï‡™∞‡´ã', mr: '‡§∏‡•á‡§µ‡§æ ‡§¨‡•ç‡§∞‡§æ‡§â‡§ù ‡§ï‡§∞‡§æ', kn: '‡≤∏‡≥á‡≤µ‡≥Ü‡≤ó‡≤≥‡≤®‡≥ç‡≤®‡≥Å ‡≤¨‡≥ç‡≤∞‡≥å‡≤∏‡≥ç ‡≤Æ‡≤æ‡≤°‡≤ø' },
            'becomeProvider': { en: 'Become a Provider', hi: '‡§™‡•ç‡§∞‡§¶‡§æ‡§§‡§æ ‡§¨‡§®‡•á‡§Ç', bn: '‡¶™‡ßç‡¶∞‡¶¶‡¶æ‡¶®‡¶ï‡¶æ‡¶∞‡ßÄ ‡¶π‡¶®', gu: '‡™™‡´ç‡™∞‡™¶‡™æ‡™§‡™æ ‡™¨‡™®‡´ã', mr: '‡§™‡•ç‡§∞‡§¶‡§æ‡§§‡§æ ‡§µ‡•ç‡§π‡§æ', kn: '‡≤™‡≥Ç‡≤∞‡≥à‡≤ï‡≥Ü‡≤¶‡≤æ‡≤∞‡≤∞‡≤æ‡≤ó‡≤ø' },
            
            // Buttons
            'call': { en: 'üìû Call', hi: 'üìû ‡§ï‡•â‡§≤ ‡§ï‡§∞‡•á‡§Ç', bn: 'üìû ‡¶ï‡¶≤ ‡¶ï‡¶∞‡ßÅ‡¶®', gu: 'üìû ‡™ï‡´â‡™≤ ‡™ï‡™∞‡´ã', mr: 'üìû ‡§ï‡•â‡§≤ ‡§ï‡§∞‡§æ', kn: 'üìû ‡≤ï‡≤∞‡≥Ü ‡≤Æ‡≤æ‡≤°‡≤ø' },
            'directions': { en: 'üó∫Ô∏è Directions', hi: 'üó∫Ô∏è ‡§¶‡§ø‡§∂‡§æ-‡§®‡§ø‡§∞‡•ç‡§¶‡•á‡§∂', bn: 'üó∫Ô∏è ‡¶¶‡¶ø‡¶ï‡¶®‡¶ø‡¶∞‡ßç‡¶¶‡ßá‡¶∂', gu: 'üó∫Ô∏è ‡™¶‡™ø‡™∂‡™æ‡™ì', mr: 'üó∫Ô∏è ‡§¶‡§ø‡§∂‡§æ‡§®‡§ø‡§∞‡•ç‡§¶‡•á‡§∂', kn: 'üó∫Ô∏è ‡≤®‡≤ø‡≤∞‡≥ç‡≤¶‡≥á‡≤∂‡≤®‡≤ó‡≤≥‡≥Å' },
            'backToHome': { en: '‚Üê Back to Home', hi: '‚Üê ‡§π‡•ã‡§Æ ‡§™‡§∞ ‡§µ‡§æ‡§™‡§∏ ‡§ú‡§æ‡§è‡§Ç', bn: '‚Üê ‡¶π‡ßã‡¶Æ‡ßá ‡¶´‡¶ø‡¶∞‡ßá ‡¶Ø‡¶æ‡¶®', gu: '‚Üê ‡™π‡´ã‡™Æ ‡™™‡™∞ ‡™™‡™æ‡™õ‡™æ ‡™ú‡™æ‡™ì', mr: '‚Üê ‡§π‡•ã‡§Æ‡§µ‡§∞ ‡§™‡§∞‡§§ ‡§ú‡§æ', kn: '‚Üê ‡≤Æ‡≤®‡≥Ü‡≤ó‡≥Ü ‡≤π‡≤ø‡≤Ç‡≤§‡≤ø‡≤∞‡≥Å‡≤ó‡≤ø' },
            
            // Phase B: Sorting & Filtering
            'sortBy': { en: 'Sort By', hi: '‡§ï‡•ç‡§∞‡§Æ‡§¨‡§¶‡•ç‡§ß ‡§ï‡§∞‡•á‡§Ç', bn: '‡¶∏‡¶æ‡¶ú‡¶æ‡¶®', gu: '‡™ï‡´ç‡™∞‡™Æ‡™¨‡™¶‡´ç‡™ß ‡™ï‡™∞‡´ã', mr: '‡§ï‡•ç‡§∞‡§Æ‡§µ‡§æ‡§∞‡•Ä ‡§≤‡§æ‡§µ‡§æ', kn: '‡≤µ‡≤ø‡≤Ç‡≤ó‡≤°‡≤ø‡≤∏‡≤ø' },
            'filters': { en: 'üîç Filters', hi: 'üîç ‡§´‡§º‡§ø‡§≤‡•ç‡§ü‡§∞', bn: 'üîç ‡¶´‡¶ø‡¶≤‡ßç‡¶ü‡¶æ‡¶∞', gu: 'üîç ‡™´‡™ø‡™≤‡´ç‡™ü‡™∞', mr: 'üîç ‡§´‡§ø‡§≤‡•ç‡§ü‡§∞', kn: 'üîç ‡≤´‡≤ø‡≤≤‡≥ç‡≤ü‡≤∞‡≥ç‚Äå‡≤ó‡≤≥‡≥Å' },
            'rating': { en: 'Rating (High to Low)', hi: '‡§∞‡•á‡§ü‡§ø‡§Ç‡§ó (‡§â‡§ö‡•ç‡§ö ‡§∏‡•á ‡§®‡§ø‡§Æ‡•ç‡§®)', bn: '‡¶∞‡ßá‡¶ü‡¶ø‡¶Ç (‡¶â‡¶ö‡ßç‡¶ö ‡¶•‡ßá‡¶ï‡ßá ‡¶®‡¶ø‡¶Æ‡ßç‡¶®)', gu: '‡™∞‡´á‡™ü‡™ø‡™Ç‡™ó (‡™â‡™ö‡´ç‡™ö‡™•‡´Ä ‡™®‡´Ä‡™ö‡´Å‡™Ç)', mr: '‡§∞‡•á‡§ü‡§ø‡§Ç‡§ó (‡§â‡§ö‡•ç‡§ö ‡§§‡•á ‡§ï‡§Æ‡•Ä)', kn: '‡≤∞‡≥á‡≤ü‡≤ø‡≤Ç‡≤ó‡≥ç (‡≤π‡≥Ü‡≤ö‡≥ç‡≤ö‡≥Å ‡≤∞‡≤ø‡≤Ç‡≤¶ ‡≤ï‡≤°‡≤ø‡≤Æ‡≥Ü)' },
            'priceLowToHigh': { en: 'Price (Low to High)', hi: '‡§Æ‡•Ç‡§≤‡•ç‡§Ø (‡§ï‡§Æ ‡§∏‡•á ‡§Ö‡§ß‡§ø‡§ï)', bn: '‡¶Æ‡ßÇ‡¶≤‡ßç‡¶Ø (‡¶ï‡¶Æ ‡¶•‡ßá‡¶ï‡ßá ‡¶¨‡ßá‡¶∂‡¶ø)', gu: '‡™ï‡™ø‡™Ç‡™Æ‡™§ (‡™ì‡™õ‡´Ä‡™•‡´Ä ‡™µ‡™ß‡™æ‡™∞‡´á)', mr: '‡§ï‡§ø‡§Ç‡§Æ‡§§ (‡§ï‡§Æ‡•Ä ‡§§‡•á ‡§ú‡§æ‡§∏‡•ç‡§§)', kn: '‡≤¨‡≥Ü‡≤≤‡≥Ü (‡≤ï‡≤°‡≤ø‡≤Æ‡≥Ü ‡≤∞‡≤ø‡≤Ç‡≤¶ ‡≤π‡≥Ü‡≤ö‡≥ç‡≤ö‡≥Å)' },
            'distanceNearToFar': { en: 'Distance (Near to Far)', hi: '‡§¶‡•Ç‡§∞‡•Ä (‡§™‡§æ‡§∏ ‡§∏‡•á ‡§¶‡•Ç‡§∞)', bn: '‡¶¶‡ßÇ‡¶∞‡¶§‡ßç‡¶¨ (‡¶ï‡¶æ‡¶õ ‡¶•‡ßá‡¶ï‡ßá ‡¶¶‡ßÇ‡¶∞)', gu: '‡™Ö‡™Ç‡™§‡™∞ (‡™®‡™ú‡´Ä‡™ï‡™•‡´Ä ‡™¶‡´Ç‡™∞)', mr: '‡§Ö‡§Ç‡§§‡§∞ (‡§ú‡§µ‡§≥‡•Ç‡§® ‡§¶‡•Ç‡§∞)', kn: '‡≤Ö‡≤Ç‡≤§‡≤∞ (‡≤∏‡≤Æ‡≥Ä‡≤™‡≤¶‡≤ø‡≤Ç‡≤¶ ‡≤¶‡≥Ç‡≤∞)' },
            'experienceHighToLow': { en: 'Experience (High to Low)', hi: '‡§Ö‡§®‡•Å‡§≠‡§µ (‡§Ö‡§ß‡§ø‡§ï ‡§∏‡•á ‡§ï‡§Æ)', bn: '‡¶Ö‡¶≠‡¶ø‡¶ú‡ßç‡¶û‡¶§‡¶æ (‡¶¨‡ßá‡¶∂‡¶ø ‡¶•‡ßá‡¶ï‡ßá ‡¶ï‡¶Æ)', gu: '‡™Ö‡™®‡´Å‡™≠‡™µ (‡™µ‡™ß‡´Å‡™•‡´Ä ‡™ì‡™õ‡´Å‡™Ç)', mr: '‡§Ö‡§®‡•Å‡§≠‡§µ (‡§ú‡§æ‡§∏‡•ç‡§§ ‡§§‡•á ‡§ï‡§Æ‡•Ä)', kn: '‡≤Ö‡≤®‡≥Å‡≤≠‡≤µ (‡≤π‡≥Ü‡≤ö‡≥ç‡≤ö‡≥Å ‡≤∞‡≤ø‡≤Ç‡≤¶ ‡≤ï‡≤°‡≤ø‡≤Æ‡≥Ü)' },
            'applyFilters': { en: 'Apply Filters', hi: '‡§´‡§º‡§ø‡§≤‡•ç‡§ü‡§∞ ‡§≤‡§æ‡§ó‡•Ç ‡§ï‡§∞‡•á‡§Ç', bn: '‡¶´‡¶ø‡¶≤‡ßç‡¶ü‡¶æ‡¶∞ ‡¶™‡ßç‡¶∞‡¶Ø‡¶º‡ßã‡¶ó ‡¶ï‡¶∞‡ßÅ‡¶®', gu: '‡™´‡™ø‡™≤‡´ç‡™ü‡™∞ ‡™≤‡™æ‡™ó‡´Å ‡™ï‡™∞‡´ã', mr: '‡§´‡§ø‡§≤‡•ç‡§ü‡§∞ ‡§≤‡§æ‡§ó‡•Ç ‡§ï‡§∞‡§æ', kn: '‡≤´‡≤ø‡≤≤‡≥ç‡≤ü‡≤∞‡≥ç‚Äå‡≤ó‡≤≥‡≤®‡≥ç‡≤®‡≥Å ‡≤Ö‡≤®‡≥ç‡≤µ‡≤Ø‡≤ø‡≤∏‡≤ø' },
            'clearFilters': { en: 'Clear All', hi: '‡§∏‡§≠‡•Ä ‡§∏‡§æ‡§´‡§º ‡§ï‡§∞‡•á‡§Ç', bn: '‡¶∏‡¶¨ ‡¶∏‡¶æ‡¶´ ‡¶ï‡¶∞‡ßÅ‡¶®', gu: '‡™¨‡™ß‡´Å‡™Ç ‡™∏‡™æ‡™´ ‡™ï‡™∞‡´ã', mr: '‡§∏‡§∞‡•ç‡§µ ‡§∏‡§æ‡§´ ‡§ï‡§∞‡§æ', kn: '‡≤é‡≤≤‡≥ç‡≤≤‡≤µ‡≤®‡≥ç‡≤®‡≥Ç ‡≤§‡≥Ü‡≤∞‡≤µ‡≥Å‡≤ó‡≥ä‡≤≥‡≤ø‡≤∏‡≤ø' },
            'languageFilter': { en: 'Language', hi: '‡§≠‡§æ‡§∑‡§æ', bn: '‡¶≠‡¶æ‡¶∑‡¶æ', gu: '‡™≠‡™æ‡™∑‡™æ', mr: '‡§≠‡§æ‡§∑‡§æ', kn: '‡≤≠‡≤æ‡≤∑‡≥Ü' },
            'religionFilter': { en: 'Religion', hi: '‡§ß‡§∞‡•ç‡§Æ', bn: '‡¶ß‡¶∞‡ßç‡¶Æ', gu: '‡™ß‡™∞‡´ç‡™Æ', mr: '‡§ß‡§∞‡•ç‡§Æ', kn: '‡≤ß‡≤∞‡≥ç‡≤Æ' },
            'priceRange': { en: 'Price Range (‚Çπ/hr)', hi: '‡§Æ‡•Ç‡§≤‡•ç‡§Ø ‡§∏‡•Ä‡§Æ‡§æ (‚Çπ/‡§ò‡§Ç‡§ü‡§æ)', bn: '‡¶Æ‡ßÇ‡¶≤‡ßç‡¶Ø ‡¶∏‡ßÄ‡¶Æ‡¶æ (‚Çπ/‡¶ò‡¶®‡ßç‡¶ü‡¶æ)', gu: '‡™ï‡™ø‡™Ç‡™Æ‡™§ ‡™∂‡´ç‡™∞‡´á‡™£‡´Ä (‚Çπ/‡™ï‡™≤‡™æ‡™ï)', mr: '‡§ï‡§ø‡§Ç‡§Æ‡§§ ‡§∂‡•ç‡§∞‡•á‡§£‡•Ä (‚Çπ/‡§§‡§æ‡§∏)', kn: '‡≤¨‡≥Ü‡≤≤‡≥Ü ‡≤µ‡≥ç‡≤Ø‡≤æ‡≤™‡≥ç‡≤§‡≤ø (‚Çπ/‡≤ó‡≤Ç‡≤ü‡≥Ü)' },
            'maxDistanceFilter': { en: 'Maximum Distance', hi: '‡§Ö‡§ß‡§ø‡§ï‡§§‡§Æ ‡§¶‡•Ç‡§∞‡•Ä', bn: '‡¶∏‡¶∞‡ßç‡¶¨‡ßã‡¶ö‡ßç‡¶ö ‡¶¶‡ßÇ‡¶∞‡¶§‡ßç‡¶¨', gu: '‡™Æ‡™π‡™§‡´ç‡™§‡™Æ ‡™Ö‡™Ç‡™§‡™∞', mr: '‡§ï‡§Æ‡§æ‡§≤ ‡§Ö‡§Ç‡§§‡§∞', kn: '‡≤ó‡≤∞‡≤ø‡≤∑‡≥ç‡≤† ‡≤Ö‡≤Ç‡≤§‡≤∞' },
            'anyLanguage': { en: 'Any Language', hi: '‡§ï‡•ã‡§à ‡§≠‡•Ä ‡§≠‡§æ‡§∑‡§æ', bn: '‡¶Ø‡ßá‡¶ï‡ßã‡¶®‡ßã ‡¶≠‡¶æ‡¶∑‡¶æ', gu: '‡™ï‡´ã‡™à‡™™‡™£ ‡™≠‡™æ‡™∑‡™æ', mr: '‡§ï‡•ã‡§£‡§§‡•Ä‡§π‡•Ä ‡§≠‡§æ‡§∑‡§æ', kn: '‡≤Ø‡≤æ‡≤µ‡≥Å‡≤¶‡≥á ‡≤≠‡≤æ‡≤∑‡≥Ü' },
            'anyReligion': { en: 'Any Religion', hi: '‡§ï‡•ã‡§à ‡§≠‡•Ä ‡§ß‡§∞‡•ç‡§Æ', bn: '‡¶Ø‡ßá‡¶ï‡ßã‡¶®‡ßã ‡¶ß‡¶∞‡ßç‡¶Æ', gu: '‡™ï‡´ã‡™à‡™™‡™£ ‡™ß‡™∞‡´ç‡™Æ', mr: '‡§ï‡•ã‡§£‡§§‡§æ‡§π‡•Ä ‡§ß‡§∞‡•ç‡§Æ', kn: '‡≤Ø‡≤æ‡≤µ‡≥Å‡≤¶‡≥á ‡≤ß‡≤∞‡≥ç‡≤Æ' },
            'providerLanguage': { en: 'Provider Language *', hi: '‡§™‡•ç‡§∞‡§¶‡§æ‡§§‡§æ ‡§≠‡§æ‡§∑‡§æ *', bn: '‡¶™‡ßç‡¶∞‡¶¶‡¶æ‡¶®‡¶ï‡¶æ‡¶∞‡ßÄ ‡¶≠‡¶æ‡¶∑‡¶æ *', gu: '‡™™‡´ç‡™∞‡™¶‡™æ‡™§‡™æ ‡™≠‡™æ‡™∑‡™æ *', mr: '‡§™‡•ç‡§∞‡§¶‡§æ‡§§‡§æ ‡§≠‡§æ‡§∑‡§æ *', kn: '‡≤™‡≥Ç‡≤∞‡≥à‡≤ï‡≥Ü‡≤¶‡≤æ‡≤∞ ‡≤≠‡≤æ‡≤∑‡≥Ü *' },
            'workingHours': { en: 'Working Hours *', hi: '‡§ï‡§æ‡§∞‡•ç‡§Ø ‡§∏‡§Æ‡§Ø *', bn: '‡¶ï‡¶æ‡¶ú‡ßá‡¶∞ ‡¶∏‡¶Æ‡¶Ø‡¶º *', gu: '‡™ï‡™æ‡™Æ‡™®‡™æ ‡™ï‡™≤‡™æ‡™ï‡´ã *', mr: '‡§ï‡§æ‡§Æ‡§æ‡§ö‡•á ‡§§‡§æ‡§∏ *', kn: '‡≤ï‡≥Ü‡≤≤‡≤∏‡≤¶ ‡≤ó‡≤Ç‡≤ü‡≥Ü‡≤ó‡≤≥‡≥Å *' },
            'serviceArea': { en: 'Service Area *', hi: '‡§∏‡•á‡§µ‡§æ ‡§ï‡•ç‡§∑‡•á‡§§‡•ç‡§∞ *', bn: '‡¶∏‡ßá‡¶¨‡¶æ ‡¶è‡¶≤‡¶æ‡¶ï‡¶æ *', gu: '‡™∏‡´á‡™µ‡™æ ‡™µ‡™ø‡™∏‡´ç‡™§‡™æ‡™∞ *', mr: '‡§∏‡•á‡§µ‡§æ ‡§ï‡•ç‡§∑‡•á‡§§‡•ç‡§∞ *', kn: '‡≤∏‡≥á‡≤µ‡≤æ ‡≤™‡≥ç‡≤∞‡≤¶‡≥á‡≤∂ *' },
            'monFri': { en: 'Mon-Fri (9 AM - 6 PM)', hi: '‡§∏‡•ã‡§Æ-‡§∂‡•Å‡§ï‡•ç‡§∞ (9 AM - 6 PM)', bn: '‡¶∏‡ßã‡¶Æ-‡¶∂‡ßÅ‡¶ï‡ßç‡¶∞ (9 AM - 6 PM)', gu: '‡™∏‡´ã‡™Æ-‡™∂‡´Å‡™ï‡´ç‡™∞ (9 AM - 6 PM)', mr: '‡§∏‡•ã‡§Æ-‡§∂‡•Å‡§ï‡•ç‡§∞ (9 AM - 6 PM)', kn: '‡≤∏‡≥ã‡≤Æ-‡≤∂‡≥Å‡≤ï‡≥ç‡≤∞ (9 AM - 6 PM)' },
            'weekends': { en: 'Weekends Only', hi: '‡§ï‡•á‡§µ‡§≤ ‡§∏‡§™‡•ç‡§§‡§æ‡§π‡§æ‡§Ç‡§§', bn: '‡¶∂‡ßÅ‡¶ß‡ßÅ ‡¶∏‡¶™‡ßç‡¶§‡¶æ‡¶π‡¶æ‡¶®‡ßç‡¶§‡ßá', gu: '‡™Æ‡™æ‡™§‡´ç‡™∞ ‡™∏‡™™‡´ç‡™§‡™æ‡™π‡™æ‡™Ç‡™§', mr: '‡§´‡§ï‡•ç‡§§ ‡§Ü‡§†‡§µ‡§°‡•ç‡§Ø‡§æ‡§ö‡§æ ‡§∂‡•á‡§µ‡§ü', kn: '‡≤µ‡≤æ‡≤∞‡≤æ‡≤Ç‡≤§‡≥ç‡≤Ø‡≤ó‡≤≥‡≥Å ‡≤Æ‡≤æ‡≤§‡≥ç‡≤∞' },
            'allDays': { en: 'All Days (7 days/week)', hi: '‡§∏‡§≠‡•Ä ‡§¶‡§ø‡§® (7 ‡§¶‡§ø‡§®/‡§∏‡§™‡•ç‡§§‡§æ‡§π)', bn: '‡¶∏‡¶¨ ‡¶¶‡¶ø‡¶® (7 ‡¶¶‡¶ø‡¶®/‡¶∏‡¶™‡ßç‡¶§‡¶æ‡¶π)', gu: '‡™¨‡™ß‡™æ ‡™¶‡™ø‡™µ‡™∏‡´ã (7 ‡™¶‡™ø‡™µ‡™∏/‡™Ö‡™†‡™µ‡™æ‡™°‡™ø‡™Ø‡´Å‡™Ç)', mr: '‡§∏‡§∞‡•ç‡§µ ‡§¶‡§ø‡§µ‡§∏ (7 ‡§¶‡§ø‡§µ‡§∏/‡§Ü‡§†‡§µ‡§°‡§æ)', kn: '‡≤é‡≤≤‡≥ç‡≤≤‡≤æ ‡≤¶‡≤ø‡≤®‡≤ó‡≤≥‡≥Å (7 ‡≤¶‡≤ø‡≤®‡≤ó‡≤≥‡≥Å/‡≤µ‡≤æ‡≤∞)' },
            'available24x7': { en: '24√ó7 Available', hi: '24√ó7 ‡§â‡§™‡§≤‡§¨‡•ç‡§ß', bn: '24√ó7 ‡¶â‡¶™‡¶≤‡¶¨‡ßç‡¶ß', gu: '24√ó7 ‡™â‡™™‡™≤‡™¨‡´ç‡™ß', mr: '24√ó7 ‡§â‡§™‡§≤‡§¨‡•ç‡§ß', kn: '24√ó7 ‡≤≤‡≤≠‡≥ç‡≤Ø‡≤µ‡≤ø‡≤¶‡≥Ü' },
            'within10km': { en: 'Within 10 km', hi: '10 ‡§ï‡§ø‡§Æ‡•Ä ‡§ï‡•á ‡§≠‡•Ä‡§§‡§∞', bn: '10 ‡¶ï‡¶ø‡¶Æ‡¶ø‡¶∞ ‡¶Æ‡¶ß‡ßç‡¶Ø‡ßá', gu: '10 ‡™ï‡™ø‡™Æ‡´Ä‡™®‡´Ä ‡™Ö‡™Ç‡™¶‡™∞', mr: '10 ‡§ï‡§ø‡§Æ‡•Ä‡§ö‡•ç‡§Ø‡§æ ‡§Ü‡§§', kn: '10 ‡≤ï‡≤ø‡≤Æ‡≥Ä ‡≤í‡≤≥‡≤ó‡≥Ü' },
            'withinCity': { en: 'Within City', hi: '‡§∂‡§π‡§∞ ‡§ï‡•á ‡§≠‡•Ä‡§§‡§∞', bn: '‡¶∂‡¶π‡¶∞‡ßá‡¶∞ ‡¶Æ‡¶ß‡ßç‡¶Ø‡ßá', gu: '‡™∂‡™π‡´á‡™∞‡™®‡´Ä ‡™Ö‡™Ç‡™¶‡™∞', mr: '‡§∂‡§π‡§∞‡§æ‡§ö‡•ç‡§Ø‡§æ ‡§Ü‡§§', kn: '‡≤®‡≤ó‡≤∞‡≤¶‡≥ä‡≤≥‡≤ó‡≥Ü' },
            'showingResults': { en: 'Showing {count} providers', hi: '{count} ‡§™‡•ç‡§∞‡§¶‡§æ‡§§‡§æ ‡§¶‡§ø‡§ñ‡§æ ‡§∞‡§π‡•á ‡§π‡•à‡§Ç', bn: '{count} ‡¶™‡ßç‡¶∞‡¶¶‡¶æ‡¶®‡¶ï‡¶æ‡¶∞‡ßÄ ‡¶¶‡ßá‡¶ñ‡¶æ‡¶ö‡ßç‡¶õ‡ßá', gu: '{count} ‡™™‡´ç‡™∞‡™¶‡™æ‡™§‡™æ‡™ì ‡™¨‡™§‡™æ‡™µ‡´Ä ‡™∞‡™π‡´ç‡™Ø‡™æ ‡™õ‡´Ä‡™è', mr: '{count} ‡§™‡•ç‡§∞‡§¶‡§æ‡§§‡•á ‡§¶‡§æ‡§ñ‡§µ‡§§ ‡§Ü‡§π‡•á', kn: '{count} ‡≤™‡≥Ç‡≤∞‡≥à‡≤ï‡≥Ü‡≤¶‡≤æ‡≤∞‡≤∞‡≤®‡≥ç‡≤®‡≥Å ‡≤§‡≥ã‡≤∞‡≤ø‡≤∏‡≤≤‡≤æ‡≤ó‡≥Å‡≤§‡≥ç‡≤§‡≤ø‡≤¶‡≥Ü' },
            
            // Phase C: Voice Commands
            'voiceSearch': { en: 'üé§ Voice Search', hi: 'üé§ ‡§ß‡•ç‡§µ‡§®‡§ø ‡§ñ‡•ã‡§ú', bn: 'üé§ ‡¶≠‡¶Ø‡¶º‡ßá‡¶∏ ‡¶∏‡¶æ‡¶∞‡ßç‡¶ö', gu: 'üé§ ‡™µ‡´â‡™á‡™∏ ‡™∏‡™∞‡´ç‡™ö', mr: 'üé§ ‡§µ‡•ç‡§π‡•â‡§á‡§∏ ‡§∂‡•ã‡§ß', kn: 'üé§ ‡≤ß‡≥ç‡≤µ‡≤®‡≤ø ‡≤π‡≥Å‡≤°‡≥Å‡≤ï‡≤æ‡≤ü' },
            'listening': { en: 'Listening...', hi: '‡§∏‡•Å‡§® ‡§∞‡§π‡•á ‡§π‡•à‡§Ç...', bn: '‡¶∂‡ßÅ‡¶®‡¶õ‡¶ø...', gu: '‡™∏‡™æ‡™Ç‡™≠‡™≥‡´Ä ‡™∞‡™π‡´ç‡™Ø‡™æ ‡™õ‡´Ä‡™è...', mr: '‡§ê‡§ï‡§§ ‡§Ü‡§π‡•á...', kn: '‡≤Ü‡≤≤‡≤ø‡≤∏‡≥Å‡≤§‡≥ç‡≤§‡≤ø‡≤¶‡≥Ü...' },
            'speak': { en: 'Speak now', hi: '‡§Ö‡§≠‡•Ä ‡§¨‡•ã‡§≤‡•á‡§Ç', bn: '‡¶è‡¶ñ‡¶® ‡¶¨‡¶≤‡ßÅ‡¶®', gu: '‡™π‡™Æ‡™£‡™æ‡™Ç ‡™¨‡´ã‡™≤‡´ã', mr: '‡§Ü‡§§‡§æ ‡§¨‡•ã‡§≤‡§æ', kn: '‡≤à‡≤ó ‡≤Æ‡≤æ‡≤§‡≤®‡≤æ‡≤°‡≤ø' },
            'voiceSearchFor': { en: 'Say: "Find a plumber" or "Show electricians"', hi: '‡§ï‡§π‡•á‡§Ç: "‡§™‡•ç‡§≤‡§Ç‡§¨‡§∞ ‡§ñ‡•ã‡§ú‡•á‡§Ç" ‡§Ø‡§æ "‡§á‡§≤‡•á‡§ï‡•ç‡§ü‡•ç‡§∞‡•Ä‡§∂‡§ø‡§Ø‡§® ‡§¶‡§ø‡§ñ‡§æ‡§è‡§Ç"', bn: '‡¶¨‡¶≤‡ßÅ‡¶®: "‡¶™‡ßç‡¶≤‡¶æ‡¶Æ‡ßç‡¶¨‡¶æ‡¶∞ ‡¶ñ‡ßÅ‡¶Å‡¶ú‡ßÅ‡¶®" ‡¶¨‡¶æ "‡¶á‡¶≤‡ßá‡¶ï‡¶ü‡ßç‡¶∞‡¶ø‡¶∂‡¶ø‡¶Ø‡¶º‡¶æ‡¶® ‡¶¶‡ßá‡¶ñ‡¶æ‡¶®"', gu: '‡™ï‡™π‡´ã: "‡™™‡´ç‡™≤‡™Æ‡´ç‡™¨‡™∞ ‡™∂‡´ã‡™ß‡´ã" ‡™Ö‡™•‡™µ‡™æ "‡™á‡™≤‡´á‡™ï‡´ç‡™ü‡´ç‡™∞‡™ø‡™∂‡™ø‡™Ø‡™® ‡™¨‡™§‡™æ‡™µ‡´ã"', mr: '‡§Æ‡•ç‡§π‡§£‡§æ: "‡§™‡•ç‡§≤‡§Ç‡§¨‡§∞ ‡§∂‡•ã‡§ß‡§æ" ‡§ï‡§ø‡§Ç‡§µ‡§æ "‡§á‡§≤‡•á‡§ï‡•ç‡§ü‡•ç‡§∞‡§ø‡§∂‡§ø‡§Ø‡§® ‡§¶‡§æ‡§ñ‡§µ‡§æ"', kn: '‡≤π‡≥á‡≤≥‡≤ø: "‡≤™‡≥ç‡≤≤‡≤Ç‡≤¨‡≤∞‡≥ç ‡≤π‡≥Å‡≤°‡≥Å‡≤ï‡≤ø" ‡≤Ö‡≤•‡≤µ‡≤æ "‡≤é‡≤≤‡≥Ü‡≤ï‡≥ç‡≤ü‡≥ç‡≤∞‡≤ø‡≤∑‡≤ø‡≤Ø‡≤®‡≥ç ‡≤§‡≥ã‡≤∞‡≤ø‡≤∏‡≤ø"' },
            'noSpeechDetected': { en: 'No speech detected. Please try again.', hi: '‡§ï‡•ã‡§à ‡§Ü‡§µ‡§æ‡§ú‡§º ‡§®‡§π‡•Ä‡§Ç ‡§∏‡•Å‡§®‡•Ä‡•§ ‡§ï‡•É‡§™‡§Ø‡§æ ‡§™‡•Å‡§®‡§É ‡§™‡•ç‡§∞‡§Ø‡§æ‡§∏ ‡§ï‡§∞‡•á‡§Ç‡•§', bn: '‡¶ï‡ßã‡¶®‡ßã ‡¶ï‡¶•‡¶æ ‡¶∂‡ßã‡¶®‡¶æ ‡¶Ø‡¶æ‡¶Ø‡¶º‡¶®‡¶ø‡•§ ‡¶Ü‡¶¨‡¶æ‡¶∞ ‡¶ö‡ßá‡¶∑‡ßç‡¶ü‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶®‡•§', gu: '‡™ï‡´ã‡™à ‡™µ‡™æ‡™£‡´Ä ‡™∏‡™æ‡™Ç‡™≠‡™≥‡™æ‡™à ‡™®‡™π‡´Ä‡™Ç. ‡™´‡™∞‡´Ä ‡™™‡´ç‡™∞‡™Ø‡™æ‡™∏ ‡™ï‡™∞‡´ã.', mr: '‡§Ü‡§µ‡§æ‡§ú ‡§ê‡§ï‡•Ç ‡§Ü‡§≤‡§æ ‡§®‡§æ‡§π‡•Ä. ‡§™‡•Å‡§®‡•ç‡§π‡§æ ‡§™‡•ç‡§∞‡§Ø‡§§‡•ç‡§® ‡§ï‡§∞‡§æ.', kn: '‡≤Ø‡≤æ‡≤µ‡≥Å‡≤¶‡≥á ‡≤≠‡≤æ‡≤∑‡≤£ ‡≤™‡≤§‡≥ç‡≤§‡≥Ü‡≤Ø‡≤æ‡≤ó‡≤ø‡≤≤‡≥ç‡≤≤. ‡≤¶‡≤Ø‡≤µ‡≤ø‡≤ü‡≥ç‡≤ü‡≥Å ‡≤Æ‡≤§‡≥ç‡≤§‡≥Ü ‡≤™‡≥ç‡≤∞‡≤Ø‡≤§‡≥ç‡≤®‡≤ø‡≤∏‡≤ø.' },
            'searchingFor': { en: 'Searching for {service}...', hi: '{service} ‡§ñ‡•ã‡§ú ‡§∞‡§π‡•á ‡§π‡•à‡§Ç...', bn: '{service} ‡¶ñ‡ßÅ‡¶Å‡¶ú‡¶õ‡¶ø...', gu: '{service} ‡™∂‡´ã‡™ß‡´Ä ‡™∞‡™π‡´ç‡™Ø‡™æ ‡™õ‡´Ä‡™è...', mr: '{service} ‡§∂‡•ã‡§ß‡§§ ‡§Ü‡§π‡•á...', kn: '{service} ‡≤π‡≥Å‡≤°‡≥Å‡≤ï‡≥Å‡≤§‡≥ç‡≤§‡≤ø‡≤¶‡≥Ü...' }
        };
        
        // Translation helper function with variable substitution
        function t(key, vars = {}) {
            let text = translations[key] ? (translations[key][currentLanguage] || translations[key].en) : key;
            // Replace variables like {count}
            Object.keys(vars).forEach(varKey => {
                text = text.replace(`{${varKey}}`, vars[varKey]);
            });
            return text;
        }
        
        
        // ==================== CATEGORY VERSION & MERGE SYSTEM ====================
        // Increment CATEGORY_VERSION each time you add new default categories.
        // The merge logic will ADD new categories/subcategories/services to saved data
        // without removing anything the admin has added or customised.
        const CATEGORY_VERSION = 2; // <-- bump this number when adding new defaults

        // These are the MASTER default categories. They are only ever ADDED, never removed.
        const DEFAULT_CATEGORIES = [
            {
                id: 'cat1',
                name: { en: 'Home Services' },
                icon: 'üè†',
                subcategories: [
                    {
                        name: { en: 'Plumber' }, icon: 'üîß',
                        subsubcategories: [
                            { name: { en: 'Pipe Repair' }, icon: 'üîß' },
                            { name: { en: 'Tap/Faucet Repair' }, icon: 'üö∞' },
                            { name: { en: 'Tank Installation' }, icon: 'üíß' },
                            { name: { en: 'Bathroom Fitting' }, icon: 'üöø' },
                            { name: { en: 'Drainage Cleaning' }, icon: 'ü™£' }
                        ]
                    },
                    {
                        name: { en: 'Electrician' }, icon: '‚ö°',
                        subsubcategories: [
                            { name: { en: 'Wiring & Rewiring' }, icon: 'üîå' },
                            { name: { en: 'Fan Installation' }, icon: 'üåÄ' },
                            { name: { en: 'Light Installation' }, icon: 'üí°' },
                            { name: { en: 'Switchboard Repair' }, icon: 'üî≤' },
                            { name: { en: 'Appliance Repair' }, icon: 'üîß' }
                        ]
                    },
                    {
                        name: { en: 'AC Repair & Servicing' }, icon: '‚ùÑÔ∏è',
                        subsubcategories: [
                            { name: { en: 'AC Servicing' }, icon: '‚ùÑÔ∏è' },
                            { name: { en: 'AC Installation' }, icon: 'üî©' },
                            { name: { en: 'AC Gas Refill' }, icon: 'üí®' },
                            { name: { en: 'AC Uninstallation' }, icon: 'üîß' }
                        ]
                    },
                    {
                        name: { en: 'Carpenter' }, icon: 'ü™µ',
                        subsubcategories: [
                            { name: { en: 'Furniture Repair' }, icon: 'ü™ë' },
                            { name: { en: 'Door/Window Repair' }, icon: 'üö™' },
                            { name: { en: 'Wood Polishing' }, icon: '‚ú®' },
                            { name: { en: 'Custom Furniture' }, icon: 'üõãÔ∏è' }
                        ]
                    },
                    {
                        name: { en: 'RO Repair & Installation' }, icon: 'üíß',
                        subsubcategories: [
                            { name: { en: 'RO Installation' }, icon: 'üíß' },
                            { name: { en: 'RO Service & Filter Change' }, icon: 'üîß' },
                            { name: { en: 'RO Repair' }, icon: 'üõ†Ô∏è' }
                        ]
                    },
                    {
                        name: { en: 'Geyser Repair' }, icon: 'üöø',
                        subsubcategories: [
                            { name: { en: 'Geyser Repair' }, icon: 'üîß' },
                            { name: { en: 'Geyser Installation' }, icon: 'üöø' },
                            { name: { en: 'Element Replacement' }, icon: '‚ö°' }
                        ]
                    },
                    {
                        name: { en: 'Inverter/Battery Service' }, icon: 'üîã',
                        subsubcategories: [
                            { name: { en: 'Inverter Repair' }, icon: 'üîã' },
                            { name: { en: 'Battery Replacement' }, icon: 'üîå' },
                            { name: { en: 'Solar Panel Service' }, icon: '‚òÄÔ∏è' }
                        ]
                    },
                    {
                        name: { en: 'CCTV Installation' }, icon: 'üì∑',
                        subsubcategories: [
                            { name: { en: 'CCTV Installation' }, icon: 'üì∑' },
                            { name: { en: 'CCTV Repair' }, icon: 'üîß' },
                            { name: { en: 'DVR/NVR Setup' }, icon: 'üñ•Ô∏è' }
                        ]
                    },
                    {
                        name: { en: 'Water Tank Cleaning' }, icon: 'üõ¢Ô∏è',
                        subsubcategories: [
                            { name: { en: 'Overhead Tank Cleaning' }, icon: 'üõ¢Ô∏è' },
                            { name: { en: 'Underground Tank Cleaning' }, icon: '‚¨áÔ∏è' },
                            { name: { en: 'Sump Cleaning' }, icon: 'ü™£' }
                        ]
                    },
                    {
                        name: { en: 'Pest Control' }, icon: 'üêú',
                        subsubcategories: [
                            { name: { en: 'Cockroach Treatment' }, icon: 'ü™≤' },
                            { name: { en: 'Termite Treatment' }, icon: 'üêõ' },
                            { name: { en: 'Mosquito Treatment' }, icon: 'ü¶ü' },
                            { name: { en: 'Rodent Control' }, icon: 'üêÄ' },
                            { name: { en: 'Bed Bug Treatment' }, icon: 'üõèÔ∏è' }
                        ]
                    },
                    {
                        name: { en: 'Painter' }, icon: 'üé®',
                        subsubcategories: [
                            { name: { en: 'Wall Painting' }, icon: 'üñåÔ∏è' },
                            { name: { en: 'Waterproofing' }, icon: 'üí¶' },
                            { name: { en: 'Texture Painting' }, icon: 'üé®' },
                            { name: { en: 'Exterior Painting' }, icon: 'üè†' }
                        ]
                    },
                    {
                        name: { en: 'Interior Designer' }, icon: 'üõãÔ∏è',
                        subsubcategories: [
                            { name: { en: 'Home Interior Design' }, icon: 'üè°' },
                            { name: { en: '3D Design Consultation' }, icon: 'üñ•Ô∏è' },
                            { name: { en: 'Office Interior' }, icon: 'üè¢' }
                        ]
                    },
                    {
                        name: { en: 'Modular Kitchen' }, icon: 'üç≥',
                        subsubcategories: [
                            { name: { en: 'Modular Kitchen Design' }, icon: 'üç≥' },
                            { name: { en: 'Kitchen Installation' }, icon: 'üî©' },
                            { name: { en: 'Kitchen Repair' }, icon: 'üîß' }
                        ]
                    }
                ]
            },
            {
                id: 'cat2',
                name: { en: 'Beauty & Wellness' },
                icon: 'üíÑ',
                subcategories: [
                    {
                        name: { en: 'Bridal Makeup' }, icon: 'üë∞',
                        subsubcategories: [
                            { name: { en: 'Bridal Makeup' }, icon: 'üíÑ' },
                            { name: { en: 'Engagement Makeup' }, icon: 'üíç' },
                            { name: { en: 'Party Makeup' }, icon: '‚ú®' }
                        ]
                    },
                    {
                        name: { en: 'Mehendi Artist' }, icon: 'üåø',
                        subsubcategories: [
                            { name: { en: 'Bridal Mehendi' }, icon: 'üë∞' },
                            { name: { en: 'Party Mehendi' }, icon: 'üéâ' },
                            { name: { en: 'Arabic Mehendi' }, icon: 'üåø' }
                        ]
                    },
                    {
                        name: { en: 'Home Salon Services' }, icon: 'üíÖ',
                        subsubcategories: [
                            { name: { en: 'Facial' }, icon: 'üßñ' },
                            { name: { en: 'Waxing' }, icon: '‚ú®' },
                            { name: { en: 'Threading' }, icon: 'üßµ' },
                            { name: { en: 'Pedicure & Manicure' }, icon: 'üíÖ' }
                        ]
                    },
                    {
                        name: { en: 'Hair Stylist at Home' }, icon: 'üíá',
                        subsubcategories: [
                            { name: { en: 'Haircut' }, icon: '‚úÇÔ∏è' },
                            { name: { en: 'Hair Colour' }, icon: 'üé®' },
                            { name: { en: 'Hair Treatment' }, icon: '‚ú®' },
                            { name: { en: 'Blow Dry & Setting' }, icon: 'üí®' }
                        ]
                    },
                    {
                        name: { en: 'Nail Artist' }, icon: 'üíÖ',
                        subsubcategories: [
                            { name: { en: 'Nail Extensions' }, icon: 'üíÖ' },
                            { name: { en: 'Nail Art' }, icon: 'üé®' },
                            { name: { en: 'Gel Nails' }, icon: '‚ú®' }
                        ]
                    },
                    {
                        name: { en: 'Men Grooming' }, icon: 'üíà',
                        subsubcategories: [
                            { name: { en: 'Haircut at Home' }, icon: '‚úÇÔ∏è' },
                            { name: { en: 'Beard Styling' }, icon: 'üßî' },
                            { name: { en: 'Facial for Men' }, icon: 'üßñ' }
                        ]
                    },
                    {
                        name: { en: 'Spa at Home' }, icon: 'üßò',
                        subsubcategories: [
                            { name: { en: 'Full Body Massage' }, icon: 'üíÜ' },
                            { name: { en: 'Head Massage' }, icon: 'üß†' },
                            { name: { en: 'Foot Massage' }, icon: 'ü¶∂' },
                            { name: { en: 'Aromatherapy' }, icon: 'üå∏' }
                        ]
                    },
                    {
                        name: { en: 'Fitness Trainer' }, icon: 'üèãÔ∏è',
                        subsubcategories: [
                            { name: { en: 'Personal Training at Home' }, icon: 'üèãÔ∏è' },
                            { name: { en: 'Weight Loss Program' }, icon: '‚öñÔ∏è' },
                            { name: { en: 'Strength Training' }, icon: 'üí™' }
                        ]
                    },
                    {
                        name: { en: 'Yoga Instructor' }, icon: 'üßò',
                        subsubcategories: [
                            { name: { en: 'Morning Yoga' }, icon: 'üåÖ' },
                            { name: { en: 'Meditation Sessions' }, icon: 'üßò' },
                            { name: { en: 'Prenatal Yoga' }, icon: 'ü§∞' }
                        ]
                    },
                    {
                        name: { en: 'Dietician' }, icon: 'ü•ó',
                        subsubcategories: [
                            { name: { en: 'Diet Consultation' }, icon: 'ü•ó' },
                            { name: { en: 'Weight Management Plan' }, icon: '‚öñÔ∏è' },
                            { name: { en: 'Disease-specific Diet' }, icon: 'üè•' }
                        ]
                    },
                    {
                        name: { en: 'Physiotherapist' }, icon: 'ü¶¥',
                        subsubcategories: [
                            { name: { en: 'Home Physiotherapy' }, icon: 'ü¶¥' },
                            { name: { en: 'Sports Injury Rehab' }, icon: '‚öΩ' },
                            { name: { en: 'Post-surgery Rehab' }, icon: 'üè•' }
                        ]
                    }
                ]
            },
            {
                id: 'cat3',
                name: { en: 'Cleaning Services' },
                icon: 'üßπ',
                subcategories: [
                    {
                        name: { en: 'Deep Home Cleaning' }, icon: 'üè†',
                        subsubcategories: [
                            { name: { en: 'Full Home Deep Clean' }, icon: 'üßπ' },
                            { name: { en: 'Bathroom Deep Clean' }, icon: 'üöø' },
                            { name: { en: 'Post-renovation Cleaning' }, icon: 'üî®' }
                        ]
                    },
                    {
                        name: { en: 'Sofa Cleaning' }, icon: 'üõãÔ∏è',
                        subsubcategories: [
                            { name: { en: 'Fabric Sofa Cleaning' }, icon: 'üõãÔ∏è' },
                            { name: { en: 'Leather Sofa Cleaning' }, icon: '‚ú®' },
                            { name: { en: 'Sofa Shampooing' }, icon: 'üß¥' }
                        ]
                    },
                    {
                        name: { en: 'Mattress Cleaning' }, icon: 'üõèÔ∏è',
                        subsubcategories: [
                            { name: { en: 'Mattress Deep Clean' }, icon: 'üõèÔ∏è' },
                            { name: { en: 'Mattress Sanitization' }, icon: 'üßº' }
                        ]
                    },
                    {
                        name: { en: 'Kitchen Deep Cleaning' }, icon: 'üç≥',
                        subsubcategories: [
                            { name: { en: 'Chimney Cleaning' }, icon: 'üå´Ô∏è' },
                            { name: { en: 'Stove & Burner Cleaning' }, icon: 'üî•' },
                            { name: { en: 'Full Kitchen Deep Clean' }, icon: 'üßπ' }
                        ]
                    },
                    {
                        name: { en: 'Marble Polishing' }, icon: '‚ú®',
                        subsubcategories: [
                            { name: { en: 'Floor Polishing' }, icon: '‚ú®' },
                            { name: { en: 'Granite Polishing' }, icon: 'ü™®' },
                            { name: { en: 'Anti-skid Treatment' }, icon: '‚ö†Ô∏è' }
                        ]
                    },
                    {
                        name: { en: 'Move-in/Move-out Cleaning' }, icon: 'üì¶',
                        subsubcategories: [
                            { name: { en: 'Move-in Cleaning' }, icon: 'üè†' },
                            { name: { en: 'Move-out Cleaning' }, icon: 'üì¶' },
                            { name: { en: 'Vacant Flat Cleaning' }, icon: 'üè¢' }
                        ]
                    }
                ]
            },
            {
                id: 'cat4',
                name: { en: 'Event Services' },
                icon: 'üéâ',
                subcategories: [
                    {
                        name: { en: 'Wedding Photographer' }, icon: 'üì∏',
                        subsubcategories: [
                            { name: { en: 'Wedding Photography' }, icon: 'üì∏' },
                            { name: { en: 'Pre-wedding Shoot' }, icon: 'üíï' },
                            { name: { en: 'Candid Photography' }, icon: 'üéûÔ∏è' }
                        ]
                    },
                    {
                        name: { en: 'Videographer' }, icon: 'üé•',
                        subsubcategories: [
                            { name: { en: 'Wedding Videography' }, icon: 'üé•' },
                            { name: { en: 'Cinematic Film' }, icon: 'üé¨' },
                            { name: { en: 'Drone Videography' }, icon: 'üöÅ' }
                        ]
                    },
                    {
                        name: { en: 'DJ Services' }, icon: 'üéß',
                        subsubcategories: [
                            { name: { en: 'Wedding DJ' }, icon: 'üéß' },
                            { name: { en: 'Party DJ' }, icon: 'üéâ' },
                            { name: { en: 'Sound System Rental' }, icon: 'üîä' }
                        ]
                    },
                    {
                        name: { en: 'Caterers' }, icon: 'üçΩÔ∏è',
                        subsubcategories: [
                            { name: { en: 'Wedding Catering' }, icon: 'üçΩÔ∏è' },
                            { name: { en: 'Birthday Catering' }, icon: 'üéÇ' },
                            { name: { en: 'Corporate Catering' }, icon: 'üè¢' },
                            { name: { en: 'Tiffin Service' }, icon: 'ü•°' }
                        ]
                    },
                    {
                        name: { en: 'Tent & Decoration' }, icon: 'üé™',
                        subsubcategories: [
                            { name: { en: 'Wedding Decoration' }, icon: 'üíê' },
                            { name: { en: 'Tent & Shamiana' }, icon: 'üé™' },
                            { name: { en: 'Stage Decoration' }, icon: 'üé≠' },
                            { name: { en: 'Flower Decoration' }, icon: 'üå∏' }
                        ]
                    },
                    {
                        name: { en: 'Birthday Party Planner' }, icon: 'üéÇ',
                        subsubcategories: [
                            { name: { en: 'Kids Birthday Planning' }, icon: 'üéà' },
                            { name: { en: 'Theme Party Setup' }, icon: 'üé†' },
                            { name: { en: 'Balloon Decoration' }, icon: 'üéà' }
                        ]
                    },
                    {
                        name: { en: 'Anchor / Emcee' }, icon: 'üé§',
                        subsubcategories: [
                            { name: { en: 'Wedding Anchor' }, icon: 'üíç' },
                            { name: { en: 'Corporate Emcee' }, icon: 'üè¢' },
                            { name: { en: 'Bilingual Anchor' }, icon: 'üåê' }
                        ]
                    },
                    {
                        name: { en: 'Band / Dhol' }, icon: 'ü•Å',
                        subsubcategories: [
                            { name: { en: 'Baraat Band' }, icon: 'üé∫' },
                            { name: { en: 'Dhol Players' }, icon: 'ü•Å' },
                            { name: { en: 'Brass Band' }, icon: 'üé∑' }
                        ]
                    },
                    {
                        name: { en: 'Folk Artists Booking' }, icon: 'üé≠',
                        subsubcategories: [
                            { name: { en: 'Kalbelia Dancers' }, icon: 'üíÉ' },
                            { name: { en: 'Kalbeliya Performers' }, icon: 'üé≠' },
                            { name: { en: 'Folk Music Group' }, icon: 'üé∂' },
                            { name: { en: 'Fire Show Artist' }, icon: 'üî•' }
                        ]
                    }
                ]
            },
            {
                id: 'cat5',
                name: { en: 'Travel & Transport' },
                icon: 'üöó',
                subcategories: [
                    {
                        name: { en: 'Taxi Booking' }, icon: 'üöï',
                        subsubcategories: [
                            { name: { en: 'Local Taxi' }, icon: 'üöï' },
                            { name: { en: 'Outstation Taxi' }, icon: 'üõ£Ô∏è' },
                            { name: { en: 'Airport Transfer' }, icon: '‚úàÔ∏è' }
                        ]
                    },
                    {
                        name: { en: 'Tempo Traveller Rental' }, icon: 'üöê',
                        subsubcategories: [
                            { name: { en: '9-Seater Tempo' }, icon: 'üöê' },
                            { name: { en: '12-Seater Tempo' }, icon: 'üöå' },
                            { name: { en: '17-Seater Tempo' }, icon: 'üöå' }
                        ]
                    },
                    {
                        name: { en: 'Car Rental with Driver' }, icon: 'üöó',
                        subsubcategories: [
                            { name: { en: 'Sedan Rental' }, icon: 'üöó' },
                            { name: { en: 'SUV Rental' }, icon: 'üöô' },
                            { name: { en: 'Luxury Car Rental' }, icon: 'üèéÔ∏è' }
                        ]
                    },
                    {
                        name: { en: 'Bike Rental' }, icon: 'üèçÔ∏è',
                        subsubcategories: [
                            { name: { en: 'Scooter Rental' }, icon: 'üõµ' },
                            { name: { en: 'Motorcycle Rental' }, icon: 'üèçÔ∏è' },
                            { name: { en: 'Royal Enfield Rental' }, icon: 'üèçÔ∏è' }
                        ]
                    },
                    {
                        name: { en: 'Local Tour Guide' }, icon: 'üó∫Ô∏è',
                        subsubcategories: [
                            { name: { en: 'City Tour Guide' }, icon: 'üèôÔ∏è' },
                            { name: { en: 'Heritage Walk Guide' }, icon: 'üèõÔ∏è' },
                            { name: { en: 'Multilingual Guide' }, icon: 'üåê' }
                        ]
                    },
                    {
                        name: { en: 'Desert Safari Booking' }, icon: 'üê™',
                        subsubcategories: [
                            { name: { en: 'Camel Safari' }, icon: 'üê™' },
                            { name: { en: 'Jeep Safari' }, icon: 'üöô' },
                            { name: { en: 'Overnight Desert Camp' }, icon: '‚õ∫' }
                        ]
                    },
                    {
                        name: { en: 'Driver on Demand' }, icon: 'üßë‚Äç‚úàÔ∏è',
                        subsubcategories: [
                            { name: { en: 'Personal Driver' }, icon: 'üßë‚Äç‚úàÔ∏è' },
                            { name: { en: 'Corporate Driver' }, icon: 'üíº' },
                            { name: { en: 'Night Driver' }, icon: 'üåô' }
                        ]
                    }
                ]
            },
            {
                id: 'cat6',
                name: { en: 'Real Estate & Property' },
                icon: 'üè¢',
                subcategories: [
                    {
                        name: { en: 'Property Dealer' }, icon: 'üè†',
                        subsubcategories: [
                            { name: { en: 'Residential Property' }, icon: 'üè°' },
                            { name: { en: 'Commercial Property' }, icon: 'üè¢' },
                            { name: { en: 'Land/Plot Dealing' }, icon: 'üåæ' }
                        ]
                    },
                    {
                        name: { en: 'Rental Listings' }, icon: 'üîë',
                        subsubcategories: [
                            { name: { en: 'Flat/Apartment Rental' }, icon: 'üè¢' },
                            { name: { en: 'PG Accommodation' }, icon: 'üõèÔ∏è' },
                            { name: { en: 'Shop/Office Rental' }, icon: 'üè™' }
                        ]
                    },
                    {
                        name: { en: 'Packers & Movers' }, icon: 'üì¶',
                        subsubcategories: [
                            { name: { en: 'Home Shifting' }, icon: 'üè†' },
                            { name: { en: 'Office Relocation' }, icon: 'üè¢' },
                            { name: { en: 'Vehicle Transportation' }, icon: 'üöó' }
                        ]
                    },
                    {
                        name: { en: 'Marble/Stone Contractor' }, icon: 'ü™®',
                        subsubcategories: [
                            { name: { en: 'Marble Flooring' }, icon: 'ü™®' },
                            { name: { en: 'Granite Work' }, icon: 'üèóÔ∏è' },
                            { name: { en: 'Stone Cladding' }, icon: 'üß±' }
                        ]
                    }
                ]
            },
            {
                id: 'cat7',
                name: { en: 'Education & Skill Services' },
                icon: 'üìö',
                subcategories: [
                    {
                        name: { en: 'Home Tutor' }, icon: 'üìñ',
                        subsubcategories: [
                            { name: { en: 'Primary School Tutor' }, icon: '‚úèÔ∏è' },
                            { name: { en: 'Secondary School Tutor' }, icon: 'üìê' },
                            { name: { en: 'Science & Math Tutor' }, icon: 'üî¨' },
                            { name: { en: 'Commerce Tutor' }, icon: 'üíπ' }
                        ]
                    },
                    {
                        name: { en: 'Spoken English Trainer' }, icon: 'üó£Ô∏è',
                        subsubcategories: [
                            { name: { en: 'Basic Spoken English' }, icon: 'üó£Ô∏è' },
                            { name: { en: 'Business English' }, icon: 'üíº' },
                            { name: { en: 'IELTS / TOEFL Coaching' }, icon: 'üìù' }
                        ]
                    },
                    {
                        name: { en: 'Competitive Exam Tutor' }, icon: 'üèÜ',
                        subsubcategories: [
                            { name: { en: 'UPSC Coaching' }, icon: 'üèõÔ∏è' },
                            { name: { en: 'REET / RPSC Coaching' }, icon: 'üìã' },
                            { name: { en: 'SSC / Railway Coaching' }, icon: 'üöÇ' },
                            { name: { en: 'JEE / NEET Coaching' }, icon: 'üî¨' }
                        ]
                    },
                    {
                        name: { en: 'Dance Teacher' }, icon: 'üíÉ',
                        subsubcategories: [
                            { name: { en: 'Classical Dance' }, icon: 'üíÉ' },
                            { name: { en: 'Bollywood Dance' }, icon: 'üé¨' },
                            { name: { en: 'Western Dance' }, icon: 'üï∫' },
                            { name: { en: 'Folk Dance' }, icon: 'üé≠' }
                        ]
                    },
                    {
                        name: { en: 'Music Teacher' }, icon: 'üéµ',
                        subsubcategories: [
                            { name: { en: 'Guitar Classes' }, icon: 'üé∏' },
                            { name: { en: 'Keyboard / Piano' }, icon: 'üéπ' },
                            { name: { en: 'Vocals / Singing' }, icon: 'üé§' },
                            { name: { en: 'Tabla / Harmonium' }, icon: 'ü•Å' }
                        ]
                    }
                ]
            },
            {
                id: 'cat8',
                name: { en: 'Business & Professional Services' },
                icon: 'üíº',
                subcategories: [
                    {
                        name: { en: 'CA / Tax Filing' }, icon: 'üìä',
                        subsubcategories: [
                            { name: { en: 'ITR Filing' }, icon: 'üìã' },
                            { name: { en: 'GST Registration & Filing' }, icon: 'üßæ' },
                            { name: { en: 'Business Accounting' }, icon: 'üìä' },
                            { name: { en: 'Audit Services' }, icon: 'üîç' }
                        ]
                    },
                    {
                        name: { en: 'Legal Advisor' }, icon: '‚öñÔ∏è',
                        subsubcategories: [
                            { name: { en: 'Property Legal Help' }, icon: 'üè†' },
                            { name: { en: 'Family Law / Divorce' }, icon: 'üë®‚Äçüë©‚Äçüëß' },
                            { name: { en: 'Business Legal Services' }, icon: 'üíº' },
                            { name: { en: 'Documentation Help' }, icon: 'üìÑ' }
                        ]
                    },
                    {
                        name: { en: 'Website Developer' }, icon: 'üíª',
                        subsubcategories: [
                            { name: { en: 'Business Website' }, icon: 'üåê' },
                            { name: { en: 'E-commerce Website' }, icon: 'üõí' },
                            { name: { en: 'App Development' }, icon: 'üì±' }
                        ]
                    },
                    {
                        name: { en: 'Graphic Designer' }, icon: 'üé®',
                        subsubcategories: [
                            { name: { en: 'Logo Design' }, icon: 'üéØ' },
                            { name: { en: 'Brochure / Flyer Design' }, icon: 'üì∞' },
                            { name: { en: 'Banner & Poster Design' }, icon: 'üñºÔ∏è' }
                        ]
                    },
                    {
                        name: { en: 'Social Media Manager' }, icon: 'üì±',
                        subsubcategories: [
                            { name: { en: 'Instagram Management' }, icon: 'üì∏' },
                            { name: { en: 'Facebook Marketing' }, icon: 'üëç' },
                            { name: { en: 'Content Creation' }, icon: '‚úçÔ∏è' },
                            { name: { en: 'Paid Ads Management' }, icon: 'üí∞' }
                        ]
                    },
                    {
                        name: { en: 'Wedding Invitation Designer' }, icon: 'üíå',
                        subsubcategories: [
                            { name: { en: 'Digital Invitations' }, icon: 'üì±' },
                            { name: { en: 'Printed Card Design' }, icon: 'üñ®Ô∏è' },
                            { name: { en: 'Video Invitations' }, icon: 'üé•' }
                        ]
                    }
                ]
            },
            {
                id: 'cat9',
                name: { en: 'Pet Services' },
                icon: 'üêæ',
                subcategories: [
                    {
                        name: { en: 'Pet Grooming' }, icon: 'üê∂',
                        subsubcategories: [
                            { name: { en: 'Dog Grooming at Home' }, icon: 'üêï' },
                            { name: { en: 'Cat Grooming' }, icon: 'üê±' },
                            { name: { en: 'Bath & Blow Dry' }, icon: 'üöø' }
                        ]
                    },
                    {
                        name: { en: 'Pet Boarding' }, icon: 'üè†',
                        subsubcategories: [
                            { name: { en: 'Dog Boarding' }, icon: 'üêï' },
                            { name: { en: 'Cat Boarding' }, icon: 'üê±' },
                            { name: { en: 'Home-based Pet Sitting' }, icon: 'üè°' }
                        ]
                    },
                    {
                        name: { en: 'Dog Training' }, icon: 'ü¶Æ',
                        subsubcategories: [
                            { name: { en: 'Basic Obedience Training' }, icon: 'ü¶Æ' },
                            { name: { en: 'Advanced Training' }, icon: 'üèÜ' },
                            { name: { en: 'Puppy Training' }, icon: 'üê∂' }
                        ]
                    },
                    {
                        name: { en: 'Vet on Call' }, icon: 'üè•',
                        subsubcategories: [
                            { name: { en: 'Home Visit Vet' }, icon: 'üè•' },
                            { name: { en: 'Vaccination at Home' }, icon: 'üíâ' },
                            { name: { en: 'Online Vet Consultation' }, icon: 'üíª' }
                        ]
                    }
                ]
            }
        ]; // end DEFAULT_CATEGORIES

        // ==================== CATEGORY MERGE FUNCTION ====================
        // Merges DEFAULT_CATEGORIES into saved categories:
        //   - New top-level categories are APPENDED (never removed)
        //   - New subcategories inside existing categories are APPENDED
        //   - New service types inside existing subcategories are APPENDED
        //   - Anything the admin added/edited/deleted is PRESERVED
        function mergeCategories(saved, defaults) {
            const merged = [...saved]; // start from what's saved

            defaults.forEach(defCat => {
                // Match by id first, then by English name as fallback
                const existingCat = merged.find(c =>
                    (c.id && defCat.id && c.id === defCat.id) ||
                    ((c.name?.en || c.name) === (defCat.name?.en || defCat.name))
                );

                if (!existingCat) {
                    // Brand-new category ‚Äî append it whole
                    merged.push(defCat);
                } else {
                    // Category exists ‚Äî merge subcategories
                    if (!existingCat.subcategories) existingCat.subcategories = [];
                    const existingSubs = existingCat.subcategories;

                    (defCat.subcategories || []).forEach(defSub => {
                        const existingSub = existingSubs.find(s =>
                            (s.name?.en || s.name) === (defSub.name?.en || defSub.name)
                        );

                        if (!existingSub) {
                            // New subcategory ‚Äî append it whole
                            existingSubs.push(defSub);
                        } else {
                            // Subcategory exists ‚Äî merge service types
                            if (!existingSub.subsubcategories) existingSub.subsubcategories = [];
                            const existingServices = existingSub.subsubcategories;

                            (defSub.subsubcategories || []).forEach(defService => {
                                const alreadyExists = existingServices.some(sv =>
                                    (sv.name?.en || sv.name) === (defService.name?.en || defService.name)
                                );
                                if (!alreadyExists) {
                                    // New service type ‚Äî append it
                                    existingServices.push(defService);
                                }
                                // If it exists: leave it exactly as the admin has it
                            });
                        }
                    });
                }
            });

            return merged;
        }

        // ==================== LOAD & AUTO-MERGE CATEGORIES ====================
        (function initCategories() {
            const savedVersion   = parseInt(localStorage.getItem('categoryVersion') || '0');
            const savedRaw       = localStorage.getItem('categories');

            if (!savedRaw) {
                // First ever load ‚Äî just use defaults as-is
                localStorage.setItem('categories', JSON.stringify(DEFAULT_CATEGORIES));
                localStorage.setItem('categoryVersion', String(CATEGORY_VERSION));
                console.log('‚úÖ Categories: first load, defaults applied.');
            } else if (savedVersion < CATEGORY_VERSION) {
                // New version detected ‚Äî merge new defaults into saved data
                const saved  = JSON.parse(savedRaw);
                const merged = mergeCategories(saved, DEFAULT_CATEGORIES);
                localStorage.setItem('categories', JSON.stringify(merged));
                localStorage.setItem('categoryVersion', String(CATEGORY_VERSION));
                console.log(`‚úÖ Categories: merged from v${savedVersion} ‚Üí v${CATEGORY_VERSION}. Total categories: ${merged.length}`);
            } else {
                console.log(`‚úÖ Categories: already at v${CATEGORY_VERSION}, no merge needed.`);
            }
        })();

        // Live working array ‚Äî always read fresh after the merge above
        let categories = JSON.parse(localStorage.getItem('categories'));

        // ==================== UTILITY FUNCTIONS ====================
        function getTranslated(obj, defaultText = '') {
            if (!obj) return defaultText;
            if (typeof obj === 'string') return obj;
            return obj[currentLanguage] || obj.en || defaultText;
        }
        
        // Haversine formula for distance calculation
        function calculateDistance(lat1, lon1, lat2, lon2) {
            const R = 6371; // Earth's radius in km
            const dLat = (lat2 - lat1) * Math.PI / 180;
            const dLon = (lon2 - lon1) * Math.PI / 180;
            const a = Math.sin(dLat/2) * Math.sin(dLat/2) +
                      Math.cos(lat1 * Math.PI / 180) * Math.cos(lat2 * Math.PI / 180) *
                      Math.sin(dLon/2) * Math.sin(dLon/2);
            const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));
            return R * c; // Distance in km
        }
        
        function generateStars(rating) {
            const fullStars = Math.floor(rating);
            const halfStar = rating % 1 >= 0.5 ? 1 : 0;
            const emptyStars = 5 - fullStars - halfStar;
            
            let stars = '‚≠ê'.repeat(fullStars);
            if (halfStar) stars += '‚≠ê';
            stars += '‚òÜ'.repeat(emptyStars);
            return stars;
        }
        
        // ==================== LANGUAGE ====================
        function selectLanguage(lang) {
            currentLanguage = lang;
            localStorage.setItem('language', lang);
            document.getElementById('languageModal').classList.add('hidden');
            
            // Update language button
            const langNames = {
                'en': 'EN',
                'hi': '‡§π‡§ø‡§Ç',
                'bn': '‡¶¨‡¶æ‡¶Ç',
                'gu': '‡™ó‡´Å‡™ú',
                'mr': '‡§Æ‡§∞‡§æ',
                'kn': '‡≤ï‡≤®‡≥ç‡≤®'
            };
            document.getElementById('currentLang').textContent = langNames[lang] || 'EN';
            
            // Update ALL UI text
            updateAllUIText();
            
            // Reload content in new language (categories)
            loadHomeCategories();
            loadBrowseCategories();
            updateProviderCategorySelects();
            
            console.log('Language changed to:', lang);
        }
        
        function initializeTranslations() {
            // Add data-i18n attributes to elements that need translation
            // This runs once on page load to mark translatable elements
            
            // Already done in HTML: Navigation buttons
            
            // Mark headings
            document.querySelectorAll('h1, h2, h3').forEach(heading => {
                const text = heading.textContent.trim();
                if (text.includes('Find') && text.includes('Perfect')) heading.setAttribute('data-i18n', 'findProviders');
                if (text === 'Service Categories') heading.setAttribute('data-i18n', 'serviceCategories');
                if (text.includes('Register as Service Provider')) heading.setAttribute('data-i18n', 'registerAsProvider');
                if (text.includes('Register as Service Seeker')) heading.setAttribute('data-i18n', 'registerAsSeeker');
                if (text === '1Ô∏è‚É£ Select Category') heading.setAttribute('data-i18n', 'selectCategory');
                if (text === '2Ô∏è‚É£ Select Subcategory') heading.setAttribute('data-i18n', 'selectSubcategory');
                if (text === '3Ô∏è‚É£ Select Service Type') heading.setAttribute('data-i18n', 'selectService');
                if (text === 'Providers Near You') heading.setAttribute('data-i18n', 'providersNearYou');
                if (text.includes('Find Service Providers Near You')) heading.setAttribute('data-i18n', 'findServiceProviders');
            });
            
            // Mark form labels
            document.querySelectorAll('label').forEach(label => {
                const text = label.textContent.trim();
                if (text === 'Full Name *') label.setAttribute('data-i18n', 'fullName');
                if (text === 'Mobile Number *') label.setAttribute('data-i18n', 'mobile');
                if (text === 'Category (Optional)') label.setAttribute('data-i18n', 'category');
                if (text === 'Subcategory (Optional)') label.setAttribute('data-i18n', 'subcategory');
                if (text === 'Service Type (Optional)') label.setAttribute('data-i18n', 'serviceType');
                if (text === 'Religion *') label.setAttribute('data-i18n', 'religion');
                if (text === 'Experience (years) *') label.setAttribute('data-i18n', 'experience');
                if (text.includes('Rate') && text.includes('*')) label.setAttribute('data-i18n', 'rate');
                if (text === 'Location/Address *') label.setAttribute('data-i18n', 'location');
                if (text === 'Set Your Location on Map') label.setAttribute('data-i18n', 'setLocation');
            });
            
            // Mark buttons
            document.querySelectorAll('button').forEach(btn => {
                const text = btn.textContent.trim();
                if (text.includes('Use My Location')) btn.setAttribute('data-i18n', 'useMyLocation');
                if (text === 'Register Now') btn.setAttribute('data-i18n', 'registerNow');
                if (text === 'Browse Services') btn.setAttribute('data-i18n', 'browseServices');
                if (text === 'Become a Provider') btn.setAttribute('data-i18n', 'becomeProvider');
                if (text.includes('Back to Home')) btn.setAttribute('data-i18n', 'backToHome');
            });
            
            console.log('Translation attributes initialized');
        }
        
        function updateAllUIText() {
            // Update all elements with data-i18n attribute
            document.querySelectorAll('[data-i18n]').forEach(element => {
                const key = element.getAttribute('data-i18n');
                element.textContent = t(key);
            });
            
            // Update Select Religion dropdown
            const religionSelects = document.querySelectorAll('#providerReligion, #seekerReligion');
            religionSelects.forEach(select => {
                if (select && select.options[0]) {
                    select.options[0].text = t('selectReligion');
                }
            });
            
            console.log('UI text updated to language:', currentLanguage);
        }
        
        function changeLang() {
            document.getElementById('languageModal').classList.remove('hidden');
        }
        
        // ==================== NAVIGATION ====================
        function showPage(pageName) {
            document.querySelectorAll('.page').forEach(page => page.classList.add('hidden'));
            document.getElementById('page-' + pageName).classList.remove('hidden');
            
            if (pageName === 'home') {
                loadHomeCategories();
            } else if (pageName === 'browse') {
                loadBrowseCategories();
            } else if (pageName === 'map') {
                setTimeout(initMainMap, 100);
            } else if (pageName === 'register') {
                setTimeout(initRegisterMap, 100);
            } else if (pageName === 'seeker') {
                setTimeout(initSeekerMap, 100);
            } else if (pageName === 'myProfile') {
                renderProfilePage();
            }
        }
        
        // ==================== BROWSE PAGE WITH GRID VIEW ====================
        function loadBrowseCategories() {
            const grid = document.getElementById('browseCategoriesGrid');
            grid.innerHTML = categories.map(cat => `
                <div class="category-card bg-white p-6 rounded-xl shadow-md text-center" onclick="selectCategory('${cat.id}')">
                    <div class="text-5xl mb-3">${cat.icon}</div>
                    <div class="font-bold text-gray-800">${getTranslated(cat.name)}</div>
                </div>
            `).join('');
            
            // Reset selection
            document.getElementById('subcategorySection').classList.add('hidden');
            document.getElementById('serviceSection').classList.add('hidden');
            document.getElementById('providersSection').classList.add('hidden');
        }
        
        function selectCategory(catId) {
            selectedCategoryId = catId;
            selectedSubcategoryIdx = null;
            selectedServiceIdx = null;
            
            const category = categories.find(c => c.id === catId);
            if (!category || !category.subcategories) return;
            
            // Update UI - highlight selected
            document.querySelectorAll('#browseCategoriesGrid .category-card').forEach(card => {
                card.classList.remove('selected');
            });
            event.currentTarget.classList.add('selected');
            
            // Show subcategories
            const grid = document.getElementById('browseSubcategoriesGrid');
            grid.innerHTML = category.subcategories.map((sub, idx) => `
                <div class="category-card bg-white p-6 rounded-xl shadow-md text-center" onclick="selectSubcategory(${idx})">
                    <div class="text-4xl mb-3">${sub.icon}</div>
                    <div class="font-bold text-gray-800">${getTranslated(sub.name)}</div>
                </div>
            `).join('');
            
            document.getElementById('subcategorySection').classList.remove('hidden');
            document.getElementById('serviceSection').classList.add('hidden');
            document.getElementById('providersSection').classList.add('hidden');
        }
        
        function selectSubcategory(subIdx) {
            selectedSubcategoryIdx = subIdx;
            selectedServiceIdx = null;
            
            const category = categories.find(c => c.id === selectedCategoryId);
            const subcategory = category.subcategories[subIdx];
            
            if (!subcategory.subsubcategories) return;
            
            // Update UI
            document.querySelectorAll('#browseSubcategoriesGrid .category-card').forEach(card => {
                card.classList.remove('selected');
            });
            event.currentTarget.classList.add('selected');
            
            // Show services
            const grid = document.getElementById('browseServicesGrid');
            grid.innerHTML = subcategory.subsubcategories.map((service, idx) => `
                <div class="category-card bg-white p-6 rounded-xl shadow-md text-center" onclick="selectService(${idx})">
                    <div class="text-4xl mb-3">${service.icon}</div>
                    <div class="font-bold text-gray-800">${getTranslated(service.name)}</div>
                </div>
            `).join('');
            
            document.getElementById('serviceSection').classList.remove('hidden');
            document.getElementById('providersSection').classList.add('hidden');
        }
        
        function selectService(serviceIdx) {
            selectedServiceIdx = serviceIdx;
            
            // Update UI
            document.querySelectorAll('#browseServicesGrid .category-card').forEach(card => {
                card.classList.remove('selected');
            });
            event.currentTarget.classList.add('selected');
            
            // Load and display providers
            applySortAndFilter();
        }
        
        // ==================== PHASE B: SORT & FILTER FUNCTIONS ====================
        function toggleFilters() {
            const panel = document.getElementById('filterPanel');
            panel.classList.toggle('hidden');
        }
        
        function clearFilters() {
            document.getElementById('filterLanguage').value = '';
            document.getElementById('filterReligion').value = '';
            document.getElementById('filterPriceMin').value = '0';
            document.getElementById('filterPriceMax').value = '2000';
            document.getElementById('filterDistance').value = '999';
            document.getElementById('sortSelect').value = 'rating';
            applySortAndFilter();
        }
        
        function applySortAndFilter() {
            // Get current filtered providers (by service)
            const category = categories.find(c => c.id === selectedCategoryId);
            if (!category) {
                console.log('‚ùå Category not found:', selectedCategoryId);
                return;
            }
            
            const subcategory = category.subcategories[selectedSubcategoryIdx];
            if (!subcategory) {
                console.log('‚ùå Subcategory not found at index:', selectedSubcategoryIdx);
                return;
            }
            
            const service = subcategory.subsubcategories[selectedServiceIdx];
            if (!service) {
                console.log('‚ùå Service not found at index:', selectedServiceIdx);
                return;
            }
            
            const serviceNameEnglish = service.name.en || service.name;
            console.log('üîç Looking for providers with service:', serviceNameEnglish);
            console.log('üìã Target indices - Category:', selectedCategoryId, 'Sub:', selectedSubcategoryIdx, 'Service:', selectedServiceIdx);
            console.log('üìã Total providers in system:', providers.length);
            
            // Start with service filter - BACKWARD COMPATIBLE
            let filteredProviders = providers.filter(p => {
                // NEW: Exact match for providers with service name
                const exactMatch = p.service === serviceNameEnglish;
                
                // BACKWARD COMPATIBLE: For old providers without service field or with "undefined"
                // Check if they match by category/subcategory/service indices
                const hasValidService = p.service && p.service !== 'undefined' && p.service !== 'General Service Provider';
                const backwardCompatible = !hasValidService && 
                                          p.categoryId === selectedCategoryId && 
                                          p.subcategoryIdx == selectedSubcategoryIdx &&
                                          p.subsubcategoryIdx == selectedServiceIdx;
                
                const matchesService = exactMatch || backwardCompatible;
                const isActive = (!p.status || p.status === 'active');
                
                console.log('  Provider:', p.name);
                console.log('    Service:', p.service, '| CategoryId:', p.categoryId, '| SubIdx:', p.subcategoryIdx, '| ServiceIdx:', p.subsubcategoryIdx);
                console.log('    ExactMatch:', exactMatch, '| BackwardMatch:', backwardCompatible, '| FinalMatch:', matchesService, '| Active:', isActive);
                
                return matchesService && isActive;
            });
            
            console.log('‚úÖ Providers matching service:', filteredProviders.length);
            
            // Apply Phase B filters
            const filterLang = document.getElementById('filterLanguage').value;
            const filterRel = document.getElementById('filterReligion').value;
            const filterPriceMin = parseInt(document.getElementById('filterPriceMin').value) || 0;
            const filterPriceMax = parseInt(document.getElementById('filterPriceMax').value) || 99999;
            const filterDist = parseFloat(document.getElementById('filterDistance').value) || 999;
            
            filteredProviders = filteredProviders.filter(p => {
                // Language filter
                if (filterLang && p.language && p.language !== filterLang) return false;
                
                // Religion filter
                if (filterRel && p.religion !== filterRel) return false;
                
                // Price filter
                if (p.rate < filterPriceMin || p.rate > filterPriceMax) return false;
                
                // Distance filter (calculate if needed)
                if (currentUser && currentUser.lat && currentUser.lng && p.lat && p.lng) {
                    const dist = calculateDistance(currentUser.lat, currentUser.lng, p.lat, p.lng);
                    p.distance = dist;
                    if (dist > filterDist) return false;
                } else {
                    p.distance = 9999;
                }
                
                return true;
            });
            
            // Apply sorting
            const sortBy = document.getElementById('sortSelect').value;
            
            filteredProviders.sort((a, b) => {
                switch(sortBy) {
                    case 'rating':
                        return (b.rating || 0) - (a.rating || 0);
                    case 'price':
                        return (a.rate || 0) - (b.rate || 0);
                    case 'distance':
                        return (a.distance || 9999) - (b.distance || 9999);
                    case 'experience':
                        return (b.experience || 0) - (a.experience || 0);
                    default:
                        return 0;
                }
            });
            
            // Update results count
            document.getElementById('resultsCount').textContent = t('showingResults', { count: filteredProviders.length });
            
            // Render providers
            renderProviders(filteredProviders);
        }
        
        // ==================== PHASE E: PROVIDER CARD RENDERER ====================
        function getProviderAvatar(p) {
            if (p.photo) return `<img src="${p.photo}" alt="${p.name}" class="w-full h-full object-cover">`;
            const initials = p.name.split(' ').map(n => n[0]).join('').substring(0,2).toUpperCase();
            const colors = ['#ea580c','#2563eb','#16a34a','#9333ea','#dc2626','#0891b2'];
            const color = colors[p.name.charCodeAt(0) % colors.length];
            return `<div class="w-full h-full flex items-center justify-center text-white text-xl font-bold" style="background:${color}">${initials}</div>`;
        }

        function getVerifiedBadge(p) {
            if (p.verified) return `<span class="inline-flex items-center gap-1 bg-blue-100 text-blue-700 text-xs font-semibold px-2 py-0.5 rounded-full">‚úÖ Verified</span>`;
            return '';
        }

        function getAvgRating(p) {
            const reviews = p.reviews ? Object.values(p.reviews) : [];
            if (reviews.length === 0) return { avg: p.rating || 4.0, count: 0 };
            const avg = reviews.reduce((s, r) => s + r.rating, 0) / reviews.length;
            return { avg: Math.round(avg * 10) / 10, count: reviews.length };
        }

        function renderProviders(filteredProviders) {
            if (filteredProviders.length === 0) {
                document.getElementById('providersGridNew').innerHTML = `
                    <div class="text-center py-12 bg-white rounded-xl shadow">
                        <p class="text-xl text-gray-500">No providers found matching your filters</p>
                        <p class="text-gray-400 mt-2">Try adjusting your filters</p>
                    </div>
                `;
                document.getElementById('providersSection').classList.remove('hidden');
                return;
            }

            const hrLabel = {'hi':'‡§ò‡§Ç‡§ü‡§æ','bn':'‡¶ò‡¶®‡ßç‡¶ü‡¶æ','gu':'‡™ï‡§≤‡§æ‡§ï','mr':'‡§§‡§æ‡§∏','kn':'‡≤ó‡≤Ç‡≤ü‡≥Ü'}[currentLanguage] || 'hr';
            const yrsLabel = {'hi':'‡§µ‡§∞‡•ç‡§∑','bn':'‡¶¨‡¶õ‡¶∞','gu':'‡™µ‡™∞‡´ç‡™∑','mr':'‡§µ‡§∞‡•ç‡§∑‡•á','kn':'‡≤µ‡≤∞‡≥ç‡≤∑‡≤ó‡≤≥‡≥Å'}[currentLanguage] || 'yrs';

            const grid = document.getElementById('providersGridNew');
            grid.innerHTML = filteredProviders.map(p => {
                const { avg, count } = getAvgRating(p);
                const waNum = p.whatsapp || p.mobile;
                const waMsg = encodeURIComponent(`Hi ${p.name}, I found you on Sudarshan Chakra. I need your ${p.service} service. Can we discuss?`);
                const distText = (p.distance !== undefined && p.distance < 100) ? p.distance.toFixed(1) + ' km away' : p.location;
                const stars = '‚òÖ'.repeat(Math.round(avg)) + '‚òÜ'.repeat(5 - Math.round(avg));

                return `
                <div class="bg-white rounded-2xl shadow-md hover:shadow-xl transition-all duration-300 overflow-hidden border border-gray-100">
                    <div class="flex items-start gap-4 p-5 pb-3">
                        <div class="w-16 h-16 rounded-full overflow-hidden flex-shrink-0 shadow-md border-2 border-orange-200 cursor-pointer" onclick="openProviderProfile('${p.id}')">
                            ${getProviderAvatar(p)}
                        </div>
                        <div class="flex-1 min-w-0">
                            <div class="flex items-center gap-2 flex-wrap">
                                <h3 class="text-lg font-bold text-gray-800 cursor-pointer hover:text-orange-600 transition" onclick="openProviderProfile('${p.id}')">${p.name}</h3>
                                ${getVerifiedBadge(p)}
                            </div>
                            <div class="text-orange-600 font-medium text-sm">${p.service}</div>
                            ${p.language ? `<div class="text-xs text-gray-500 mt-0.5">üó£Ô∏è ${p.language}${p.workingHours ? ' &nbsp;|&nbsp; ' + getWorkingHoursLabel(p.workingHours) : ''}</div>` : ''}
                        </div>
                        <div class="text-right flex-shrink-0">
                            <div class="text-yellow-400 text-base leading-none">${stars}</div>
                            <div class="text-sm font-bold text-gray-700">${avg.toFixed(1)}</div>
                            <div class="text-xs text-gray-400">${count} review${count !== 1 ? 's' : ''}</div>
                        </div>
                    </div>
                    ${p.bio ? `<div class="px-5 pb-2 text-sm text-gray-500 italic line-clamp-2">"${p.bio}"</div>` : ''}
                    <div class="px-5 pb-3 grid grid-cols-3 gap-2 text-xs text-gray-600 border-t border-gray-50 pt-3">
                        <div class="flex items-center gap-1"><span>üìç</span><span class="truncate">${distText}</span></div>
                        <div class="flex items-center gap-1"><span>üïê</span><span>${p.experience} ${yrsLabel}</span></div>
                        <div class="flex items-center gap-1"><span>üí∞</span><span class="font-semibold text-gray-800">‚Çπ${p.rate}/${hrLabel}</span></div>
                    </div>
                    <div class="px-4 pb-4 grid grid-cols-2 gap-2">
                        <a href="tel:${p.mobile}" class="bg-green-600 text-white text-center py-2.5 rounded-xl hover:bg-green-700 font-medium text-sm transition" style="text-decoration:none;">üìû Call</a>
                        <a href="https://wa.me/91${waNum}?text=${waMsg}" target="_blank" class="bg-green-500 text-white text-center py-2.5 rounded-xl hover:bg-green-600 font-medium text-sm transition" style="text-decoration:none;">üí¨ WhatsApp</a>
                        ${p.lat && p.lng ? `<a href="https://www.google.com/maps/dir/?api=1&destination=${p.lat},${p.lng}" target="_blank" class="bg-blue-600 text-white text-center py-2.5 rounded-xl hover:bg-blue-700 font-medium text-sm transition" style="text-decoration:none;">üó∫Ô∏è Directions</a>` : '<div></div>'}
                        <button onclick="openReviewModal('${p.id}')" class="bg-orange-50 text-orange-700 text-center py-2.5 rounded-xl hover:bg-orange-100 font-medium text-sm transition border border-orange-200">‚≠ê Review</button>
                        <button onclick="toggleFavourite('${p.id}')" id="fav-${p.id}" class="py-2.5 px-2 rounded-xl text-sm transition border bg-gray-50 text-gray-500 border-gray-200 hover:bg-red-50 hover:text-red-500">ü§ç</button>
                        <button onclick="openReportModal('${p.id}','provider','${p.name}')" class="py-2.5 px-2 rounded-xl text-sm transition border bg-gray-50 text-gray-400 border-gray-200 hover:bg-red-50 hover:text-red-500" title="Report">üö®</button>
                    </div>
                </div>`;
            }).join('');

            document.getElementById('providersSection').classList.remove('hidden');
        }

                function getWorkingHoursLabel(hours) {
            const labels = {
                'mon-fri': 'üìÖ Mon-Fri',
                'weekends': 'üìÖ Weekends',
                'all-days': 'üìÖ All Days',
                '24x7': '‚è∞ 24√ó7'
            };
            return labels[hours] || hours;
        }
        
        // ==================== PHASE C: VOICE SEARCH ====================
        let recognition = null;
        let recognitionTimeout = null;
        
        function startVoiceSearch() {
            // Check browser support
            if (!('webkitSpeechRecognition' in window) && !('SpeechRecognition' in window)) {
                alert('Voice search is not supported in your browser. Please use Chrome, Edge, or Safari.');
                return;
            }
            
            // Initialize speech recognition
            const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
            recognition = new SpeechRecognition();
            
            // Configure recognition based on current language
            const langCodes = {
                'en': 'en-IN',
                'hi': 'hi-IN',
                'bn': 'bn-IN',
                'gu': 'gu-IN',
                'mr': 'mr-IN',
                'kn': 'kn-IN'
            };
            recognition.lang = langCodes[currentLanguage] || 'en-IN';
            recognition.continuous = false;
            recognition.interimResults = true; // CHANGED: Enable interim results
            recognition.maxAlternatives = 1;
            
            // Show listening indicator
            document.getElementById('voiceStatus').classList.remove('hidden');
            document.getElementById('voiceStatusText').textContent = t('speak');
            
            // Set timeout to auto-stop after 10 seconds
            recognitionTimeout = setTimeout(() => {
                if (recognition) {
                    recognition.stop();
                    document.getElementById('voiceStatus').classList.add('hidden');
                }
            }, 10000);
            
            recognition.onstart = function() {
                console.log('Speech recognition started');
                document.getElementById('voiceStatusText').textContent = t('listening');
            };
            
            recognition.onspeechstart = function() {
                console.log('Speech detected');
                document.getElementById('voiceStatusText').textContent = t('listening');
            };
            
            recognition.onspeechend = function() {
                console.log('Speech ended');
            };
            
            recognition.onresult = function(event) {
                // Clear the timeout since we got a result
                if (recognitionTimeout) {
                    clearTimeout(recognitionTimeout);
                }
                
                // Get the final transcript
                let transcript = '';
                for (let i = event.resultIndex; i < event.results.length; i++) {
                    if (event.results[i].isFinal) {
                        transcript = event.results[i][0].transcript;
                        break;
                    }
                }
                
                // If no final result yet, use interim
                if (!transcript && event.results.length > 0) {
                    transcript = event.results[event.results.length - 1][0].transcript;
                }
                
                console.log('Voice input:', transcript);
                
                if (transcript.trim()) {
                    document.getElementById('voiceStatusText').textContent = t('searchingFor', { service: transcript });
                    
                    // Process the voice command
                    setTimeout(() => {
                        processVoiceCommand(transcript.toLowerCase());
                    }, 500);
                    
                    // Hide status after 2 seconds
                    setTimeout(() => {
                        document.getElementById('voiceStatus').classList.add('hidden');
                    }, 2000);
                } else {
                    document.getElementById('voiceStatus').classList.add('hidden');
                    alert(t('noSpeechDetected'));
                }
            };
            
            recognition.onerror = function(event) {
                console.error('Speech recognition error:', event.error);
                
                // Clear timeout
                if (recognitionTimeout) {
                    clearTimeout(recognitionTimeout);
                }
                
                document.getElementById('voiceStatus').classList.add('hidden');
                
                if (event.error === 'no-speech') {
                    alert(t('noSpeechDetected'));
                } else if (event.error === 'not-allowed' || event.error === 'permission-denied') {
                    alert('Microphone access denied. Please allow microphone access in your browser settings.');
                } else if (event.error === 'aborted') {
                    // Silent error, likely user cancelled
                    console.log('Recognition aborted');
                } else {
                    alert('Voice recognition error: ' + event.error);
                }
            };
            
            recognition.onend = function() {
                console.log('Speech recognition ended');
                if (recognitionTimeout) {
                    clearTimeout(recognitionTimeout);
                }
            };
            
            // Start listening
            try {
                recognition.start();
                console.log('Recognition started successfully');
            } catch (e) {
                console.error('Error starting recognition:', e);
                document.getElementById('voiceStatus').classList.add('hidden');
                alert('Could not start voice recognition. Please try again.');
            }
        }
        
        function processVoiceCommand(transcript) {
            console.log('Processing command:', transcript);
            
            // Clean up the transcript - remove filler words
            const fillerWords = ['find', 'show', 'get', 'need', 'want', 'search', 'looking for', 'i need', 'get me', 'show me'];
            let cleanedTranscript = transcript.toLowerCase().trim();
            
            // Remove filler words to extract the actual service
            fillerWords.forEach(filler => {
                cleanedTranscript = cleanedTranscript.replace(filler, '').trim();
            });
            
            // Also remove articles
            cleanedTranscript = cleanedTranscript.replace(/\b(a|an|the)\b/g, '').trim();
            
            console.log('Cleaned transcript:', cleanedTranscript);
            
            // Service keywords in multiple languages (expanded list)
            const serviceKeywords = {
                // English - Plumbing
                'plumber': 'Pipe Repair',
                'plumbing': 'Pipe Repair',
                'pipe': 'Pipe Repair',
                'tap': 'Tap Installation',
                'tank': 'Tank Installation',
                'drainage': 'Drainage Cleaning',
                
                // English - Electrical
                'electrician': 'Wiring',
                'electrical': 'Wiring',
                'electricity': 'Wiring',
                'wiring': 'Wiring',
                'wire': 'Wiring',
                'light': 'Light Installation',
                'lights': 'Light Installation',
                'fan': 'Fan Installation',
                'ac': 'AC Installation',
                'air conditioning': 'AC Installation',
                
                // English - Carpentry
                'carpenter': 'Furniture Repair',
                'carpentry': 'Furniture Repair',
                'furniture': 'Furniture Repair',
                'wood': 'Wood Polishing',
                
                // English - Cleaning
                'cleaner': 'House Cleaning',
                'cleaning': 'House Cleaning',
                'clean': 'House Cleaning',
                'maid': 'House Cleaning',
                'housekeeping': 'House Cleaning',
                
                // English - Painting
                'painter': 'Wall Painting',
                'painting': 'Wall Painting',
                'paint': 'Wall Painting',
                
                // English - Other
                'mechanic': 'Car Repair',
                'car': 'Car Repair',
                'vehicle': 'Car Repair',
                
                // Hindi
                '‡§™‡•ç‡§≤‡§Ç‡§¨‡§∞': 'Pipe Repair',
                '‡§®‡§≤': 'Tap Installation',
                '‡§á‡§≤‡•á‡§ï‡•ç‡§ü‡•ç‡§∞‡•Ä‡§∂‡§ø‡§Ø‡§®': 'Wiring',
                '‡§¨‡§¢‡§º‡§à': 'Furniture Repair',
                '‡§∏‡§´‡§æ‡§à': 'House Cleaning',
                '‡§™‡•á‡§Ç‡§ü‡§∞': 'Wall Painting'
            };
            
            // Find matching service - first try the cleaned transcript
            let matchedService = null;
            let matchedCategory = null;
            let matchedSubcategory = null;
            
            // Try both original and cleaned transcript
            const transcriptsToTry = [cleanedTranscript, transcript];
            
            for (const testTranscript of transcriptsToTry) {
                // Try to match keywords
                for (const keyword in serviceKeywords) {
                    // Check if keyword is in the transcript (exact match or contains)
                    if (testTranscript === keyword || testTranscript.includes(keyword)) {
                        const targetServiceName = serviceKeywords[keyword];
                        console.log('Matched keyword:', keyword, 'Target service:', targetServiceName);
                        
                        // Search through categories for this exact service
                        outerLoop: for (const cat of categories) {
                            for (let subIdx = 0; subIdx < cat.subcategories.length; subIdx++) {
                                const sub = cat.subcategories[subIdx];
                                for (let serviceIdx = 0; serviceIdx < sub.subsubcategories.length; serviceIdx++) {
                                    const service = sub.subsubcategories[serviceIdx];
                                    const serviceNameEn = service.name.en || service.name;
                                    
                                    console.log('Checking service:', serviceNameEn, 'vs target:', targetServiceName);
                                    
                                    // Exact match or contains check
                                    if (serviceNameEn === targetServiceName || serviceNameEn.includes(targetServiceName) || targetServiceName.includes(serviceNameEn)) {
                                        matchedCategory = cat.id;
                                        matchedSubcategory = subIdx;
                                        matchedService = serviceIdx;
                                        console.log('‚úÖ MATCHED! Category:', cat.id, 'Sub:', subIdx, 'Service:', serviceIdx, 'Name:', serviceNameEn);
                                        break outerLoop;
                                    }
                                }
                            }
                        }
                        
                        if (matchedService !== null) break;
                    }
                }
                
                if (matchedService !== null) break;
            }
            
            // If service found, navigate to browse and show results
            if (matchedService !== null) {
                console.log('üéØ Final navigation:', matchedCategory, matchedSubcategory, matchedService);
                
                // Navigate programmatically to the service
                navigateToService(matchedCategory, matchedSubcategory, matchedService);
            } else {
                // If no match found, provide helpful error
                console.log('No service matched for:', transcript, '(cleaned:', cleanedTranscript + ')');
                
                // Show helpful message with examples
                const exampleServices = ['plumber', 'electrician', 'carpenter', 'cleaner', 'painter'];
                const randomExample = exampleServices[Math.floor(Math.random() * exampleServices.length)];
                
                alert(`Could not find "${transcript}". \n\nTry saying just the service name:\n‚Ä¢ "${randomExample}"\n‚Ä¢ "find a ${randomExample}"\n‚Ä¢ "show ${randomExample}"`);
                showPage('browse');
            }
        }
        
        // ==================== PROGRAMMATIC NAVIGATION FOR VOICE ====================
        function navigateToService(catId, subIdx, serviceIdx) {
            // Set the selected values
            selectedCategoryId = catId;
            selectedSubcategoryIdx = subIdx;
            selectedServiceIdx = serviceIdx;
            
            // Navigate to browse page
            showPage('browse');
            
            // Wait for page to load, then populate everything
            setTimeout(() => {
                // Load browse categories first
                loadBrowseCategories();
                
                // Find and display the category
                const category = categories.find(c => c.id === catId);
                if (!category) {
                    console.error('Category not found:', catId);
                    return;
                }
                
                // Show subcategories
                const subcatGrid = document.getElementById('browseSubcategoriesGrid');
                subcatGrid.innerHTML = category.subcategories.map((sub, idx) => `
                    <div class="category-card bg-white p-6 rounded-xl shadow-md text-center ${idx === subIdx ? 'ring-4 ring-orange-500' : ''}" onclick="selectSubcategory(${idx})">
                        <div class="text-4xl mb-3">${sub.icon}</div>
                        <div class="font-bold text-gray-800">${getTranslated(sub.name)}</div>
                    </div>
                `).join('');
                document.getElementById('subcategorySection').classList.remove('hidden');
                
                // Show services
                const subcategory = category.subcategories[subIdx];
                const serviceGrid = document.getElementById('browseServicesGrid');
                serviceGrid.innerHTML = subcategory.subsubcategories.map((service, idx) => `
                    <div class="category-card bg-white p-6 rounded-xl shadow-md text-center ${idx === serviceIdx ? 'ring-4 ring-orange-500' : ''}" onclick="selectService(${idx})">
                        <div class="text-4xl mb-3">${service.icon}</div>
                        <div class="font-bold text-gray-800">${getTranslated(service.name)}</div>
                    </div>
                `).join('');
                document.getElementById('serviceSection').classList.remove('hidden');
                
                // Load providers immediately
                setTimeout(() => {
                    console.log('Voice navigation: Loading providers for service');
                    applySortAndFilter();
                    
                    // Scroll to providers section
                    setTimeout(() => {
                        const providersSection = document.getElementById('providersSection');
                        if (providersSection && !providersSection.classList.contains('hidden')) {
                            providersSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
                        }
                    }, 300);
                }, 200);
            }, 300);
        }
        
        function getDirections(lat, lng) {
            window.open(`https://www.google.com/maps/dir/?api=1&destination=${lat},${lng}`, '_blank');
        }
        
        // ==================== HOME PAGE ====================
        function loadHomeCategories() {
            const grid = document.getElementById('categoriesGridHome');
            grid.innerHTML = categories.map(cat => `
                <div class="bg-white p-6 rounded-xl shadow-md text-center hover:shadow-lg transition cursor-pointer" onclick="goToBrowse('${cat.id}')">
                    <div class="text-4xl mb-2">${cat.icon}</div>
                    <div class="font-semibold">${getTranslated(cat.name)}</div>
                </div>
            `).join('');
        }
        
        function goToBrowse(catId) {
            showPage('browse');
            setTimeout(() => selectCategory(catId), 100);
        }
        
        // ==================== MAPS ====================
        function initRegisterMap() {
            if (maps.register) return;
            
            maps.register = L.map('registerMap').setView([20.5937, 78.9629], 5);
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(maps.register);
            
            const marker = L.marker([20.5937, 78.9629], { draggable: true }).addTo(maps.register);
            
            marker.on('dragend', function(e) {
                const pos = e.target.getLatLng();
                document.getElementById('providerLat').value = pos.lat;
                document.getElementById('providerLng').value = pos.lng;
            });
            
            maps.register.on('click', function(e) {
                marker.setLatLng(e.latlng);
                document.getElementById('providerLat').value = e.latlng.lat;
                document.getElementById('providerLng').value = e.latlng.lng;
            });
            
            document.getElementById('providerLat').value = 20.5937;
            document.getElementById('providerLng').value = 78.9629;
        }
        
        function initSeekerMap() {
            if (maps.seeker) return;
            
            maps.seeker = L.map('seekerMap').setView([20.5937, 78.9629], 5);
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(maps.seeker);
            
            const marker = L.marker([20.5937, 78.9629], { draggable: true }).addTo(maps.seeker);
            
            marker.on('dragend', function(e) {
                const pos = e.target.getLatLng();
                document.getElementById('seekerLat').value = pos.lat;
                document.getElementById('seekerLng').value = pos.lng;
            });
            
            maps.seeker.on('click', function(e) {
                marker.setLatLng(e.latlng);
                document.getElementById('seekerLat').value = e.latlng.lat;
                document.getElementById('seekerLng').value = e.latlng.lng;
            });
            
            document.getElementById('seekerLat').value = 20.5937;
            document.getElementById('seekerLng').value = 78.9629;
        }
        
        function initMainMap() {
            if (maps.main) maps.main.remove();
            
            maps.main = L.map('mainMap').setView([20.5937, 78.9629], 5);
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(maps.main);
            
            providers.forEach(p => {
                if (p.lat && p.lng) {
                    const icon = L.divIcon({ html: '<div style="font-size: 30px;">üîß</div>', className: '', iconSize: [30, 30] });
                    const marker = L.marker([p.lat, p.lng], { icon }).addTo(maps.main);
                    marker.bindPopup(`<strong>${p.name}</strong><br>${p.service}<br>‚Çπ${p.rate}/hr`);
                }
            });
        }
        
        // ==================== CATEGORY SELECTS ====================
        function updateProviderCategorySelects() {
            const select = document.getElementById('providerCategory');
            if (select) {
                select.innerHTML = '<option value="">Select Category</option>' + 
                    categories.map(cat => `<option value="${cat.id}">${getTranslated(cat.name)}</option>`).join('');
            }
        }
        
        function updateProviderSubcategories() {
            const catId = document.getElementById('providerCategory').value;
            const subSelect = document.getElementById('providerSubcategory');
            const category = categories.find(c => c.id === catId);
            
            if (category && category.subcategories) {
                subSelect.innerHTML = '<option value="">Select Subcategory</option>' + 
                    category.subcategories.map((sub, idx) => `<option value="${idx}">${getTranslated(sub.name)}</option>`).join('');
            } else {
                subSelect.innerHTML = '<option value="">Select Subcategory</option>';
            }
            document.getElementById('providerSubSubcategory').innerHTML = '<option value="">Select Service Type</option>';
        }
        
        function updateProviderSubSubcategories() {
            const catId = document.getElementById('providerCategory').value;
            const subIdx = document.getElementById('providerSubcategory').value;
            const subSubSelect = document.getElementById('providerSubSubcategory');
            
            const category = categories.find(c => c.id === catId);
            if (category && category.subcategories && category.subcategories[subIdx] && category.subcategories[subIdx].subsubcategories) {
                subSubSelect.innerHTML = '<option value="">Select Service Type</option>' + 
                    category.subcategories[subIdx].subsubcategories.map((subsub, idx) => 
                        `<option value="${idx}">${getTranslated(subsub.name)}</option>`
                    ).join('');
            } else {
                subSubSelect.innerHTML = '<option value="">Select Service Type</option>';
            }
        }
        
        // ==================== FORM SUBMISSIONS ====================
        document.getElementById('providerForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const catId = document.getElementById('providerCategory').value;
            const subIdx = document.getElementById('providerSubcategory').value;
            const subSubIdx = document.getElementById('providerSubSubcategory').value;
            
            // Service is now optional - provider can register without it
            let serviceName = 'General Service Provider';
            if (catId && subIdx && subSubIdx) {
                const category = categories.find(c => c.id === catId);
                const subcategory = category?.subcategories[subIdx];
                const subsubcategory = subcategory?.subsubcategories[subSubIdx];
                serviceName = getTranslated(subsubcategory?.name) || serviceName;
            }
            
            // PHASE E: get photo as base64
            const photoDataUrl = document.getElementById('photoPreview')?.src || null;
            const photoToSave = (photoDataUrl && !document.getElementById('photoPreview').classList.contains('hidden')) ? photoDataUrl : null;

            const provider = {
                id: 'p_' + Date.now(),
                name: document.getElementById('providerName').value,
                mobile: document.getElementById('providerMobile').value,
                whatsapp: document.getElementById('providerWhatsapp').value || null, // PHASE E
                bio: document.getElementById('providerBio').value.trim() || null,    // PHASE E
                photo: photoToSave,                                                   // PHASE E
                verified: false,                                                      // PHASE E (admin sets this)
                categoryId: catId || null,
                subcategoryIdx: subIdx || null,
                subsubcategoryIdx: subSubIdx || null,
                service: serviceName,
                religion: document.getElementById('providerReligion').value,
                language: document.getElementById('providerLanguage').value,
                experience: parseInt(document.getElementById('providerExperience').value),
                rate: parseInt(document.getElementById('providerRate').value),
                workingHours: document.querySelector('input[name="workingHours"]:checked')?.value || 'mon-fri',
                serviceArea: document.querySelector('input[name="serviceArea"]:checked')?.value || '10km',
                location: document.getElementById('providerLocation').value,
                lat: parseFloat(document.getElementById('providerLat').value),
                lng: parseFloat(document.getElementById('providerLng').value),
                rating: 4.0 + Math.random() * 0.5,
                reviews: {},
                ownerUid: firebaseUser?.uid || null,
                status: 'active',
                registered: new Date().toISOString()
            };
            
            // Show loading state
            const submitBtn = document.getElementById('providerForm').querySelector('button[type="submit"]');
            if (submitBtn) { submitBtn.disabled = true; submitBtn.textContent = '‚è≥ Saving...'; }
            
            saveProviderToFirebase(provider).then(success => {
                if (submitBtn) { submitBtn.disabled = false; submitBtn.textContent = t('registerNow') || 'Register Now'; }
                
                if (success) {
                    document.getElementById('providerSuccess').classList.remove('hidden');
                    document.getElementById('providerForm').reset();
                    // Reset photo preview
                    document.getElementById('photoPreview').classList.add('hidden');
                    document.getElementById('photoPlaceholder').classList.remove('hidden');
                    showFirebaseStatus('‚úÖ Provider registered successfully!', 'success');
                    
                    setTimeout(() => {
                        document.getElementById('providerSuccess').classList.add('hidden');
                        showPage('browse');
                    }, 2000);
                } else {
                    alert('‚ùå Could not save to database. Please check your internet connection and try again.');
                }
            });
        });
        
        document.getElementById('seekerForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const seeker = {
                id: 's_' + Date.now(),
                name: document.getElementById('seekerName').value,
                mobile: document.getElementById('seekerMobile').value,
                religion: document.getElementById('seekerReligion').value,
                location: document.getElementById('seekerLocation').value,
                lat: parseFloat(document.getElementById('seekerLat').value),
                lng: parseFloat(document.getElementById('seekerLng').value),
                status: 'active', // active, paused, restricted
                registered: new Date().toISOString()
            };
            
            const submitBtnS = document.getElementById('seekerForm').querySelector('button[type="submit"]');
            if (submitBtnS) { submitBtnS.disabled = true; submitBtnS.textContent = '‚è≥ Saving...'; }
            
            saveSeekerToFirebase(seeker).then(success => {
                if (submitBtnS) { submitBtnS.disabled = false; submitBtnS.textContent = t('registerNow') || 'Register Now'; }
                
                if (success) {
                    currentUser = seeker;
                    localStorage.setItem('currentUser', JSON.stringify(currentUser));
                    
                    document.getElementById('seekerSuccess').classList.remove('hidden');
                    document.getElementById('seekerForm').reset();
                    showFirebaseStatus('‚úÖ Seeker registered successfully!', 'success');
                    
                    setTimeout(() => {
                        document.getElementById('seekerSuccess').classList.add('hidden');
                        showPage('browse');
                    }, 2000);
                } else {
                    alert('‚ùå Could not save to database. Please check your internet connection and try again.');
                }
            });
        });
        
        // ==================== ADMIN ====================
        let currentEditCategoryIdx = null;
        let currentEditSubcategoryIdx = null;
        let currentEditServiceIdx = null;
        let modalMode = 'add';
        
        function adminLogin() {
            const password = document.getElementById('adminPassword').value;
            if (password === ADMIN_PASSWORD) {
                document.getElementById('adminLogin').classList.add('hidden');
                document.getElementById('adminDashboard').classList.remove('hidden');
                updateAdminStats();
                showAdminTab('categories'); // Default tab
            } else {
                alert('Incorrect password!');
            }
        }
        
        function adminLogout() {
            document.getElementById('adminLogin').classList.remove('hidden');
            document.getElementById('adminDashboard').classList.add('hidden');
            document.getElementById('adminPassword').value = '';
        }
        
        function showAdminTab(tabName) {
            ['users','reports','categories'].forEach(t => {
                document.getElementById('adminTab-' + t).classList.add('hidden');
                document.getElementById('tab-' + t).classList.remove('border-orange-600','text-orange-600');
            });
            document.getElementById('adminTab-' + tabName).classList.remove('hidden');
            document.getElementById('tab-' + tabName).classList.add('border-orange-600','text-orange-600');
            if (tabName === 'users') { loadProvidersList(); loadSeekersList(); }
            else if (tabName === 'categories') { loadAdminCategories(); }
            else if (tabName === 'reports') { loadAdminReports(); }
        }
        
        function updateAdminStats() {
            const restrictedCount = providers.filter(p => p.status === 'restricted').length + 
                                   seekers.filter(s => s.status === 'restricted').length;
            
            const totalReviews = providers.reduce((sum, p) => sum + (p.reviews ? Object.keys(p.reviews).length : 0), 0);
            document.getElementById('totalProviders').textContent = providers.length;
            document.getElementById('totalSeekers').textContent = seekers.length;
            document.getElementById('totalCategories').textContent = categories.length;
            document.getElementById('totalRestricted').textContent = restrictedCount;
            if (document.getElementById('totalReviews')) document.getElementById('totalReviews').textContent = totalReviews;
        }
        
        // ==================== PROVIDER MANAGEMENT ====================
        function loadProvidersList() {
            const list = document.getElementById('providersListAdmin');
            if (!list) return;
            
            if (providers.length === 0) {
                list.innerHTML = '<div class="text-center py-8 text-gray-500">No providers registered yet</div>';
                return;
            }
            
            renderProvidersList(providers);
        }
        
        function renderProvidersList(providersList) {
            const list = document.getElementById('providersListAdmin');
            
            list.innerHTML = providersList.map(p => {
                const statusColor = {
                    'active': 'bg-green-100 text-green-800',
                    'paused': 'bg-yellow-100 text-yellow-800',
                    'restricted': 'bg-red-100 text-red-800'
                };
                const status = p.status || 'active';
                
                return `
                    <div class="border rounded-lg p-4 ${status === 'restricted' ? 'bg-red-50 border-red-200' : status === 'paused' ? 'bg-yellow-50 border-yellow-200' : 'bg-white'}">
                        <div class="flex justify-between items-start">
                            <div class="flex-1">
                                <div class="flex items-center gap-3 mb-2">
                                    <h3 class="font-bold text-lg">${p.name}</h3>
                                    <span class="px-3 py-1 rounded-full text-xs font-semibold ${statusColor[status]}">${status.toUpperCase()}</span>
                                </div>
                                <div class="grid md:grid-cols-2 gap-2 text-sm text-gray-600">
                                    <div>üìû ${p.mobile}</div>
                                    <div>üîß ${p.service}</div>
                                    <div>üìç ${p.location}</div>
                                    <div>‚≠ê ${(p.rating || 4.0).toFixed(1)} | üïê ${p.experience} yrs | üí∞ ‚Çπ${p.rate}/hr</div>
                                    <div>${religionIcons[p.religion] || 'üôè'} ${p.religion}</div>
                                    <div>üìÖ ${new Date(p.registered).toLocaleDateString()}</div>
                                </div>
                            </div>
                            <div class="flex gap-2 ml-4">
                                ${status === 'active' ? `
                                    <button onclick="pauseProvider('${p.id}')" class="bg-yellow-500 text-white px-3 py-1 rounded hover:bg-yellow-600 text-sm" title="Pause">‚è∏Ô∏è Pause</button>
                                    <button onclick="restrictProvider('${p.id}')" class="bg-red-500 text-white px-3 py-1 rounded hover:bg-red-600 text-sm" title="Restrict">üö´ Restrict</button>
                                ` : ''}
                                ${status === 'paused' ? `
                                    <button onclick="activateProvider('${p.id}')" class="bg-green-500 text-white px-3 py-1 rounded hover:bg-green-600 text-sm" title="Activate">‚ñ∂Ô∏è Activate</button>
                                    <button onclick="restrictProvider('${p.id}')" class="bg-red-500 text-white px-3 py-1 rounded hover:bg-red-600 text-sm" title="Restrict">üö´ Restrict</button>
                                ` : ''}
                                ${status === 'restricted' ? `
                                    <button onclick="activateProvider('${p.id}')" class="bg-green-500 text-white px-3 py-1 rounded hover:bg-green-600 text-sm" title="Activate">‚úÖ Activate</button>
                                ` : ''}
                                <button onclick="toggleVerified('${p.id}', ${!!p.verified})" class="bg-blue-500 text-white px-3 py-1 rounded hover:bg-blue-600 text-sm" title="Toggle Verified">${p.verified ? '‚úÖ Verified' : '‚òëÔ∏è Verify'}</button>
                                <button onclick="deleteProvider('${p.id}')" class="bg-gray-700 text-white px-3 py-1 rounded hover:bg-gray-800 text-sm" title="Delete">üóëÔ∏è Delete</button>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }
        
        function filterProvidersList() {
            const search = document.getElementById('searchProviders').value.toLowerCase();
            const filtered = providers.filter(p => 
                p.name.toLowerCase().includes(search) ||
                p.mobile.includes(search) ||
                p.service.toLowerCase().includes(search) ||
                p.location.toLowerCase().includes(search)
            );
            renderProvidersList(filtered);
        }
        
        function pauseProvider(providerId) {
            if (confirm('‚è∏Ô∏è Pause this provider? They will not appear in search results until reactivated.')) {
                updateProviderInFirebase(providerId, { status: 'paused' }).then(success => {
                    if (success) showFirebaseStatus('Provider paused', 'success');
                });
            }
        }
        
        function restrictProvider(providerId) {
            if (confirm('üö´ Restrict this provider? They will be blocked from the platform.')) {
                updateProviderInFirebase(providerId, { status: 'restricted' }).then(success => {
                    if (success) showFirebaseStatus('Provider restricted', 'success');
                });
            }
        }
        
        function activateProvider(providerId) {
            updateProviderInFirebase(providerId, { status: 'active' }).then(success => {
                if (success) showFirebaseStatus('Provider activated', 'success');
            });
        }
        
        function deleteProvider(providerId) {
            if (confirm('üóëÔ∏è PERMANENTLY DELETE this provider? This action cannot be undone!')) {
                deleteProviderFromFirebase(providerId).then(success => {
                    if (success) showFirebaseStatus('Provider deleted', 'success');
                });
            }
        }
        
        // ==================== SEEKER MANAGEMENT ====================
        function loadSeekersList() {
            const list = document.getElementById('seekersListAdmin');
            if (!list) return;
            
            if (seekers.length === 0) {
                list.innerHTML = '<div class="text-center py-8 text-gray-500">No seekers registered yet</div>';
                return;
            }
            
            renderSeekersList(seekers);
        }
        
        function renderSeekersList(seekersList) {
            const list = document.getElementById('seekersListAdmin');
            
            list.innerHTML = seekersList.map(s => {
                const statusColor = {
                    'active': 'bg-green-100 text-green-800',
                    'paused': 'bg-yellow-100 text-yellow-800',
                    'restricted': 'bg-red-100 text-red-800'
                };
                const status = s.status || 'active';
                
                return `
                    <div class="border rounded-lg p-4 ${status === 'restricted' ? 'bg-red-50 border-red-200' : status === 'paused' ? 'bg-yellow-50 border-yellow-200' : 'bg-white'}">
                        <div class="flex justify-between items-start">
                            <div class="flex-1">
                                <div class="flex items-center gap-3 mb-2">
                                    <h3 class="font-bold text-lg">${s.name}</h3>
                                    <span class="px-3 py-1 rounded-full text-xs font-semibold ${statusColor[status]}">${status.toUpperCase()}</span>
                                </div>
                                <div class="grid md:grid-cols-2 gap-2 text-sm text-gray-600">
                                    <div>üìû ${s.mobile}</div>
                                    <div>üìç ${s.location}</div>
                                    <div>${religionIcons[s.religion] || 'üôè'} ${s.religion}</div>
                                    <div>üìÖ ${new Date(s.registered).toLocaleDateString()}</div>
                                </div>
                            </div>
                            <div class="flex gap-2 ml-4">
                                ${status === 'active' ? `
                                    <button onclick="pauseSeeker('${s.id}')" class="bg-yellow-500 text-white px-3 py-1 rounded hover:bg-yellow-600 text-sm" title="Pause">‚è∏Ô∏è Pause</button>
                                    <button onclick="restrictSeeker('${s.id}')" class="bg-red-500 text-white px-3 py-1 rounded hover:bg-red-600 text-sm" title="Restrict">üö´ Restrict</button>
                                ` : ''}
                                ${status === 'paused' ? `
                                    <button onclick="activateSeeker('${s.id}')" class="bg-green-500 text-white px-3 py-1 rounded hover:bg-green-600 text-sm" title="Activate">‚ñ∂Ô∏è Activate</button>
                                    <button onclick="restrictSeeker('${s.id}')" class="bg-red-500 text-white px-3 py-1 rounded hover:bg-red-600 text-sm" title="Restrict">üö´ Restrict</button>
                                ` : ''}
                                ${status === 'restricted' ? `
                                    <button onclick="activateSeeker('${s.id}')" class="bg-green-500 text-white px-3 py-1 rounded hover:bg-green-600 text-sm" title="Activate">‚úÖ Activate</button>
                                ` : ''}
                                <button onclick="deleteSeeker('${s.id}')" class="bg-gray-700 text-white px-3 py-1 rounded hover:bg-gray-800 text-sm" title="Delete">üóëÔ∏è Delete</button>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }
        
        function filterSeekersList() {
            const search = document.getElementById('searchSeekers').value.toLowerCase();
            const filtered = seekers.filter(s => 
                s.name.toLowerCase().includes(search) ||
                s.mobile.includes(search) ||
                s.location.toLowerCase().includes(search)
            );
            renderSeekersList(filtered);
        }
        
        function pauseSeeker(seekerId) {
            if (confirm('‚è∏Ô∏è Pause this seeker? They will not be able to use the platform until reactivated.')) {
                updateSeekerInFirebase(seekerId, { status: 'paused' }).then(success => {
                    if (success) showFirebaseStatus('Seeker paused', 'success');
                });
            }
        }
        
        function restrictSeeker(seekerId) {
            if (confirm('üö´ Restrict this seeker? They will be blocked from the platform.')) {
                updateSeekerInFirebase(seekerId, { status: 'restricted' }).then(success => {
                    if (success) showFirebaseStatus('Seeker restricted', 'success');
                });
            }
        }
        
        function activateSeeker(seekerId) {
            updateSeekerInFirebase(seekerId, { status: 'active' }).then(success => {
                if (success) showFirebaseStatus('Seeker activated', 'success');
            });
        }
        
        function deleteSeeker(seekerId) {
            if (confirm('üóëÔ∏è PERMANENTLY DELETE this seeker? This action cannot be undone!')) {
                deleteSeekerFromFirebase(seekerId).then(success => {
                    if (success) showFirebaseStatus('Seeker deleted', 'success');
                });
            }
        }
        
        function loadAdminCategories() {
            const list = document.getElementById('categoriesListAdmin');
            if (!list) return;
            
            if (categories.length === 0) {
                list.innerHTML = '<div class="text-center py-12 text-gray-500"><p class="text-lg">No categories yet. Click "Add New Category" to get started!</p></div>';
                return;
            }
            
            list.innerHTML = categories.map((cat, catIdx) => `
                <div class="border-2 border-gray-200 rounded-xl p-4 hover:border-orange-300 transition">
                    <div class="flex items-center justify-between bg-orange-50 p-4 rounded-lg mb-3">
                        <div class="flex items-center gap-3">
                            <span class="text-4xl">${cat.icon}</span>
                            <div>
                                <h3 class="text-xl font-bold text-gray-800">${cat.name.en || cat.name}</h3>
                                <p class="text-sm text-gray-500">${(cat.subcategories || []).length} subcategories</p>
                            </div>
                        </div>
                        <div class="flex gap-2">
                            <button onclick="editCategory(${catIdx})" class="bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600 font-medium">‚úèÔ∏è Edit</button>
                            <button onclick="showAddSubcategoryModal(${catIdx})" class="bg-green-500 text-white px-4 py-2 rounded-lg hover:bg-green-600 font-medium">‚ûï Add Subcategory</button>
                            <button onclick="deleteCategory(${catIdx})" class="bg-red-500 text-white px-4 py-2 rounded-lg hover:bg-red-600 font-medium">üóëÔ∏è Delete</button>
                        </div>
                    </div>
                    
                    <div class="ml-8 space-y-3">
                        ${(cat.subcategories || []).map((sub, subIdx) => `
                            <div class="border-l-4 border-blue-400 bg-blue-50 p-3 rounded-r-lg">
                                <div class="flex items-center justify-between mb-2">
                                    <div class="flex items-center gap-2">
                                        <span class="text-2xl">${sub.icon}</span>
                                        <div>
                                            <h4 class="font-bold text-gray-800">${sub.name.en || sub.name}</h4>
                                            <p class="text-xs text-gray-500">${(sub.subsubcategories || []).length} services</p>
                                        </div>
                                    </div>
                                    <div class="flex gap-2">
                                        <button onclick="editSubcategory(${catIdx}, ${subIdx})" class="bg-blue-400 text-white px-3 py-1 rounded hover:bg-blue-500 text-sm">‚úèÔ∏è Edit</button>
                                        <button onclick="showAddServiceModal(${catIdx}, ${subIdx})" class="bg-green-400 text-white px-3 py-1 rounded hover:bg-green-500 text-sm">‚ûï Add Service</button>
                                        <button onclick="deleteSubcategory(${catIdx}, ${subIdx})" class="bg-red-400 text-white px-3 py-1 rounded hover:bg-red-500 text-sm">üóëÔ∏è</button>
                                    </div>
                                </div>
                                
                                <div class="ml-6 space-y-1">
                                    ${(sub.subsubcategories || []).map((service, serviceIdx) => `
                                        <div class="flex items-center justify-between bg-white p-2 rounded hover:bg-gray-50">
                                            <div class="flex items-center gap-2">
                                                <span class="text-lg">${service.icon}</span>
                                                <span class="text-sm text-gray-700">${service.name.en || service.name}</span>
                                            </div>
                                            <div class="flex gap-1">
                                                <button onclick="editService(${catIdx}, ${subIdx}, ${serviceIdx})" class="bg-blue-300 text-white px-2 py-1 rounded hover:bg-blue-400 text-xs">‚úèÔ∏è</button>
                                                <button onclick="deleteService(${catIdx}, ${subIdx}, ${serviceIdx})" class="bg-red-300 text-white px-2 py-1 rounded hover:bg-red-400 text-xs">üóëÔ∏è</button>
                                            </div>
                                        </div>
                                    `).join('')}
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `).join('');
        }
        
        function resetToDefaults() {
            if (confirm('‚ö†Ô∏è This will delete all categories and restore defaults. Continue?')) {
                categories = [
                    {
                        id: 'cat1',
                        name: { en: 'Home Services' },
                        icon: 'üè†',
                        subcategories: [
                            {
                                name: { en: 'Plumbing' },
                                icon: 'üîß',
                                subsubcategories: [
                                    { name: { en: 'Pipe Repair' }, icon: 'üîß' },
                                    { name: { en: 'Tank Installation' }, icon: 'üíß' },
                                    { name: { en: 'Bathroom Fitting' }, icon: 'üöø' }
                                ]
                            },
                            {
                                name: { en: 'Electrical' },
                                icon: '‚ö°',
                                subsubcategories: [
                                    { name: { en: 'Wiring' }, icon: 'üîå' },
                                    { name: { en: 'Appliance Repair' }, icon: 'üîß' }
                                ]
                            }
                        ]
                    }
                ];
                localStorage.setItem('categories', JSON.stringify(categories));
                loadAdminCategories();
                updateAdminStats();
                updateProviderCategorySelects();
                alert('‚úÖ Categories reset to defaults!');
            }
        }
        
        // Category Modal Functions
        function showAddCategoryModal() {
            modalMode = 'add';
            currentEditCategoryIdx = null;
            document.getElementById('categoryModalTitle').textContent = 'Add New Category';
            document.getElementById('modalCategoryName').value = '';
            document.getElementById('modalCategoryIcon').value = '';
            document.getElementById('categoryModal').classList.remove('hidden');
        }
        
        function editCategory(catIdx) {
            modalMode = 'edit';
            currentEditCategoryIdx = catIdx;
            const cat = categories[catIdx];
            document.getElementById('categoryModalTitle').textContent = 'Edit Category';
            document.getElementById('modalCategoryName').value = cat.name.en || cat.name;
            document.getElementById('modalCategoryIcon').value = cat.icon;
            document.getElementById('categoryModal').classList.remove('hidden');
        }
        
        function saveCategoryModal() {
            const name = document.getElementById('modalCategoryName').value.trim();
            const icon = document.getElementById('modalCategoryIcon').value.trim();
            
            if (!name || !icon) {
                alert('Please fill in both fields');
                return;
            }
            
            if (modalMode === 'add') {
                categories.push({
                    id: 'cat' + Date.now(),
                    name: { en: name },
                    icon: icon,
                    subcategories: []
                });
            } else {
                if (typeof categories[currentEditCategoryIdx].name === 'string') {
                    categories[currentEditCategoryIdx].name = { en: name };
                } else {
                    categories[currentEditCategoryIdx].name.en = name;
                }
                categories[currentEditCategoryIdx].icon = icon;
            }
            
            localStorage.setItem('categories', JSON.stringify(categories));
            loadAdminCategories();
            updateAdminStats();
            updateProviderCategorySelects();
            closeCategoryModal();
        }
        
        function closeCategoryModal() {
            document.getElementById('categoryModal').classList.add('hidden');
        }
        
        function deleteCategory(catIdx) {
            if (confirm('‚ö†Ô∏è Delete this entire category including all subcategories and services?')) {
                categories.splice(catIdx, 1);
                localStorage.setItem('categories', JSON.stringify(categories));
                loadAdminCategories();
                updateAdminStats();
                updateProviderCategorySelects();
            }
        }
        
        // Subcategory Modal Functions
        function showAddSubcategoryModal(catIdx) {
            modalMode = 'add';
            currentEditCategoryIdx = catIdx;
            currentEditSubcategoryIdx = null;
            document.getElementById('subcategoryModalTitle').textContent = 'Add New Subcategory';
            document.getElementById('modalSubcategoryName').value = '';
            document.getElementById('modalSubcategoryIcon').value = '';
            document.getElementById('subcategoryModal').classList.remove('hidden');
        }
        
        function editSubcategory(catIdx, subIdx) {
            modalMode = 'edit';
            currentEditCategoryIdx = catIdx;
            currentEditSubcategoryIdx = subIdx;
            const sub = categories[catIdx].subcategories[subIdx];
            document.getElementById('subcategoryModalTitle').textContent = 'Edit Subcategory';
            document.getElementById('modalSubcategoryName').value = sub.name.en || sub.name;
            document.getElementById('modalSubcategoryIcon').value = sub.icon;
            document.getElementById('subcategoryModal').classList.remove('hidden');
        }
        
        function saveSubcategoryModal() {
            const name = document.getElementById('modalSubcategoryName').value.trim();
            const icon = document.getElementById('modalSubcategoryIcon').value.trim();
            
            if (!name || !icon) {
                alert('Please fill in both fields');
                return;
            }
            
            if (modalMode === 'add') {
                if (!categories[currentEditCategoryIdx].subcategories) {
                    categories[currentEditCategoryIdx].subcategories = [];
                }
                categories[currentEditCategoryIdx].subcategories.push({
                    name: { en: name },
                    icon: icon,
                    subsubcategories: []
                });
            } else {
                const sub = categories[currentEditCategoryIdx].subcategories[currentEditSubcategoryIdx];
                if (typeof sub.name === 'string') {
                    sub.name = { en: name };
                } else {
                    sub.name.en = name;
                }
                sub.icon = icon;
            }
            
            localStorage.setItem('categories', JSON.stringify(categories));
            loadAdminCategories();
            updateProviderCategorySelects();
            closeSubcategoryModal();
        }
        
        function closeSubcategoryModal() {
            document.getElementById('subcategoryModal').classList.add('hidden');
        }
        
        function deleteSubcategory(catIdx, subIdx) {
            if (confirm('‚ö†Ô∏è Delete this subcategory including all its services?')) {
                categories[catIdx].subcategories.splice(subIdx, 1);
                localStorage.setItem('categories', JSON.stringify(categories));
                loadAdminCategories();
                updateProviderCategorySelects();
            }
        }
        
        // Service Modal Functions
        function showAddServiceModal(catIdx, subIdx) {
            modalMode = 'add';
            currentEditCategoryIdx = catIdx;
            currentEditSubcategoryIdx = subIdx;
            currentEditServiceIdx = null;
            document.getElementById('serviceModalTitle').textContent = 'Add New Service Type';
            document.getElementById('modalServiceName').value = '';
            document.getElementById('modalServiceIcon').value = '';
            document.getElementById('serviceModal').classList.remove('hidden');
        }
        
        function editService(catIdx, subIdx, serviceIdx) {
            modalMode = 'edit';
            currentEditCategoryIdx = catIdx;
            currentEditSubcategoryIdx = subIdx;
            currentEditServiceIdx = serviceIdx;
            const service = categories[catIdx].subcategories[subIdx].subsubcategories[serviceIdx];
            document.getElementById('serviceModalTitle').textContent = 'Edit Service Type';
            document.getElementById('modalServiceName').value = service.name.en || service.name;
            document.getElementById('modalServiceIcon').value = service.icon;
            document.getElementById('serviceModal').classList.remove('hidden');
        }
        
        function saveServiceModal() {
            const name = document.getElementById('modalServiceName').value.trim();
            const icon = document.getElementById('modalServiceIcon').value.trim();
            
            if (!name || !icon) {
                alert('Please fill in both fields');
                return;
            }
            
            if (modalMode === 'add') {
                if (!categories[currentEditCategoryIdx].subcategories[currentEditSubcategoryIdx].subsubcategories) {
                    categories[currentEditCategoryIdx].subcategories[currentEditSubcategoryIdx].subsubcategories = [];
                }
                categories[currentEditCategoryIdx].subcategories[currentEditSubcategoryIdx].subsubcategories.push({
                    name: { en: name },
                    icon: icon
                });
            } else {
                const service = categories[currentEditCategoryIdx].subcategories[currentEditSubcategoryIdx].subsubcategories[currentEditServiceIdx];
                if (typeof service.name === 'string') {
                    service.name = { en: name };
                } else {
                    service.name.en = name;
                }
                service.icon = icon;
            }
            
            localStorage.setItem('categories', JSON.stringify(categories));
            loadAdminCategories();
            updateProviderCategorySelects();
            closeServiceModal();
        }
        
        function closeServiceModal() {
            document.getElementById('serviceModal').classList.add('hidden');
        }
        
        function deleteService(catIdx, subIdx, serviceIdx) {
            if (confirm('‚ö†Ô∏è Delete this service type?')) {
                categories[catIdx].subcategories[subIdx].subsubcategories.splice(serviceIdx, 1);
                localStorage.setItem('categories', JSON.stringify(categories));
                loadAdminCategories();
                updateProviderCategorySelects();
            }
        }
        
        // ==================== AUTO-LOCATION ====================
        function useMyLocation(type) {
            if (!navigator.geolocation) {
                alert('‚ùå Geolocation not supported by your browser.\n\nPlease click on the map to set your location manually.');
                return;
            }
            
            const button = event.target;
            button.innerHTML = '‚è≥ Detecting...';
            button.disabled = true;
            
            navigator.geolocation.getCurrentPosition(
                function(position) {
                    const lat = position.coords.latitude;
                    const lng = position.coords.longitude;
                    
                    console.log('Location detected:', lat, lng);
                    
                    if (type === 'provider') {
                        document.getElementById('providerLat').value = lat;
                        document.getElementById('providerLng').value = lng;
                        
                        if (maps.register) {
                            maps.register.setView([lat, lng], 13);
                            maps.register.eachLayer(layer => {
                                if (layer instanceof L.Marker) {
                                    layer.setLatLng([lat, lng]);
                                }
                            });
                        }
                    } else if (type === 'seeker') {
                        document.getElementById('seekerLat').value = lat;
                        document.getElementById('seekerLng').value = lng;
                        
                        if (maps.seeker) {
                            maps.seeker.setView([lat, lng], 13);
                            maps.seeker.eachLayer(layer => {
                                if (layer instanceof L.Marker) {
                                    layer.setLatLng([lat, lng]);
                                }
                            });
                        }
                    }
                    
                    button.innerHTML = '‚úì Location Detected!';
                    setTimeout(() => {
                        button.innerHTML = 'üìç Use My Location';
                        button.disabled = false;
                    }, 2000);
                    
                    alert('‚úì Your location has been detected and set on the map!');
                },
                function(error) {
                    console.error('Geolocation error:', error);
                    
                    let errorMsg = '‚ùå Could not detect location.\n\n';
                    switch(error.code) {
                        case error.PERMISSION_DENIED:
                            errorMsg += 'Please allow location access in your browser settings.';
                            break;
                        case error.POSITION_UNAVAILABLE:
                            errorMsg += 'Location information unavailable.';
                            break;
                        case error.TIMEOUT:
                            errorMsg += 'Location request timed out.';
                            break;
                        default:
                            errorMsg += 'An unknown error occurred.';
                    }
                    errorMsg += '\n\nPlease click on the map to set location manually.';
                    
                    alert(errorMsg);
                    
                    button.innerHTML = 'üìç Use My Location';
                    button.disabled = false;
                },
                {
                    enableHighAccuracy: true,
                    timeout: 10000,
                    maximumAge: 0
                }
            );
        }
        
        // ==================== INITIALIZATION ====================
        function initializeApp() {
            if (!localStorage.getItem('categories')) {
                localStorage.setItem('categories', JSON.stringify(categories));
            }
            
            initializeTranslations(); // Mark translatable elements
            updateProviderCategorySelects();
            updateAllUIText(); // Apply translations on init

            // Handle PWA shortcut URLs e.g. ?page=browse or ?page=register
            const urlParams = new URLSearchParams(window.location.search);
            const startPage = urlParams.get('page');
            if (startPage && ['home','browse','map','register','seeker','admin','myProfile'].includes(startPage)) {
                showPage(startPage);
            } else {
                showPage('home');
            }
        }
        
        window.onload = function() {
            const langNames = {
                'en': 'EN',
                'hi': '‡§π‡§ø‡§Ç',
                'bn': '‡¶¨‡¶æ‡¶Ç',
                'gu': '‡™ó‡´Å‡™ú',
                'mr': '‡§Æ‡§∞‡§æ',
                'kn': '‡≤ï‡≤®‡≥ç‡≤®'
            };
            
            if (!localStorage.getItem('language')) {
                // First time - show language selector
                document.getElementById('languageModal').classList.remove('hidden');
            } else {
                // Language already selected - load it
                currentLanguage = localStorage.getItem('language');
                document.getElementById('currentLang').textContent = langNames[currentLanguage] || 'EN';
                initializeApp();
            }
        };
        // ==================== PHASE F: ADMIN REPORTS ====================
        async function loadAdminReports() {
            const list = document.getElementById('adminReportsList');
            list.innerHTML = '<p class="text-center text-gray-400 py-4">Loading reports...</p>';
            try {
                const snap = await _firebase.get(_firebase.ref(_firebase.db, 'reports'));
                if (!snap.exists()) {
                    list.innerHTML = '<div class="text-center py-12 text-gray-400"><div class="text-5xl mb-3">‚úÖ</div><p class="font-medium">No reports yet!</p></div>';
                    return;
                }
                const reports = Object.values(snap.val()).sort((a,b) => new Date(b.date) - new Date(a.date));
                list.innerHTML = reports.map(r => {
                    const statusColors = { pending:'bg-yellow-100 text-yellow-700', reviewing:'bg-blue-100 text-blue-700', resolved:'bg-green-100 text-green-700', dismissed:'bg-gray-100 text-gray-500' };
                    return `
                    <div class="border-2 ${r.status === 'pending' ? 'border-red-200' : 'border-gray-200'} rounded-xl p-4">
                        <div class="flex justify-between items-start flex-wrap gap-2">
                            <div>
                                <div class="font-bold text-gray-800">üö® Against: ${r.targetName} <span class="text-xs text-gray-400">(${r.targetType})</span></div>
                                <div class="text-red-600 text-xs font-medium mt-0.5">${r.type.replace(/_/g,' ').toUpperCase()}</div>
                            </div>
                            <span class="text-xs px-3 py-1 rounded-full font-medium ${statusColors[r.status] || statusColors.pending}">${r.status || 'pending'}</span>
                        </div>
                        <div class="mt-2 text-gray-700 text-sm bg-gray-50 rounded-lg p-3">${r.description}</div>
                        <div class="mt-2 text-xs text-gray-500 flex flex-wrap gap-3">
                            <span>üë§ Reporter: ${r.reporterName || 'Anonymous'}</span>
                            <span>üì± ${r.reporterPhone || ''}</span>
                            <span>üìÖ ${new Date(r.date).toLocaleDateString()}</span>
                        </div>
                        <div class="mt-3 flex gap-2 flex-wrap">
                            <button onclick="updateReportStatus('${r.id}','reviewing')" class="bg-blue-600 text-white px-3 py-1.5 rounded-lg text-xs hover:bg-blue-700">üîç Mark Reviewing</button>
                            <button onclick="updateReportStatus('${r.id}','resolved')" class="bg-green-600 text-white px-3 py-1.5 rounded-lg text-xs hover:bg-green-700">‚úÖ Mark Resolved</button>
                            <button onclick="updateReportStatus('${r.id}','dismissed')" class="bg-gray-500 text-white px-3 py-1.5 rounded-lg text-xs hover:bg-gray-600">‚ùå Dismiss</button>
                            ${r.targetType === 'provider' ? `<button onclick="restrictProvider('${r.targetId}')" class="bg-orange-600 text-white px-3 py-1.5 rounded-lg text-xs hover:bg-orange-700">‚ö†Ô∏è Restrict Provider</button>` : ''}
                        </div>
                    </div>`;
                }).join('');
            } catch(e) {
                list.innerHTML = '<p class="text-red-400 text-center">Could not load reports.</p>';
            }
        }

        async function updateReportStatus(reportId, status) {
            await _firebase.update(_firebase.ref(_firebase.db, `reports/${reportId}`), { status });
            showFirebaseStatus(`Report marked as ${status}`, 'success');
            loadAdminReports();
        }

        // ==================== PHASE F: AUTH STATE ====================
        let _confirmationResult = null;
        let _recaptchaVerifier   = null;
        let firebaseUser         = null; // logged-in Firebase user
        let userProfile          = null; // our app profile from /users/{uid}

        // Listen for auth state changes
        window.addEventListener('authStateChanged', async (e) => {
            firebaseUser = e.detail;
            if (firebaseUser) {
                // Wait for Firebase to be ready
                if (!window._firebase) {
                    await new Promise(resolve => window.addEventListener('firebaseReady', resolve, { once: true }));
                }
                await loadUserProfile(firebaseUser.uid);
                updateNavForLoggedIn();
            } else {
                firebaseUser = null;
                userProfile  = null;
                updateNavForLoggedOut();
            }
            // Refresh profile page if currently open
            const profilePage = document.getElementById('page-myProfile');
            if (profilePage && !profilePage.classList.contains('hidden')) {
                renderProfilePage();
            }
        });

        async function loadUserProfile(uid) {
            try {
                if (!_firebase || !_firebase.db) return;
                const snap = await _firebase.get(_firebase.ref(_firebase.db, 'users/' + uid));
                userProfile = snap.exists() ? snap.val() : null;
            } catch(e) { console.warn('Profile load error:', e); }
        }

        function updateNavForLoggedIn() {
            const name = userProfile?.name || firebaseUser?.phoneNumber || 'User';
            const initials = name.split(' ').map(n=>n[0]).join('').substring(0,2).toUpperCase();
            document.getElementById('navAuthBtn').innerHTML = `
                <div class="flex items-center gap-2 cursor-pointer" onclick="showPage('myProfile')">
                    <div class="w-8 h-8 rounded-full bg-orange-600 text-white flex items-center justify-center text-sm font-bold">${initials}</div>
                    <span class="text-sm font-medium text-gray-700 hidden md:inline">${name.split(' ')[0]}</span>
                </div>`;
        }

        function updateNavForLoggedOut() {
            document.getElementById('navAuthBtn').innerHTML = `
                <button onclick="openLoginModal()" class="px-3 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 text-sm font-medium">üîë Login</button>`;
        }

        // ==================== PHASE F: LOGIN MODAL ====================
        function openLoginModal() {
            document.getElementById('loginModal').classList.remove('hidden');
            document.getElementById('loginStep1').classList.remove('hidden');
            document.getElementById('loginStep2').classList.add('hidden');
            document.getElementById('loginStep3').classList.add('hidden');
            document.getElementById('loginPhone').value = '';
            document.getElementById('otpInput') && (document.getElementById('otpInput').value = '');
            // Don't setup reCAPTCHA here - do it when user clicks Send OTP
        }

        function closeLoginModal() {
            document.getElementById('loginModal').classList.add('hidden');
            if (_recaptchaVerifier) {
                try { _recaptchaVerifier.clear(); } catch(e) {}
                _recaptchaVerifier = null;
            }
        }

        function setupRecaptcha() {
            try {
                if (_recaptchaVerifier) {
                    try { _recaptchaVerifier.clear(); } catch(e) {}
                    _recaptchaVerifier = null;
                }
                // Only setup if container exists and auth is ready
                const container = document.getElementById('recaptcha-container');
                if (!container || !window._auth) return;
                _recaptchaVerifier = new _auth.RecaptchaVerifier(_auth.auth, 'recaptcha-container', {
                    size: 'invisible',
                    callback: () => {}
                });
            } catch(e) { console.warn('reCAPTCHA setup:', e); }
        }

        async function sendOTP() {
            const phone = document.getElementById('loginPhone').value.trim();
            if (phone.length !== 10) { alert('Please enter a valid 10-digit mobile number'); return; }

            const btn = document.getElementById('sendOtpBtn');
            btn.disabled = true; btn.textContent = '‚è≥ Sending...';

            try {
                if (!_recaptchaVerifier) setupRecaptcha();
                const fullPhone = '+91' + phone;
                _confirmationResult = await _auth.signInWithPhoneNumber(_auth.auth, fullPhone, _recaptchaVerifier);
                document.getElementById('loginPhoneDisplay').textContent = '+91 ' + phone;
                document.getElementById('loginStep1').classList.add('hidden');
                document.getElementById('loginStep2').classList.remove('hidden');
                showFirebaseStatus('üì≤ OTP sent to +91 ' + phone, 'success');
            } catch(err) {
                console.error('OTP error:', err);
                let msg = 'Failed to send OTP. ';
                if (err.code === 'auth/too-many-requests') msg += 'Too many attempts. Please try again later.';
                else if (err.code === 'auth/invalid-phone-number') msg += 'Invalid phone number.';
                else msg += err.message;
                alert(msg);
                btn.disabled = false; btn.textContent = 'Send OTP';
                setupRecaptcha();
            }
        }

        async function verifyOTP() {
            const otp = document.getElementById('otpInput').value.trim();
            if (otp.length !== 6) { alert('Please enter the 6-digit OTP'); return; }

            const btn = document.getElementById('verifyOtpBtn');
            btn.disabled = true; btn.textContent = '‚è≥ Verifying...';

            try {
                const result = await _confirmationResult.confirm(otp);
                firebaseUser = result.user;
                // Check if user profile exists
                const snap = await _firebase.get(_firebase.ref(_firebase.db, `users/${firebaseUser.uid}`));
                if (!snap.exists()) {
                    // New user ‚Äî show setup step
                    document.getElementById('loginStep2').classList.add('hidden');
                    document.getElementById('loginStep3').classList.remove('hidden');
                } else {
                    userProfile = snap.val();
                    closeLoginModal();
                    showFirebaseStatus('‚úÖ Welcome back, ' + (userProfile.name || 'User') + '!', 'success');
                    updateNavForLoggedIn();
                }
            } catch(err) {
                console.error('OTP verify error:', err);
                alert('Invalid OTP. Please check and try again.');
                btn.disabled = false; btn.textContent = 'Verify & Login';
            }
        }

        async function completeNewUserSetup() {
            const name = document.getElementById('newUserName').value.trim();
            const role = document.querySelector('input[name="userRole"]:checked')?.value;
            if (!name) { alert('Please enter your name'); return; }
            if (!role)  { alert('Please select your role'); return; }

            const profile = {
                uid:   firebaseUser.uid,
                phone: firebaseUser.phoneNumber,
                name,
                role,
                favourites: {},
                joined: new Date().toISOString()
            };

            await _firebase.set(_firebase.ref(_firebase.db, `users/${firebaseUser.uid}`), profile);
            userProfile = profile;
            closeLoginModal();
            showFirebaseStatus('üéâ Welcome to Sudarshan Chakra, ' + name + '!', 'success');
            updateNavForLoggedIn();
            showPage('myProfile');
        }

        async function logoutUser() {
            if (!confirm('Are you sure you want to logout?')) return;
            await _auth.signOut(_auth.auth);
            firebaseUser = null; userProfile = null;
            updateNavForLoggedOut();
            showPage('home');
            showFirebaseStatus('üëã Logged out successfully', 'info');
        }

        // ==================== PHASE F: PROFILE PAGE ====================
        function renderProfilePage() {
            // Safety check - elements might not exist yet
            const notLoggedIn = document.getElementById('profileNotLoggedIn');
            const loggedIn    = document.getElementById('profileLoggedIn');
            if (!notLoggedIn || !loggedIn) return;

            if (!firebaseUser || !userProfile) {
                notLoggedIn.classList.remove('hidden');
                loggedIn.classList.add('hidden');
                return;
            }

            document.getElementById('profileNotLoggedIn').classList.add('hidden');
            document.getElementById('profileLoggedIn').classList.remove('hidden');

            // Header
            const initials = userProfile.name.split(' ').map(n=>n[0]).join('').substring(0,2).toUpperCase();
            document.getElementById('myProfileAvatar').innerHTML = `<div class="w-full h-full flex items-center justify-center text-2xl font-bold text-white bg-orange-400">${initials}</div>`;
            document.getElementById('myProfileName').textContent  = userProfile.name;
            document.getElementById('myProfilePhone').textContent = firebaseUser.phoneNumber;
            document.getElementById('myProfileRole').textContent  = userProfile.role === 'provider' ? 'üõ†Ô∏è Service Provider' : 'üîç Service Seeker';

            showProfileTab('myDetails');
        }

        function showProfileTab(tab) {
            ['myDetails','favourites','myReviews','myReports'].forEach(t => {
                document.getElementById('profileTab-' + t).classList.add('hidden');
                document.getElementById('ptab-' + t).classList.remove('text-orange-600','border-orange-600');
                document.getElementById('ptab-' + t).classList.add('text-gray-500','border-transparent');
            });
            document.getElementById('profileTab-' + tab).classList.remove('hidden');
            document.getElementById('ptab-' + tab).classList.add('text-orange-600','border-orange-600');
            document.getElementById('ptab-' + tab).classList.remove('text-gray-500','border-transparent');

            if (tab === 'myDetails')   loadMyDetails();
            if (tab === 'favourites')  loadFavourites();
            if (tab === 'myReviews')   loadMyReviews();
            if (tab === 'myReports')   loadMyReports();
        }

        function loadMyDetails() {
            if (!userProfile) return;
            // Provider card
            const myProvider = providers.find(p => p.ownerUid === firebaseUser?.uid);
            if (myProvider) {
                document.getElementById('myProviderCard').classList.remove('hidden');
                const avail = myProvider.available !== false;
                const toggle = document.getElementById('availabilityToggle');
                toggle.classList.toggle('bg-green-500', avail);
                toggle.classList.toggle('bg-gray-300', !avail);
                toggle.querySelector('div').style.transform = avail ? 'translateX(24px)' : 'translateX(0)';
                document.getElementById('myProviderInfo').innerHTML = `
                    <div class="grid grid-cols-2 gap-2">
                        <div><span class="font-medium">Service:</span> ${myProvider.service}</div>
                        <div><span class="font-medium">Rate:</span> ‚Çπ${myProvider.rate}/hr</div>
                        <div><span class="font-medium">Experience:</span> ${myProvider.experience} yrs</div>
                        <div><span class="font-medium">Location:</span> ${myProvider.location}</div>
                    </div>`;
            }
            // Seeker card
            const mySeeker = seekers.find(s => s.ownerUid === firebaseUser?.uid);
            if (mySeeker) {
                document.getElementById('mySeekerCard').classList.remove('hidden');
                document.getElementById('mySeekerInfo').innerHTML = `
                    <div><span class="font-medium">Name:</span> ${mySeeker.name}</div>
                    <div><span class="font-medium">Location:</span> ${mySeeker.location}</div>`;
            }
            // Recommendations
            loadRecommendations();
        }

        function loadRecommendations() {
            // Suggest based on user's past favourites or random top-rated
            const favIds = Object.keys(userProfile?.favourites || {});
            let recommended = providers
                .filter(p => p.status === 'active' && !favIds.includes(p.id))
                .sort((a,b) => (b.rating||0) - (a.rating||0))
                .slice(0, 3);

            const list = document.getElementById('recommendationsList');
            if (recommended.length === 0) {
                list.innerHTML = '<p class="text-gray-400 text-sm">No recommendations yet. Browse more providers!</p>';
                return;
            }
            list.innerHTML = recommended.map(p => `
                <div class="flex items-center gap-3 p-3 bg-orange-50 rounded-xl">
                    <div class="w-12 h-12 rounded-full overflow-hidden flex-shrink-0">${getProviderAvatar(p)}</div>
                    <div class="flex-1 min-w-0">
                        <div class="font-semibold text-gray-800 truncate">${p.name}</div>
                        <div class="text-orange-600 text-xs">${p.service}</div>
                        <div class="text-gray-500 text-xs">‚≠ê ${(p.rating||4).toFixed(1)} ¬∑ ‚Çπ${p.rate}/hr</div>
                    </div>
                    <button onclick="openProviderProfile('${p.id}')" class="bg-orange-600 text-white px-3 py-1.5 rounded-lg text-xs font-medium">View</button>
                </div>`).join('');
        }

        function loadFavourites() {
            const favIds = Object.keys(userProfile?.favourites || {});
            const favProviders = providers.filter(p => favIds.includes(p.id));
            const list = document.getElementById('favouritesList');
            if (favProviders.length === 0) {
                list.innerHTML = '<div class="text-center py-8 text-gray-400"><div class="text-4xl mb-2">‚ù§Ô∏è</div><p>No saved providers yet.<br>Tap ‚ù§Ô∏è on any provider to save them here!</p></div>';
                return;
            }
            list.innerHTML = favProviders.map(p => `
                <div class="flex items-center gap-3 p-3 border rounded-xl hover:bg-gray-50">
                    <div class="w-12 h-12 rounded-full overflow-hidden flex-shrink-0">${getProviderAvatar(p)}</div>
                    <div class="flex-1 min-w-0">
                        <div class="font-semibold text-gray-800">${p.name}</div>
                        <div class="text-orange-600 text-xs">${p.service} ¬∑ ‚Çπ${p.rate}/hr</div>
                    </div>
                    <button onclick="removeFavourite('${p.id}')" class="text-red-400 hover:text-red-600 text-xl">üíî</button>
                    <button onclick="openProviderProfile('${p.id}')" class="bg-orange-600 text-white px-3 py-1.5 rounded-lg text-xs">View</button>
                </div>`).join('');
        }

        async function toggleFavourite(providerId) {
            if (!firebaseUser) { openLoginModal(); return; }
            if (!userProfile) { openLoginModal(); return; }
            const isFav = userProfile.favourites && userProfile.favourites[providerId];
            const path  = 'users/' + firebaseUser.uid + '/favourites/' + providerId;
            const btn   = document.getElementById('fav-' + providerId);
            if (isFav) {
                await _firebase.remove(_firebase.ref(_firebase.db, path));
                if (userProfile.favourites) delete userProfile.favourites[providerId];
                if (btn) btn.textContent = 'ü§ç';
                showFirebaseStatus('üíî Removed from favourites', 'info');
            } else {
                await _firebase.set(_firebase.ref(_firebase.db, path), true);
                if (!userProfile.favourites) userProfile.favourites = {};
                userProfile.favourites[providerId] = true;
                if (btn) btn.textContent = '‚ù§Ô∏è';
                showFirebaseStatus('‚ù§Ô∏è Saved to favourites!', 'success');
            }
        }

        async function removeFavourite(providerId) {
            await _firebase.remove(_firebase.ref(_firebase.db, `users/${firebaseUser.uid}/favourites/${providerId}`));
            delete userProfile.favourites[providerId];
            loadFavourites();
        }

        function loadMyReviews() {
            const myReviews = [];
            providers.forEach(p => {
                if (p.reviews) {
                    Object.values(p.reviews).forEach(r => {
                        if (r.reviewerName === userProfile?.name) {
                            myReviews.push({ ...r, providerName: p.name, providerId: p.id });
                        }
                    });
                }
            });
            const list = document.getElementById('myReviewsList');
            if (myReviews.length === 0) {
                list.innerHTML = '<div class="text-center py-8 text-gray-400"><div class="text-4xl mb-2">‚≠ê</div><p>You have not written any reviews yet.<br>Browse providers and share your experience!</p></div>';
                return;
            }
            list.innerHTML = myReviews.map(r => `
                <div class="border rounded-xl p-4">
                    <div class="flex justify-between">
                        <div class="font-semibold text-gray-800">${r.providerName}</div>
                        <div class="text-yellow-400">${'‚òÖ'.repeat(r.rating)}${'‚òÜ'.repeat(5-r.rating)}</div>
                    </div>
                    <div class="text-gray-600 text-sm mt-1">${r.text}</div>
                    <div class="text-xs text-gray-400 mt-1">${new Date(r.date).toLocaleDateString()}</div>
                </div>`).join('');
        }

        async function loadMyReports() {
            const list = document.getElementById('myReportsList');
            list.innerHTML = '<p class="text-gray-400 text-sm">Loading...</p>';
            try {
                const snap = await _firebase.get(_firebase.ref(_firebase.db, 'reports'));
                const reports = snap.exists() ? Object.values(snap.val()) : [];
                const mine = reports.filter(r => r.reporterUid === firebaseUser?.uid);
                if (mine.length === 0) {
                    list.innerHTML = '<div class="text-center py-8 text-gray-400"><div class="text-4xl mb-2">üö®</div><p>No complaints filed yet.</p></div>';
                    return;
                }
                list.innerHTML = mine.map(r => `
                    <div class="border rounded-xl p-4">
                        <div class="flex justify-between items-start">
                            <div>
                                <div class="font-semibold text-gray-800">Against: ${r.targetName}</div>
                                <div class="text-red-600 text-xs mt-0.5">${r.type.replace('_',' ').toUpperCase()}</div>
                            </div>
                            <span class="text-xs px-2 py-1 rounded-full ${r.status === 'resolved' ? 'bg-green-100 text-green-700' : r.status === 'reviewing' ? 'bg-yellow-100 text-yellow-700' : 'bg-gray-100 text-gray-600'}">${r.status || 'Pending'}</span>
                        </div>
                        <div class="text-gray-600 text-sm mt-2">${r.description}</div>
                        <div class="text-xs text-gray-400 mt-1">${new Date(r.date).toLocaleDateString()}</div>
                    </div>`).join('');
            } catch(e) { list.innerHTML = '<p class="text-red-400 text-sm">Could not load reports.</p>'; }
        }

        // ==================== PHASE F: AVAILABILITY TOGGLE ====================
        async function toggleAvailability() {
            if (!firebaseUser) return;
            const myProvider = providers.find(p => p.ownerUid === firebaseUser.uid);
            if (!myProvider) return;
            const newState = myProvider.available === false ? true : false;
            await updateProviderInFirebase(myProvider.id, { available: newState });
            showFirebaseStatus(newState ? 'üü¢ You are now Available' : 'üî¥ You are now Unavailable', 'info');
        }

        // ==================== PHASE F: EDIT PROVIDER PROFILE ====================
        function openEditProviderModal() {
            const myProvider = providers.find(p => p.ownerUid === firebaseUser?.uid);
            if (!myProvider) return;
            document.getElementById('editBio').value         = myProvider.bio || '';
            document.getElementById('editRate').value        = myProvider.rate || '';
            document.getElementById('editWhatsapp').value    = myProvider.whatsapp || '';
            document.getElementById('editWorkingHours').value = myProvider.workingHours || 'mon-fri';
            const preview = document.getElementById('editPhotoPreview');
            preview.src = myProvider.photo || '';
            document.getElementById('editProviderModal').classList.remove('hidden');
        }

        function previewEditPhoto(input) {
            const file = input.files[0]; if (!file) return;
            const reader = new FileReader();
            reader.onload = (e) => {
                const img = new Image();
                img.onload = () => {
                    const canvas = document.createElement('canvas');
                    const max = 300; let w = img.width, h = img.height;
                    if (w > h) { if (w > max) { h = h*max/w; w = max; } } else { if (h > max) { w = w*max/h; h = max; } }
                    canvas.width = w; canvas.height = h;
                    canvas.getContext('2d').drawImage(img, 0, 0, w, h);
                    document.getElementById('editPhotoPreview').src = canvas.toDataURL('image/jpeg', 0.75);
                };
                img.src = e.target.result;
            };
            reader.readAsDataURL(file);
        }

        async function saveProviderEdits() {
            const myProvider = providers.find(p => p.ownerUid === firebaseUser?.uid);
            if (!myProvider) return;
            const updates = {
                bio:          document.getElementById('editBio').value.trim() || null,
                rate:         parseInt(document.getElementById('editRate').value) || myProvider.rate,
                whatsapp:     document.getElementById('editWhatsapp').value || null,
                workingHours: document.getElementById('editWorkingHours').value,
                photo:        document.getElementById('editPhotoPreview').src || myProvider.photo
            };
            await updateProviderInFirebase(myProvider.id, updates);
            document.getElementById('editProviderModal').classList.add('hidden');
            showFirebaseStatus('‚úÖ Profile updated successfully!', 'success');
            loadMyDetails();
        }

        // ==================== PHASE F: REPORT SYSTEM ====================
        let reportTargetId   = null;
        let reportTargetType = null;

        function openReportModal(targetId, targetType, targetName) {
            if (!firebaseUser) { openLoginModal(); return; }
            reportTargetId   = targetId;
            reportTargetType = targetType;
            document.getElementById('reportTargetName').textContent = 'Reporting: ' + targetName;
            document.getElementById('reportType').value = '';
            document.getElementById('reportDescription').value = '';
            document.getElementById('reporterNameInput').value = userProfile?.name || '';
            document.getElementById('reportModal').classList.remove('hidden');
        }

        function closeReportModal() {
            document.getElementById('reportModal').classList.add('hidden');
            reportTargetId = null; reportTargetType = null;
        }

        // Use event delegation for reportDescription
        document.addEventListener('input', function(e) {
            if (e.target.id === 'reportDescription') {
                const counter = document.getElementById('reportCharCount');
                if (counter) counter.textContent = e.target.value.length;
            }
        });

        async function submitReport() {
            const type = document.getElementById('reportType').value;
            const desc = document.getElementById('reportDescription').value.trim();
            const name = document.getElementById('reporterNameInput').value.trim();
            if (!type) { alert('Please select the type of issue'); return; }
            if (!desc || desc.length < 20) { alert('Please describe the issue in at least 20 characters'); return; }

            const report = {
                id:          'rep_' + Date.now(),
                targetId:    reportTargetId,
                targetType:  reportTargetType,
                targetName:  document.getElementById('reportTargetName').textContent.replace('Reporting: ', ''),
                type,
                description: desc,
                reporterName: name,
                reporterUid: firebaseUser.uid,
                reporterPhone: firebaseUser.phoneNumber,
                status: 'pending',
                date:   new Date().toISOString()
            };

            try {
                await _firebase.set(_firebase.ref(_firebase.db, `reports/${report.id}`), report);
                closeReportModal();
                showFirebaseStatus('üö® Report submitted. Admin will review within 24 hours.', 'success');
            } catch(e) {
                alert('Could not submit report. Please try again.');
            }
        }

        // ==================== PHASE E: PHOTO PREVIEW ====================
        function previewProviderPhoto(input) {
            const file = input.files[0];
            if (!file) return;

            // Max 1MB check
            if (file.size > 1.5 * 1024 * 1024) {
                alert('Photo too large! Please choose an image under 1.5MB.');
                input.value = '';
                return;
            }

            const reader = new FileReader();
            reader.onload = (e) => {
                // Compress to max 300x300 for Firebase storage efficiency
                const img = new Image();
                img.onload = () => {
                    const canvas = document.createElement('canvas');
                    const maxSize = 300;
                    let w = img.width, h = img.height;
                    if (w > h) { if (w > maxSize) { h = h * maxSize / w; w = maxSize; } }
                    else { if (h > maxSize) { w = w * maxSize / h; h = maxSize; } }
                    canvas.width = w; canvas.height = h;
                    canvas.getContext('2d').drawImage(img, 0, 0, w, h);
                    const compressed = canvas.toDataURL('image/jpeg', 0.75);

                    document.getElementById('photoPreview').src = compressed;
                    document.getElementById('photoPreview').classList.remove('hidden');
                    document.getElementById('photoPlaceholder').classList.add('hidden');
                };
                img.src = e.target.result;
            };
            reader.readAsDataURL(file);
        }

        // ==================== PHASE E: REVIEW SYSTEM ====================
        let currentReviewProviderId = null;
        let currentReviewRating = 0;

        function openReviewModal(providerId) {
            const provider = providers.find(p => p.id === providerId);
            if (!provider) return;
            currentReviewProviderId = providerId;
            currentReviewRating = 0;

            document.getElementById('reviewProviderName').textContent = provider.name + ' ‚Äî ' + provider.service;
            document.getElementById('reviewerName').value = currentUser ? currentUser.name : '';
            document.getElementById('reviewText').value = '';
            updateStarUI(0);
            document.getElementById('reviewModal').classList.remove('hidden');
        }

        function closeReviewModal() {
            document.getElementById('reviewModal').classList.add('hidden');
            currentReviewProviderId = null;
            currentReviewRating = 0;
        }

        function updateStarUI(rating) {
            const labels = ['', 'Poor üòû', 'Fair üòê', 'Good üôÇ', 'Very Good üòä', 'Excellent üåü'];
            document.querySelectorAll('.star-btn').forEach(star => {
                const val = parseInt(star.dataset.val);
                star.style.color = val <= rating ? '#f59e0b' : '#d1d5db';
            });
            document.getElementById('ratingLabel').textContent = rating ? labels[rating] : 'Tap to rate';
        }

        // Star click handlers - use event delegation on document to avoid null errors
        document.addEventListener('click', (e) => {
            const star = e.target.closest('.star-btn');
            if (!star) return;
            currentReviewRating = parseInt(star.dataset.val);
            updateStarUI(currentReviewRating);
        });

        document.addEventListener('mouseover', (e) => {
            const star = e.target.closest('.star-btn');
            if (star) updateStarUI(parseInt(star.dataset.val));
        });

        async function submitReview() {
            if (!currentReviewRating) { alert('Please select a star rating!'); return; }
            const name = document.getElementById('reviewerName').value.trim();
            const text = document.getElementById('reviewText').value.trim();
            if (!name) { alert('Please enter your name!'); return; }
            if (!text) { alert('Please write your review!'); return; }

            const review = {
                id: 'r_' + Date.now(),
                reviewerName: name,
                text: text,
                rating: currentReviewRating,
                date: new Date().toISOString()
            };

            try {
                if (!_db) throw new Error('Firebase not ready');
                await _set(_ref(_db, `providers/${currentReviewProviderId}/reviews/${review.id}`), review);
                closeReviewModal();
                showFirebaseStatus('‚≠ê Review submitted! Thank you.', 'success');
            } catch (err) {
                console.error('Review save error:', err);
                alert('Could not save review. Please check your connection.');
            }
        }

        // ==================== PHASE E: PROVIDER PROFILE MODAL ====================
        function openProviderProfile(providerId) {
            const p = providers.find(pr => pr.id === providerId);
            if (!p) return;

            const { avg, count } = getAvgRating(p);
            const reviews = p.reviews ? Object.values(p.reviews).sort((a,b) => new Date(b.date) - new Date(a.date)) : [];
            const waNum = p.whatsapp || p.mobile;
            const waMsg = encodeURIComponent(`Hi ${p.name}, I found you on Sudarshan Chakra. I need your ${p.service} service.`);
            const stars = '‚òÖ'.repeat(Math.round(avg)) + '‚òÜ'.repeat(5 - Math.round(avg));

            document.getElementById('profileModalContent').innerHTML = `
                <!-- Header -->
                <div class="bg-gradient-to-br from-orange-500 to-orange-600 p-6 rounded-t-2xl text-white relative">
                    <button onclick="document.getElementById('profileModal').classList.add('hidden')" class="absolute top-4 right-4 text-white text-2xl opacity-75 hover:opacity-100">‚úï</button>
                    <div class="flex items-center gap-4">
                        <div class="w-20 h-20 rounded-full overflow-hidden border-3 border-white shadow-xl flex-shrink-0">
                            ${getProviderAvatar(p)}
                        </div>
                        <div>
                            <div class="flex items-center gap-2 flex-wrap">
                                <h2 class="text-2xl font-bold">${p.name}</h2>
                                ${p.verified ? '<span class="bg-white text-blue-600 text-xs font-bold px-2 py-0.5 rounded-full">‚úÖ Verified</span>' : ''}
                            </div>
                            <div class="opacity-90 font-medium">${p.service}</div>
                            <div class="flex items-center gap-1 mt-1">
                                <span class="text-yellow-300">${stars}</span>
                                <span class="text-sm opacity-80">${avg.toFixed(1)} (${count} reviews)</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Body -->
                <div class="p-5 space-y-4">
                    ${p.bio ? `<div class="bg-orange-50 rounded-xl p-4 text-gray-700 italic">"${p.bio}"</div>` : ''}

                    <!-- Info grid -->
                    <div class="grid grid-cols-2 gap-3 text-sm">
                        <div class="bg-gray-50 rounded-xl p-3"><div class="text-gray-400 text-xs mb-1">Service</div><div class="font-semibold">${p.service}</div></div>
                        <div class="bg-gray-50 rounded-xl p-3"><div class="text-gray-400 text-xs mb-1">Rate</div><div class="font-semibold text-green-600">‚Çπ${p.rate}/hr</div></div>
                        <div class="bg-gray-50 rounded-xl p-3"><div class="text-gray-400 text-xs mb-1">Experience</div><div class="font-semibold">${p.experience} years</div></div>
                        <div class="bg-gray-50 rounded-xl p-3"><div class="text-gray-400 text-xs mb-1">Language</div><div class="font-semibold">${p.language || 'N/A'}</div></div>
                        <div class="bg-gray-50 rounded-xl p-3"><div class="text-gray-400 text-xs mb-1">Religion</div><div class="font-semibold">${religionIcons[p.religion] || ''} ${p.religion}</div></div>
                        <div class="bg-gray-50 rounded-xl p-3"><div class="text-gray-400 text-xs mb-1">Working Hours</div><div class="font-semibold">${getWorkingHoursLabel(p.workingHours || '')}</div></div>
                        <div class="bg-gray-50 rounded-xl p-3 col-span-2"><div class="text-gray-400 text-xs mb-1">üìç Location</div><div class="font-semibold">${p.location}</div></div>
                    </div>

                    <!-- Action buttons -->
                    <div class="grid grid-cols-2 gap-3">
                        <a href="tel:${p.mobile}" class="bg-green-600 text-white text-center py-3 rounded-xl font-semibold hover:bg-green-700 transition" style="text-decoration:none;">üìû Call Now</a>
                        <a href="https://wa.me/91${waNum}?text=${waMsg}" target="_blank" class="bg-green-500 text-white text-center py-3 rounded-xl font-semibold hover:bg-green-600 transition" style="text-decoration:none;">üí¨ WhatsApp</a>
                        ${p.lat && p.lng ? `<a href="https://www.google.com/maps/dir/?api=1&destination=${p.lat},${p.lng}" target="_blank" class="bg-blue-600 text-white text-center py-3 rounded-xl font-semibold hover:bg-blue-700 transition" style="text-decoration:none;">üó∫Ô∏è Get Directions</a>` : '<div></div>'}
                        <button onclick="document.getElementById('profileModal').classList.add('hidden'); openReviewModal('${p.id}')" class="bg-orange-100 text-orange-700 py-3 rounded-xl font-semibold hover:bg-orange-200 transition border border-orange-200">‚≠ê Write Review</button>
                    </div>

                    <!-- Reviews section -->
                    <div>
                        <h3 class="font-bold text-gray-800 mb-3">Customer Reviews ${count > 0 ? `(${count})` : ''}</h3>
                        ${reviews.length === 0 
                            ? '<div class="text-center py-6 text-gray-400">No reviews yet. Be the first to review!</div>'
                            : reviews.map(r => `
                                <div class="border rounded-xl p-4 mb-3 bg-gray-50">
                                    <div class="flex justify-between items-start">
                                        <div class="font-semibold text-gray-800">${r.reviewerName}</div>
                                        <div class="text-yellow-400 text-sm">${'‚òÖ'.repeat(r.rating)}${'‚òÜ'.repeat(5-r.rating)}</div>
                                    </div>
                                    <div class="text-gray-600 text-sm mt-1">${r.text}</div>
                                    <div class="text-xs text-gray-400 mt-1">${new Date(r.date).toLocaleDateString()}</div>
                                </div>`).join('')
                        }
                    </div>
                </div>
            `;
            document.getElementById('profileModal').classList.remove('hidden');
        }

        // ==================== PHASE E: ADMIN VERIFIED BADGE ====================
        function toggleVerified(providerId, currentState) {
            const action = currentState ? 'Remove Verified badge from' : 'Mark as Verified';
            if (confirm(`${action} this provider?`)) {
                updateProviderInFirebase(providerId, { verified: !currentState }).then(success => {
                    if (success) showFirebaseStatus(`‚úÖ Verified status updated!`, 'success');
                });
            }
        }

        // ==================== PWA INSTALL PROMPT ====================
        let deferredInstallPrompt = null;

        // Capture the install prompt event (Android/Chrome)
        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredInstallPrompt = e;

            // Don't show if already dismissed or installed
            if (localStorage.getItem('pwaDismissed') === '1') return;
            if (window.matchMedia('(display-mode: standalone)').matches) return;

            // Show our custom banner after 3 seconds
            setTimeout(() => {
                document.getElementById('pwaInstallBanner').classList.remove('hidden');
            }, 3000);
        });

        // Install button clicked
        document.getElementById('pwaInstallBtn')?.addEventListener('click', async () => {
            if (!deferredInstallPrompt) return;
            document.getElementById('pwaInstallBanner').classList.add('hidden');
            deferredInstallPrompt.prompt();
            const { outcome } = await deferredInstallPrompt.userChoice;
            console.log('PWA install outcome:', outcome);
            deferredInstallPrompt = null;
            if (outcome === 'accepted') {
                showFirebaseStatus('üéâ App installed! Find it on your home screen.', 'success');
            }
        });

        // Dismiss banner
        document.getElementById('pwaInstallDismiss')?.addEventListener('click', () => {
            document.getElementById('pwaInstallBanner').classList.add('hidden');
            localStorage.setItem('pwaDismissed', '1');
        });

        // iOS Safari detection ‚Äî show manual instructions
        (function checkiOS() {
            const isIOS = /iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream;
            const isSafari = /^((?!chrome|android).)*safari/i.test(navigator.userAgent);
            const isStandalone = window.matchMedia('(display-mode: standalone)').matches || window.navigator.standalone;
            const dismissed = localStorage.getItem('pwaDismissed') === '1';

            if (isIOS && isSafari && !isStandalone && !dismissed) {
                setTimeout(() => {
                    document.getElementById('iosInstallBanner').classList.remove('hidden');
                }, 3000);
            }
        })();

        // Hide banner once app is installed
        window.addEventListener('appinstalled', () => {
            document.getElementById('pwaInstallBanner').classList.add('hidden');
            document.getElementById('iosInstallBanner').classList.add('hidden');
            console.log('‚úÖ PWA installed successfully');
        });

    </script>
</body>
</html>
